//>>built
require({cache:{"url:control/customer/templates/audit.html":"<div>\r\n        <div data-dojo-attach-point=\"auditgrid\" data-dojo-type=\"dijit/layout/ContentPane\" data-dojo-props='region:\"center\"'></div>\r\n    \r\n    <form data-dojo-attach-point=\"documentform\" target=\"_blank\" method=\"post\" action=\"/audit/viewpdf\">\r\n        <input type=\"hidden\" name=\"audittrailid\"data-dojo-attach-point=\"documentform_audittrailid\">\r\n    </form>\r\n    <form data-dojo-attach-point=\"htmlform\" target=\"_blank\" method=\"post\" action=\"/audit/viewhtml\">\r\n        <input type=\"hidden\" name=\"audittrailid\" data-dojo-attach-point=\"htmlform_audittrailid\">\r\n    </form>\r\n</div>\r\n"}});define("control/customer/audit",["dojo/_base/declare","ttl/BaseWidgetAMD","dojo/text!../customer/templates/audit.html","dijit/layout/BorderContainer","dijit/layout/ContentPane","dojo/request","ttl/utilities2","dojo/_base/lang","dojo/topic","dojo/dom-class","dojo/dom-attr","ttl/store/JsonRest","dojo/store/Observable","ttl/grid/Grid"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e){return _1("control.customer.audit",[_2,_4],{templateString:_3,gutters:false,constructor:function(){this.auditlist=new _d(new _c({target:"/audit/audit",idProperty:"audittrailid",onError:_7.globalerrorchecker,clearOnClose:true,urlPreventCache:true}));this._icustomerid=null;},postCreate:function(){var _f=[{label:"Type",className:"dgrid-column-nbr-right",field:"audittypeid"},{label:"Date",className:"dgrid-column-date",field:"auditdate"},{label:"Text",className:"dgrid-column-status-large",field:"audittext"},{label:" ",className:"dgrid-column-type-boolean",field:"documentpresent",formatter:_7.document_exists},{label:"Who",className:"dgrid-column-status",field:"user_name"}];this.auditgrid_view=new _e({columns:_f,selectionMode:"single",store:this.auditlist,sort:[{attribute:"auditdate",descending:true}],query:{}});this.auditgrid.set("content",this.auditgrid_view);this.auditgrid_view.on(".dgrid-cell:click",_8.hitch(this,this._OnSelectAudit));this.inherited(arguments);},load:function(_10){this._customerid=_10;this.auditgrid_view.set("query",{icustomerid:this._customerid});},_OnSelectAudit:function(e){var _11=this.auditgrid_view.cell(e);if(_11==null||_11.row==null){return;}var row=_11.row.data;if(_11.column.id==3&&row.documentpresent==true){if(row.audittypeid==17||row.audittypeid==24){_b.set(this.htmlform_audittrailid,"value",row.audittrailid);_b.set(this.htmlform,"action","/audit/viewhtml/"+row.audittrailid);this.htmlform.submit();}else{_b.set(this.documentform_audittrailid,"value",row.audittrailid);_b.set(this.documentform,"action","/audit/viewpdf/"+row.audittrailid);this.documentform.submit();}}},});});