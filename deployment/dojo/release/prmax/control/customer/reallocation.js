//>>built
require({cache:{"url:control/customer/templates/reallocation.html":"<div>\r\n\t<div data-dojo-type=\"dijit.Dialog\" data-dojo-attach-point=\"dialog\" data-dojo-props='title:\"Allocate\"'>\r\n\t\t<form data-dojo-attach-point=\"form\"  onsubmit=\"return false\" data-dojo-type=\"dijit/form/Form\">\r\n\t\t\t<input type=\"hidden\" data-dojo-type=\"dijit/form/TextBox\" data-dojo-attach-point=\"keyid\" name=\"keyid\" >\r\n\t\t\t<table width=\"600px\" cellpadding=\"0\" cellpadding=\"0\" >\r\n\t\t\t\t<tr><td colspan=\"2\"><div class=\"prmaxrowdisplaylarge\" style=\"text-align:center;display:inline\"></div><div class=\"prmaxrowdisplaylarge\" style=\"display:inline\" data-dojo-attach-point=\"customername\"></div></td></tr>\r\n\t\t\t\t<tr><td class=\"prmaxrowlabel\" align=\"right\" >Value</td><td>\r\n\t\t\t\t\t<table width=\"100%\" cellpadding=\"0\" cellpadding=\"0\" ><tr>\r\n\t\t\t\t\t\t<td><input data-dojo-props='\"class\":\"prmaxinput\",type:\"text\",readOnly:\"readonly\",style:\"width:8em\"' data-dojo-type=\"dijit/form/CurrencyTextBox\" data-dojo-attach-point=\"payment\" ></input></td>\r\n\t\t\t\t\t\t<td class=\"prmaxrowlabel\">Amount to Allocate</td>\r\n\t\t\t\t\t\t<td class=\"prmaxrowlabel\"><input data-dojo-props='type:\"text\",style:\"width:8em\",readOnly:\"readonly\"' data-dojo-type=\"dijit/form/TextBox\" data-dojo-attach-point=\"toallocate\"  ></input></td>\r\n\t\t\t\t\t</tr></table>\r\n\t\t\t\t</td></tr>\r\n\t\t\t\t<tr><td colspan=\"2\">\r\n\t\t\t\t\t<div data-dojo-attach-point=\"alloc_grid_view\" data-dojo-type=\"dijit/layout/ContentPane\" data-dojo-props='style:\"width:590px;height:300px\"'></div>\r\n\t\t\t\t</td></tr>\r\n\t\t\t\t<tr><td class=\"prmaxrowlabel\" colspan=\"2\" align=\"right\"><button data-dojo-type=\"dojox/form/BusyButton\" data-dojo-props='type:\"button\",labelBusy:\"Re-Allocation\"' data-dojo-attach-point=\"allocate\" data-dojo-attach-event=\"onClick:_reallocate\">Allocate</button></td></tr>\r\n\t\t\t</table>\r\n\t\t</form>\r\n\t</div>\r\n\r\n<div data-dojo-attach-point=\"alloc_manual\" data-dojo-type=\"control/customer/manual_allocate_amount\"></div>\r\n\r\n</div>\r\n"}});define("control/customer/reallocation",["dojo/_base/declare","ttl/BaseWidgetAMD","dojo/text!../customer/templates/reallocation.html","dijit/layout/BorderContainer","dojo/request","ttl/utilities2","dojo/_base/lang","dojo/topic","dojo/dom-class","dojo/dom-attr","dojo/data/ItemFileReadStore","dojo/data/ItemFileWriteStore","control/customer/allocation","dijit/form/Form","dijit/form/CurrencyTextBox","dojox/form/BusyButton","dijit/form/TextBox","control/customer/manual_allocate_amount"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d){return _1("control.customer.reallocation",[_2,_d],{templateString:_3,gutters:false,constructor:function(){this._load_call_back=_7.hitch(this,this._load_call);this._reallocate_call_back=_7.hitch(this,this._reallocate_call);this._source="";},Load:function(_e,_f){this._customerid=_e;this.alloc_grid_view.resize({w:590,h:300});_5.post("/allocation/allocation_get_details",_6.make_params({data:{keyid:_f}})).then(this._load_call_back);this.keyid.set("value",_f);},_load_call:function(_10){if(_10.success=="OK"){this._source=_10.data.source;this.load_allocation(this._customerid,_10.data.source);this.payment.set("value",_10.data.unallocated);this.toallocate.set("value",_10.data.unallocated);this.allocate.cancel();this.dialog.show();}},_on_blur_amount:function(){this._doallocation();},postCreate:function(){this._postCreate();this.inherited(arguments);},_reallocate_call:function(_11){if(_11.success=="OK"){alert("Re Allocated Done");this.dialog.hide();_8.publish(PRCOMMON.Events.Financial_ReLoad,[]);}else{alert("Problem with allocations");}this.allocate.cancel();},_reallocate:function(){if(this.toallocate.get("value")>this.payment.get("value")){alert("Over Allocation");this.allocate.cancel();return;}var _12=this.form.get("value");_12["icustomerid"]=this._customerid;_12["unpaidamount"]=this.toallocate.get("value");_12["allocations"]=this.getAllocations();_5.post("/allocation/allocation_reallocate",_6.make_params({data:_12})).then(this._reallocate_call_back);}});});