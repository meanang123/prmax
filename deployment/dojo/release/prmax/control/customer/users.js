//>>built
require({cache:{"url:control/customer/templates/users.html":"<div>\r\n\t<div data-dojo-type=\"dijit/layout/ContentPane\" data-dojo-props='region:\"top\",style:\"width:100%;height:48px;padding:0px;margin:0px\"'>\r\n\t\t<div data-dojo-type=\"dijit/Toolbar\" data-dojo-props='style:\"height:47px;width:100%;padding:0px;margin:0px\"'>\r\n\t\t\t<div data-dojo-type=\"dijit/form/Button\" data-dojo-props='iconClass:\"fa fa-plus fa-3x\",showLabel:true' data-dojo-attach-event=\"onClick:_add_user\"><span>Add User</span></div>\r\n\t\t</div>\r\n\t</div>\r\n\t<div data-dojo-type=\"dijit/layout/BorderContainer\" data-dojo-props='region:\"center\"'>\r\n\t<div data-dojo-type=\"dijit/layout/ContentPane\" data-dojo-props='region:\"center\"' data-dojo-attach-point=\"grid_view\"></div>\r\n\t\t<div data-dojo-type=\"dijit/layout/StackContainer\" data-dojo-attach-point=\"controls\" data-dojo-props=\"region:'bottom',style:'width:100%;height:50%',preload:false,splitter:true\">\r\n\t\t\t<div data-dojo-attach-point=\"blank\" data-dojo-type=\"dijit/layout/ContentPane\" data-dojo-props='title:\"blank\",selected:\"selected\"'></div>\r\n\t\t\t<div data-dojo-attach-point=\"update_user_ctrl\" data-dojo-type=\"dijit/layout/ContentPane\" data-dojo-props='style:\"width:100%;height:100%\",\"class\":\"scrollpanel\"'></div>\r\n\t\t</div>\r\n\t</div>\r\n\t<div data-dojo-attach-point=\"user_add_dlg\" data-dojo-type=\"dijit/Dialog\" data-dojo-props='title:\"Add New User\"' style=\"width:500px\">\r\n\t\t<div data-dojo-attach-point=\"user_add_ctrl\" data-dojo-type=\"control/customer/user_add\"></div>\r\n\t</div>\r\n\t<div data-dojo-attach-point=\"user_update_dlg\" data-dojo-type=\"dijit/Dialog\" data-dojo-props='title:\"Update Users\"' style=\"width:500px\">\r\n\t\t<div data-dojo-attach-point=\"user_update_ctrl\" data-dojo-type=\"control/customer/user_update\"></div>\r\n\t</div>\r\n\t<div data-dojo-attach-point=\"user_password_dlg\" data-dojo-type=\"dijit/Dialog\" data-dojo-props='title:\"Reset Password\"' style=\"width:500px\">\r\n\t\t<div data-dojo-attach-point=\"user_password_ctrl\" data-dojo-type=\"control/customer/user_reset_password\"></div>\r\n\t</div>\r\n\r\n</div>\r\n\r\n"}});define("control/customer/users",["dojo/_base/declare","ttl/BaseWidgetAMD","dojo/text!../customer/templates/users.html","dijit/layout/BorderContainer","dojo/request","ttl/utilities2","dojo/_base/lang","dojo/topic","dojo/dom-class","ttl/grid/Grid","ttl/store/JsonRest","dojo/store/Observable","dijit/Menu","dijit/MenuItem","dijit/form/ValidationTextBox","dijit/form/CheckBox","control/customer/user_add","control/customer/user_update","control/customer/user_reset_password","dijit/Dialog"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e){return _1("control.customer.users",[_2,_4],{templateString:_3,gutters:false,constructor:function(){this.model=new _c(new _b({target:"/customer/user_list",idProperty:"user_id"}));this._show_func_call_back=_7.hitch(this,this._show_func_call);this._delete_call_back=_7.hitch(this,this._delete_call);this._icustomerid=null;this._std_menu=null;},postCreate:function(){var _f=[{label:"User Id",className:"dgrid-column-type-small",field:"user_id"},{label:"Display Name",className:"dgrid-column-title",field:"display_name"},{label:"Login Name",className:"dgrid-column-title",field:"user_name"},{label:"Email",className:"dgrid-column-title",field:"email_address"}];this.searchgrid=new _a({columns:_f,selectionMode:"single",store:this.model,sort:[{attribute:"user_id",descending:false}],query:_6.EMPTYGRID});this.grid_view.set("content",this.searchgrid);this.searchgrid.on(".dgrid-cell:click",_7.hitch(this,this._on_cell_call));},_on_cell_call:function(evt){var _10=this.searchgrid.cell(evt);if(_10==null||_10.row==null){return;}this._selected_row=_10.row.data;if(this._std_menu===null){this._std_menu=new _d();this._std_menu.addChild(new _e({label:"Delete",onClick:_7.hitch(this,this._delete_user)}));this._std_menu.addChild(new _e({label:"Edit",onClick:_7.hitch(this,this._edit_user)}));this._std_menu.addChild(new _e({label:"Re-Set password",onClick:_7.hitch(this,this._reset_password)}));this._std_menu.startup();}if(this._std_menu!=null){this._std_menu._openMyself(evt);}},load:function(_11){this._icustomerid=_11;this.searchgrid.set("query",{icustomerid:_11});},_add_user:function(){this.user_add_ctrl.load(this._icustomerid,this._show_func_call_back);this.user_add_dlg.show();},_show_func_call:function(_12,_13){switch(_12){case "add":this.model.add(_13);this.user_add_dlg.hide();this.user_add_ctrl.clear();break;case "delete":this.model.remove(_13);this.user_add_dlg.hide();this.user_add_ctrl.clear();break;case "update_show":this.user_update_dlg.show();break;case "upd_password_close":this.user_password_dlg.hide();break;case "update_finish":this.model.add(_13);this.user_update_dlg.hide();break;}},_delete_user:function(){if(confirm("Delete - "+this._selected_row.display_name)){_5.post("/customer/user/delete",_6.make_params({data:{iuserid:this._selected_row.user_id}})).then(this._delete_call_back);}},_edit_user:function(){this.user_update_ctrl.load(this._selected_row.user_id,this._show_func_call_back);},_reset_password:function(){this.user_password_ctrl.load(this._selected_row.user_id,this._selected_row.user_name,this._show_func_call_back);this.user_password_dlg.show();},_delete_call:function(_14){if(_14.success=="OK"){this.model.remove(this._selected_row.user_id);this._selected_row=null;}else{alert("Problem");}}});});