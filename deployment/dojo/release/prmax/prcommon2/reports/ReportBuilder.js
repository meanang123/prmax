//>>built
require({cache:{"url:prcommon2/reports/templates/ReportBuilder.html":"<div>\r\n\t<table data-dojo-attach-point=\"waitbar\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\r\n\t\t<tr><td align=\"left\" valign=\"middle\" style=\"padding:0px 3px;width:100%;vertical-align:middle\" class=\"square_button_red\">\r\n\t\t\t<button data-dojo-props='type:\"button\",title:\"Cancel\"' data-dojo-type=\"dijit/form/Button\" data-dojo-attach-event=\"onClick:stop\" data-dojo-attach-point=\"cancelbtn\"><i class=\"fa fa-times fa-lg\"></i>&nbsp;&nbsp;Cancel</button>\r\n\t\t</td>\r\n\t\t<td align=\"right\" valign=\"middle\" style=\"padding:5px 3px;vertical-align:'middle'\">\r\n\t\t\t<i class=\"fa fa-spinner fa-2x fa-pulse\" style=\"color:#4296d0\"></i>\r\n\t\t</td><td width=\"80px\" nowrap valign=\"middle\" style=\"padding: 6px 8px 6px 4px;vertical-align:'middle';\">\r\n\t\t\tPlease wait...\r\n\t\t</td></tr>\r\n\t</table>\r\n\t<form data-dojo-attach-point=\"reportForm\" target=\"_blank\" method=\"post\" action=\"/reports/view\">\r\n\t\t<input type=\"hidden\" name=\"reportid\" data-dojo-attach-point=\"reportid\">\r\n\t\t<input type=\"hidden\" name=\"cache_buster\" data-dojo-attach-point=\"cache_buster\">\r\n\t</form>\r\n</div>\r\n\r\n\r\n"}});define("prcommon2/reports/ReportBuilder",["dojo/_base/declare","ttl/BaseWidgetAMD","dojo/text!../reports/templates/ReportBuilder.html","ttl/utilities2","dojo/request","dojo/_base/lang","dojo/dom-style","dojo/dom-attr","dojo/dom-class","dijit/ProgressBar"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){return _1("prcommon2.reports.ReportBuilder",[_2],{templateString:_3,constructor:function(){this._reportid=-1;this._current=0;this._complete=null;this._on_start_call_back=_6.hitch(this,this._on_start_call);this._on_status_call_back=_6.hitch(this,this._on_status_call);this._get_report_build_status_back=_6.hitch(this,this._get_report_build_status);},postCreate:function(){this.inherited(arguments);},SetCompleted:function(_a){this._complete=_a;},start:function(_b){this._start(_b);},_start:function(_c){this.clear();if(_c.searchtypeid==null){_c.searchtypeid=-1;}_5.post("/reports/start",_4.make_params({data:_c})).then(this._on_start_call_back);},_on_start_call:function(_d){this._reportid=_d.reportid;this._wait();},_wait:function(){if(this._reportid==-1){this._complete(false);}else{++this._current;if(this._current>300){this._complete(false);}else{setTimeout(this._get_report_build_status_back,2000);}}},_on_status_call:function(_e){if(_e.success=="OK"){if(_e.reportstatusid==0||_e.reportstatusid==1){this._wait();}else{_8.set(this.reportid,"value",this._reportid);_8.set(this.reportForm,"action","/reports/view/"+this._reportid);_8.set(this.cache_buster,"value",new Date());this.reportForm.submit();this._complete(true);}}else{this.stop();}},stop:function(){this.clear();this._complete(false);},clear:function(){this._reportid=-1;this._current=0;},_get_report_build_status:function(){if(this._reportid!=-1){_5.post("/reports/status",_4.make_params({data:{reportid:this._reportid}})).then(this._on_status_call_back);}}});});