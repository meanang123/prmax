//>>built
define("prcommon2/search/std_search",["dojo/_base/declare","dojo/request","ttl/utilities2","dojo/topic","dijit/registry","dojo/_base/lang","dojo/dom-style"],function(_1,_2,_3,_4,_5,_6,_7){return _1("prcommon2.search.std_search",null,{commoncontrols:"search",dojoAttachEvent:"",dojoAttachPoint:"",waiRole:"",waiState:"",name:"",value:"",keytypeid:"",displayname:"",testmode:false,usepartial:false,search:"",min:0,searchTime:400,dointeractive:true,constructor:function(){this._load_call_back=_6.hitch(this,this._load_call);this._value="";this._extended=false;this.open=false;this.searchTimer=null;_4.subscribe(PRCOMMON.Events.Search_PartialMatch,_6.hitch(this,this._partial_event));},_partial_event:function(_8){if(this.usepartial&&_8.search==this.search&&this._value.length>0){this._get_selector(this._value,true);}},_setdisplay:function(_9){if(_9.length==0){this.countnode.clear();}else{this.countnode.set("value",_9);}},_load_call:function(_a,_b){if(_a.success=="OK"){if(this._transactionid==_a.transactionid){this._setdisplay(_a.count.toString());}}},_send_request_count:function(_c){if(this.dointeractive){var _d=this._capture_extended_content({keytypeid:this.keytypeid,fieldname:this.name,value:this._value});this._transactionid=PRCOMMON.utils.uuid.createUUID();_d["transactionid"]=this._transactionid;_2.post("/search/displaycount",_3.make_params_ignore({data:_d})).then(this._load_call_back);}this.searchTimer=null;},_get_selector:function(_e,_f){if(this._value==_e&&_f!=true){return;}this._value=_e;if(this._value.length>this.min){if(this.searchTimer){clearTimeout(this.searchTimer);this.searchTimer=null;}this.searchTimer=setTimeout(_6.hitch(this,this._send_request_count,_e),this.searchTime);}else{this._setdisplay("");}_4.publish(PRCOMMON.Events.Search_Total,{search:this.search});},_capture_extended_content:function(_10){var _11=_5.byId("search_partial");var _12=_5.byId(this.commoncontrols+"private");try{return dojo.mixin(_10,{partial:_11?_11.checked?2:0:2,private_only:_12?_12.attr("value"):0});}catch(e){alert(e);}},_setExtendedAttr:function(_13){this._extended=_13;},_getExtendedAttr:function(){return this._extended;},_toggle:function(){this.open=!this.open;this._toggle_cascade();},_toggle_cascade:function(){_7.set(this.selectarea,"display",this.open?"block":"none");this.togglectrl.src=this.open?"/prmax_common_s/images/toclosed.gif":"/prmax_common_s/images/toopen.gif";if(this.open){this._focus();}},clear:function(){this._make_closed();if(this.searchTimer){clearTimeout(this.searchTimer);this.searchTimer=null;}},_make_closed:function(){if(this.open==true){this._toggle();}},make_open:function(){this.open=false;this._toggle();}});});