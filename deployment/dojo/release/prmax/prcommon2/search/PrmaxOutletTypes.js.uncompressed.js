require({cache:{
'url:prcommon2/search/templates/PrmaxOutletTypes.html':"<div class=\"prmaxoutlettype\">\r\n\t<table width=\"100%\" class=\"prmaxtable\" cellpadding=\"0\" cellspacing=\"0\" >\r\n\t\t<tr><td width=\"20%\"   class=\"prmaxrowtag\">Media Channels</td>\r\n\t\t\t\t<td width=\"5%\" ><img height=\"16px\" width=\"16px\" data-dojo-attach-point=\"togglectrl\" data-dojo-attach-event=\"onclick:_toggle\" src=\"/prmax_common_s/images/toopen.gif\" class=\"toggleselect\"></img>\r\n\t\t\t\t<td align=\"right\" valign=\"top\" ><div data-dojo-attach-point=\"countnode\" data-dojo-type=\"prcommon2/search/SearchCount\"></div></td>\r\n\t\t</tr>\r\n\t</table>\r\n\t<div style=\"border 2px solid black\">\r\n\t\t<div data-dojo-attach-point=\"selectarea\" style=\"display:none\" >\r\n\t\t\t<table width=\"100%\" class=\"prmaxtable\" >\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t <td width=\"33%\">\r\n\t\t\t\t\t <div class=\"box1\">\r\n\t\t\t\t\t <input  data-dojo-attach-point=\"node1\" data-dojo-type=\"dijit/form/CheckBox\" data-dojo-props='style:\"float:left\",\"class\":\"check_input prmaxdefault\",type:\"checkbox\",value:\"1\"' />\r\n\t\t\t\t\t <label data-dojo-attach-point=\"node1label\" class=\"labeltag\" >National Newspapers</label><div class=\"imagebox\" style=\"display:inline\">&nbsp;<img src=\"/prmax_common_s/images/outlet_fill.gif\" data-dojo-attach-point=\"node1button\" ></img></a></div>\r\n\t\t\t\t\t </div>\r\n\t\t\t\t\t </td>\r\n\t\t\t\t\t<td width=\"33%\">\r\n\t\t\t\t\t <div class=\"box1\">\r\n\t\t\t\t\t<input data-dojo-props='style:\"float:left\",\"class\":\"check_input prmaxdefault\",type:\"checkbox\",value:\"2\"' data-dojo-attach-point=\"node2\" data-dojo-type=\"dijit/form/CheckBox\"/>\r\n\t\t\t\t\t<label  data-dojo-attach-point=\"node2label\" class=\"labeltag\" >Regional Newspapers</label>\r\n\t\t\t\t\t<div class=\"imagebox\" style=\"display:inline\">&nbsp;<img src=\"/prmax_common_s/images/outlet_fill.gif\" data-dojo-attach-point=\"node2button\"></div>\r\n\t\t\t\t\t</div></td>\r\n\t\t\t\t\t<td width=\"33%\">\r\n\t\t\t\t\t <div class=\"box1\">\r\n\t\t\t\t\t<input data-dojo-attach-point=\"node3\" data-dojo-type=\"dijit/form/CheckBox\" data--dojo-props='style:\"float:left\",\"class\":\"check_input prmaxdefault\",type:\"checkbox\",value:\"3\"' />\r\n\t\t\t\t\t<label data-dojo-attach-point=\"node3label\" class=\"labeltag\" >B2B Magazines</label>\r\n\t\t\t\t\t<div class=\"imagebox\" style=\"display:inline\">&nbsp;<img src=\"/prmax_common_s/images/outlet_fill.gif\" data-dojo-attach-point=\"node3button\"></div>\r\n\t\t\t\t\t</div></td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t <td width=\"33%\">\r\n\t\t\t\t\t <div class=\"box1\">\r\n\t\t\t\t\t<input data-dojo-props='style:\"float:left\",\"class\":\"check_input prmaxdefault\",type:\"checkbox\",value:\"4\"' data-dojo-attach-point=\"node4\" data-dojo-type=\"dijit/form/CheckBox\" />\r\n\t\t\t\t\t<label data-dojo-attach-point=\"node4label\" class=\"labeltag\" >Consumer Magazines</label>\r\n\t\t\t\t\t<div class=\"imagebox\" style=\"display:inline\">&nbsp;<img src=\"/prmax_common_s/images/outlet_fill.gif\" data-dojo-attach-point=\"node4button\"></div>\r\n\t\t\t\t\t</div></td>\r\n\t\t\t\t\t <td width=\"33%\">\r\n\t\t\t\t\t <div class=\"box1\">\r\n\t\t\t\t\t<input data-dojo-props='style:\"float:left\",\"class\":\"prmaxdefault\",type:\"checkbox\",value:\"5\"' data-dojo-attach-point=\"node5\" data-dojo-type=\"dijit/form/CheckBox\" />\r\n\t\t\t\t\t<label class=\"labeltag\" data-dojo-attach-point=\"node5label\" >Radio</label>\r\n\t\t\t\t\t<div class=\"imagebox\" style=\"display:inline\">&nbsp;<img src=\"/prmax_common_s/images/outlet_fill.gif\" data-dojo-attach-point=\"node5button\"></div>\r\n\t\t\t\t\t</div></td>\r\n\t\t\t\t\t <td width=\"33%\">\r\n\t\t\t\t\t <div class=\"box1\">\r\n\t\t\t\t\t<input data-dojo-props='style:\"float:left\",\"class\":\"prmaxdefault\",type:\"checkbox\",value:\"6\"' data-dojo-attach-point=\"node6\" data-dojo-type=\"dijit/form/CheckBox\" />\r\n\t\t\t\t\t<label class=\"labeltag\" data-dojo-attach-point=\"node6label\" >TV</label>\r\n\t\t\t\t\t<div class=\"imagebox\" style=\"display:inline\">&nbsp;<img src=\"/prmax_common_s/images/outlet_fill.gif\" data-dojo-attach-point=\"node6button\"></div>\r\n\t\t\t\t\t</div></td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t <td width=\"33%\">\r\n\t\t\t\t\t <div class=\"box1\">\r\n\t\t\t\t\t<input  data-dojo-attach-point=\"node7\" data-dojo-type=\"dijit/form/CheckBox\" data-dojo-props='style:\"float:left\",\"class\":\"prmaxdefault\",type:\"checkbox\",value:\"7\"' /><label class=\"labeltag\" data-dojo-attach-point=\"node7label\" >Influencers</label>\r\n\t\t\t\t\t<div class=\"imagebox\" style=\"display:inline\">&nbsp;<img src=\"/prmax_common_s/images/outlet_fill.gif\" data-dojo-attach-point=\"node7button\"></div>\r\n\t\t\t\t\t</div></td>\r\n\t\t\t\t\t <td width=\"33%\">\r\n\t\t\t\t\t <div class=\"box1\">\r\n\t\t\t\t\t<input  data-dojo-attach-point=\"node8\" data-dojo-type=\"dijit/form/CheckBox\" data-dojo-props='style:\"float:left\",\"class\":\"prmaxdefault\",type:\"checkbox\",value:\"8\"' /><label class=\"labeltag\" data-dojo-attach-point=\"node8label\" >News Services</label>\r\n\t\t\t\t\t<div class=\"imagebox\" style=\"display:inline\">&nbsp;<img src=\"/prmax_common_s/images/outlet_fill.gif\" data-dojo-attach-point=\"node8button\"></div>\r\n\t\t\t\t\t</div></td>\r\n\t\t\t\t\t <td width=\"33%\">\r\n\t\t\t\t\t <div class=\"box1\">\r\n\t\t\t\t\t<input  data-dojo-attach-point=\"node9\"  data-dojo-type=\"dijit/form/CheckBox\" data-dojo-props='style:\"float:left\",\"class\":\"prmaxdefault\",type:\"checkbox\",value:\"9\"' /><label class=\"labeltag\" data-dojo-attach-point=\"node9label\" >Parliamentary</label>\r\n\t\t\t\t\t<div class=\"imagebox\" style=\"display:inline\">&nbsp;<img src=\"/prmax_common_s/images/outlet_fill.gif\" data-dojo-attach-point=\"node9button\"></div>\r\n\t\t\t\t\t</div></td>\r\n\t\t\t\t</tr>\r\n\t\t\t</table>\r\n\t\t\t<br/>\r\n\t\t\t<table width=\"100%\" class=\"prmaxtable\" cellpadding=\"0\" cellspacing=\"0\" >\r\n\t\t\t\t  <tr><td width=\"48%\"><select style=\"width:100%\" data-dojo-attach-point=\"outlet_type_list\" size=\"${size}\" class=\"lists\" multiple=\"multiple\" ></select></td>\r\n\t\t\t\t  <td >\r\n\t\t\t\t  <button data-dojo-attach-point=\"button_all\" data-dojo-props='\"class\":\"button_add_add\",style:\"padding:0px;margin:0px\",disabled:true,type:\"button\"' data-dojo-attach-event=\"onClick:_outlet_type_select_all\" data-dojo-type=\"dijit/form/Button\"><div class=\"std_movement_button\">&gt;&gt;</div></button><br/>\r\n\t\t\t\t  <button data-dojo-attach-point=\"button_single\" data-dojo-props='\"class\":\"button_add_single\",style:\"padding:0px;margin:0px\",disabled:true,type:\"button\"' data-dojo-type=\"dijit/form/Button\" data-dojo-attach-event=\"onClick:_outlet_type_select_single\"><div class=\"std_movement_button\">&gt;&nbsp;</div></button><br/>\r\n\t\t\t\t  <button data-dojo-attach-point=\"button_del_all\" data-dojo-props='\"class\":\"button_del_all\",style:\"padding:0px;margin:0px\",disabled:true,type:\"button\"'  data-dojo-type=\"dijit/form/Button\" data-dojo-attach-event=\"onClick:_outlet_type_remove_all\"><div class=\"std_movement_button\">&lt;&lt;</div></button><br/>\r\n\t\t\t\t  <button data-dojo-attach-point=\"button_del_single\" data-dojo-props='\"class\":\"button_del_single\",style:\"padding:0px;margin:0px\",disabled:true,type:\"button\"'  data-dojo-type=\"dijit/form/Button\" data-dojo-attach-event=\"onClick:_outlet_type_remove_single\"><div class=\"std_movement_button\">&lt;&nbsp;</div></button></td>\r\n\t\t\t\t  <td width=\"48%\"><select style=\"width:100%\" data-dojo-attach-point=\"outlet_type_select\" size=\"${size}\" class=\"lists\" multiple=\"multiple\" ></select></td></tr>\r\n\t\t\t</table>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n"}});
//-----------------------------------------------------------------------------
// Name:    OutetTypes.js
// Author:  Chris Hoy
// Purpose:
// Created: 28/06/2008
//
// To do:
//
//
//----------------------------------------------------------------------------
define("prcommon2/search/PrmaxOutletTypes", [
	"dojo/_base/declare", // declare
	"ttl/BaseWidgetAMD",
	"dojo/text!../search/templates/PrmaxOutletTypes.html",
	"prcommon2/search/std_search",
	"dojo/data/ItemFileReadStore",
	"dojox/collections/Dictionary",
	"dojo/json",
	"dijit/form/CheckBox",
	"dijit/form/Button"
	], function(declare, BaseWidgetAMD, template,std_search, ItemFileReadStore, Dictionary,json){
 return declare("prcommon2.search.PrmaxOutletTypes",
	[BaseWidgetAMD,std_search],{
	templateString: template,
		name:"",		// name used for a form integration
		value:"",
		title : '',
		search : '',
		size:'7',
		testmode:false,
		constructor: function()
		{
			this._fieldList = [1,2,3,4,5,6,7,8,9];
			this._values = "";
			this.items = new ItemFileReadStore ({ url:"/common/lookups?searchtype=prmaxoutlettypes"});
			this.items.fetch();
			this._clear_selection_list_call = dojo.hitch ( this, this._clear_selection_list ) ;
			this._load_selection_call = dojo.hitch ( this, this._load_selection ) ;
			this._control_buttons_call = dojo.hitch(this,this._control_buttons)
			this._selected = new Dictionary();
			this._group_types = new Dictionary();
			this._group_types.add(1,'national');
			this._group_types.add(2,'regional');
			this._group_types.add(3,'business');
			this._group_types.add(4,'consumer');
			this._group_types.add(5,'radio');
			this._group_types.add(6,'television');
			this._group_types.add(7,'internet');
			this._group_types.add(8,'news');
			this._group_types.add(9,'parliamentary');

			this._primary = new Dictionary();
			this._primary.add(1,1);
			this._primary.add(2,6);
			this._primary.add(3,13);
			this._primary.add(4,15);
			this._primary.add(5,24);
			this._primary.add(6,27);
			this._primary.add(7,null);
			this._primary.add(8,43);
			this._primary.add(9,null);

		},
		postCreate:function()
		{
			for ( var key in this._fieldList)
			{
				var record = this._fieldList[key];
				dojo.attr(this["node"+record+"label"], "for", this["node"+record].id);
				dojo.connect ( this["node"+record], "onClick", dojo.hitch(this, this._select_primary , record  ) ) ;
				dojo.connect ( this["node"+record + "button"], "onclick", dojo.hitch(this, this._select_list , record  ) ) ;
			}

			dojo.connect(this.outlet_type_list,"onchange" ,  this._control_buttons_call);
			dojo.connect(this.outlet_type_select,"onchange" ,  this._control_buttons_call);
			dojo.connect(this.outlet_type_list,"ondblclick" ,  dojo.hitch(this,this._outlet_select_dbl));


		},
		_control_buttons:function()
		{
			this.button_all.set('disabled',this.outlet_type_list.length?false:true);
			this.button_single.set('disabled',this.outlet_type_list.selectedIndex!=-1?false:true);
			this.button_del_all.set('disabled',this.outlet_type_select.length?false:true);
			this.button_del_single.set('disabled',this.outlet_type_select.selectedIndex!=-1?false:true);
		},
		// styandard clear function
		clear:function()
		{
			this._selected.clear();
			this.outlet_type_list.options.length = 0 ;
			this.outlet_type_select.options.length = 0 ;
			this._get_selector(this._get_data());
			for ( var key in this._fieldList)
				this["node"+this._fieldList[key]].set("checked",false );

			this.inherited(arguments);
		},
		_setValueAttr:function(values)
		{
			var open = false ;
			this.clear();
			for ( var key in values.data )
			{
				open = true ;
			}

			this._get_selector(this._get_data());
			if ( open )
				this.MakeOpen();
		},
		_getValueAttr:function()
		{
			return this._get_data();
		},
		_clear_selection_list:function(size, request)
		{
			this.outlet_type_list.options.length = 0 ;
		},
		_load_selection:function (items, request )
		{
			for (i = 0; i < items.length; i++) {
				var item = items[i];
				this.outlet_type_list.options[this.outlet_type_list.options.length] = new Option( item.name, item.id) ;
			}
		},
		_select_list:function( typeid )
		{
			// fill selection area
			this.items.fetch({
				query: {
					grouptypeid: this._group_types.item ( typeid )
				},
				onBegin: this._clear_selection_list_call,
				onComplete: this._load_selection_call
			});
		},
		_select_primary:function( typeid )
		{
			if (this["node"+typeid].get("checked") )
			{
				// fill selection area
				this.items.fetch({
					query: {
					    grouptypeid: this._group_types.item ( typeid )
					},
					onBegin: this._clear_selection_list_call,
					onComplete: this._load_selection_call
				});

				var pid = this._primary.item(typeid) ;
				if (pid != null && this._selected.containsKey(pid) == false )
				{
					var v = this.items._getItemByIdentity(pid);
					this._select_item (pid , v.name ) ;
					this._control_buttons();
					this._get_selector(this._getValueAttr());
				}
			}
			else
			{
				this.outlet_type_list.options.length = 0 ;
				var pid = this._primary.item(typeid) ;
				// remove from selected
				if ( this._selected.containsKey(pid))
				{
					this._selected.remove(pid);
					for ( var c = 0 ; c < this.outlet_type_select.options.length; c++)
					{
						var record = this.outlet_type_select.options[c];

						if ( parseInt(record.value) == pid )
						{
							this.outlet_type_select.options[c] = null ;
							this._control_buttons();
							this._get_selector(this._getValueAttr());
							break;
						}
					}
				}
			}
		},
		_select_item:function( id , name )
		{
			if (this._selected.containsKey(id) == false )
			{
				this.outlet_type_select.options[this.outlet_type_select.options.length] = new Option(
							name,
							id) ;
				this._selected.add(id, name ) ;
			}
		},
		_get_data:function()
		{
			var data = this._selected.getKeyList();

			var obj = {data:data,logic:2};

			if (this._extended)
			{
				return obj;
			}
			else
			{
				var data = this._selected.count>0?json.stringify(obj):"";
				this.value = data;
				return data ;
			}
		},
		_focus:function()
		{
			this.node1.focus();
		},
		_outlet_type_select_all:function()
		{
			var altered = false ;
			for (var c=0; c<this.outlet_type_list.options.length ;c++){
				var option = this.outlet_type_list.options[c];
				var recordid = parseInt(option.value);
				if ( this._selected.containsKey ( recordid ) == false )
				{
					this.outlet_type_select.options[this.outlet_type_select.options.length] = new Option(option.text,option.value);
					this._selected.add(recordid , option.text ) ;
				}
			}
			this.outlet_type_list.options.length = 0 ;
			this._get_selector(this._getValueAttr());
			this._control_buttons();
		},
		_outlet_type_select_single:function()
		{
			var altered = false ;
			for (var c=0; c<this.outlet_type_list.options.length ;c++){
				var option = this.outlet_type_list.options[c];
				if (option.selected) {
					var recordid = parseInt(option.value);

					if ( this._selected.containsKey( recordid ) == false  ) {
						this.outlet_type_select.options[this.outlet_type_select.options.length] = new Option(option.text,option.value);
						this._selected.add(recordid , option.text ) ;
						this.outlet_type_list.options[c] = null ;
						--c;
						altered = true ;
					}
				}
			}
			if ( altered )
				this._get_selector(this._getValueAttr());
			this._control_buttons();
		},
		_outlet_type_remove_all:function()
		{
			for (var c=0; c<this.outlet_type_select.options.length ;c++){
				var option = this.outlet_type_select.options[c];
				var recordid = parseInt(option.value);
				this._selected.remove( recordid );
				this.outlet_type_list.options[this.outlet_type_list.options.length] = new Option(option.text,option.value);
			}
			this.outlet_type_select.options.length = 0 ;
			this._get_selector(this._getValueAttr());
			this._control_buttons();

		},
		_outlet_type_remove_single:function()
		{
			var altered = false ;
			for (var c=0; c<this.outlet_type_select.options.length ;c++){
				var option = this.outlet_type_select.options[c];
				if (option.selected) {
					var recordid = parseInt(option.value);
					this._selected.remove( recordid );
					altered = true ;
					this.outlet_type_list.options[this.outlet_type_list.options.length] = new Option(option.text,option.value);
					this.outlet_type_select.options[c] = null ;
					--c;
				}
			}
			if ( altered )
			{
				this._get_selector(this._getValueAttr());
				this._control_buttons();
			}
		},
		_outlet_select_dbl:function()
		{
			this._outlet_type_select_single();
		},
		_capture_extended_content:function(data)
		{
			return data;
		},
		_setValueAttr:function(values)
		{
			this.clear();
			var data = values.data;
			var open = false;
			if ( data == null || data == undefined )
				data = values;
			for (var key in data)
			{
				var pid = data[key];
				var v = this.items._getItemByIdentity(pid);
				this._select_item (pid , v.name ) ;
				open = true;
			}
			this._control_buttons();
			this._get_selector(this._getValueAttr());

			if ( open )
				this.make_open();
		}
});
});





