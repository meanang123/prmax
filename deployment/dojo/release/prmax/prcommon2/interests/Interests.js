//>>built
require({cache:{"url:prcommon2/interests/templates/Interests.html":"<div data-dojo-attach-point=\"containerNode\" >\r\n\t<table width=\"100%\" class=\"prmaxtable\" cellpadding=\"0\" cellspacing=\"0\">\r\n\t\t<tr><td width=\"20%\"   class=\"prmaxrowtag\">${displaytitle}</td>\r\n\t\t\t\t<td width=\"5%\" ><img height=\"16px\" width=\"16px\" data-dojo-attach-point=\"togglectrl\" data-dojo-attach-event=\"onclick:_toggle\" src=\"/prmax_common_s/images/toopen.gif\" class=\"toggleselect\"></img></td>\r\n\t\t\t\t<td align=\"right\" valign=\"top\" ><div data-dojo-attach-point=\"countnode\" data-dojo-type=\"prcommon2/search/SearchCount\"></div></td>\r\n\t\t</tr>\r\n\t</table>\r\n\t<div class=\"dojoInterestPane\" >\r\n\t\t<div data-dojo-attach-point=\"selectarea\" class=\"prmaxselectmultiple\" style=\"display:none\" >\r\n\t\t\t<table width=\"100%\" class=\"prmaxtable\" cellpadding=\"0\" cellspacing=\"0\" >\r\n\t\t\t\t  <tr><td width=\"47%\"></td><td width=\"5%\"></td><td width=\"48%\" ></td></tr>\r\n\t\t\t\t  <tr><td colspan=\"3\">\r\n\t\t\t\t  <table style=\"width:100%\" class=\"prmaxtable\" >\r\n\t\t\t\t  <tr>\r\n\t\t\t\t\t\t<td width=\"40%\" data-dojo-attach-point=\"master_type_text\"><span class=\"prmaxrowtag\">Select</span><input class=\"prmaxfocus prmaxinput\" type=\"text\" data-dojo-type=\"dijit/form/TextBox\" style=\"width:60%\" data-dojo-attach-point=\"interest_list_select\" data-dojo-attach-event=\"onkeyup:interest_select\" /></td>\r\n\t\t\t\t\t\t<td width=\"40%\"><select data-dojo-props='style:\"width:100%\",autoComplete:true,searchAttr:\"name\",labelType:\"html\"' data-dojo-type=\"dijit/form/FilteringSelect\" data-dojo-attach-point=\"master_type\"data-dojo-attach-event=\"onChange:change_filter\"></td>\r\n\t\t\t\t\t\t<td width=\"3%\" align=\"right\"><input class=\"prmaxdefault\" data-dojo-attach-point=\"andor\"  data-dojo-type=\"dijit/form/CheckBox\" checked type=\"checkbox\" value=\"2\" data-dojo-attach-event=\"onClick:and_or\"/></td>\r\n\t\t\t\t\t\t<td width=\"15%\"><label data-dojo-attach-point=\"andorlabel\" class=\"prmaxlabeltag\" >All</label></td>\r\n\t\t\t\t\t\t<td width=\"3%\" align=\"right\" data-dojo-attach-point=\"show_help_btn\" class=\"prmaxhidden\"><div data-dojo-attach-event=\"onClick:_show_help\" data-dojo-type=\"dijit/form/Button\" data-dojo-props='iconClass:\"PRMaxSmallCommonIcon PRMaxSmallHelpIcon\",style:\"padding:0px;margin:0px\"'></div></td>\r\n\t\t\t\t  </tr></table>\r\n\t\t\t\t  </td></tr>\r\n\t\t\t\t  <tr><td ><select style=\"width:100%\" data-dojo-attach-point=\"interest_list\" size=\"${size}\" class=\"lists\" multiple=\"multiple\" ></select></td>\r\n\t\t\t\t  <td >\r\n\t\t\t\t  <button class=\"button_add_all\"  style=\"padding:0px;margin:0px\" data-dojo-attach-point=\"button_all\" disabled=\"true\" type=\"button\" data-dojo-attach-event=\"onClick:interest_select_all\" data-dojo-type=\"dijit/form/Button\"><div class=\"std_movement_button\">&gt;&gt;</div></button><br data-dojo-attach-point=\"button_all_line\" />\r\n\t\t\t\t  <button class=\"button_add_single\" style=\"padding:0px;margin:0px\" data-dojo-attach-point=\"button_single\" disabled=\"true\" type=\"button\" data-dojo-type=\"dijit/form/Button\" data-dojo-attach-event=\"onClick:interest_select_single\"><div class=\"std_movement_button\">&gt;&nbsp;</div></button><br/>\r\n\t\t\t\t  <button class=\"button_del_all\" style=\"padding:0px;margin:0px\" data-dojo-attach-point=\"button_del_all\" disabled=\"true\" type=\"button\" data-dojo-type=\"dijit/form/Button\" data-dojo-attach-event=\"onClick:interest_remove_all\"><div class=\"std_movement_button\">&lt;&lt;</div></button><br data-dojo-attach-point=\"button_del_all_line\" />\r\n\t\t\t\t  <button class=\"button_del_single\" style=\"padding:0px;margin:0px\" data-dojo-attach-point=\"button_del_single\" disabled=\"true\" type=\"button\" data-dojo-type=\"dijit/form/Button\" data-dojo-attach-event=\"onClick:interest_remove_single\"><div class=\"std_movement_button\">&lt;&nbsp;</div></button></td>\r\n\t\t\t\t  <td ><select style=\"width:100%\" data-dojo-attach-point=\"interest_select\" size=\"${size}\" class=\"lists\" multiple=\"multiple\" data-dojo-attach-event=\"onchange:interest_update_selection\"></select></td></tr>\r\n\t\t\t</table>\r\n\t\t</div>\r\n\t</div>\r\n\t<div data-dojo-type=\"dijit/Tooltip\" data-dojo-attach-point=\"andor_tip\" data-dojo-props='showDelay:800'>\r\n\t\t<div class=\"tooltipframe\" ><b>All Search Options</b><br/>If this option is selected then the resulting search will be all the unique items in all the interests <br/>added together, if it's not checked then the result is only those items that have entries in all the interests<br/></div>\r\n\t</div>\r\n\t<div data-dojo-type=\"dijit/Dialog\" data-dojo-attach-point=\"show_help_dialog\" data-dojo-props='title:\"Editing Keywords\",style:\"width:400px\"'>\r\n\t\t<div class=\"tooltipframe\" >\r\n\t\t\t<p>To add an interest search using the Select box. Once you have found the interest you want click on it and select the right pointing arrow head button</p>\r\n\t\t\t<p>To delete click on the interest in the right hand pane and then select the left pointing arrow head button</p>\r\n\t\t\t<div data-dojo-attach-event=\"onClick:_hide_help\" data-dojo-type=\"dijit/form/Button\" data-dojo-props='label:\"Close\",style:\"float:right\"'></div></td>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n"}});define("prcommon2/interests/Interests",["dojo/_base/declare","ttl/BaseWidgetAMD","dojo/text!../interests/templates/Interests.html","prcommon2/search/std_search","dojo/json","dojo/request","ttl/utilities2","dijit/popup","dojo/dom-class","dojo/dom-style","dojo/_base/lang","dojo/dom-attr","dojo/on","prcommon2/search/SearchCount","dijit/form/TextBox","dijit/form/FilteringSelect","dijit/form/CheckBox","dijit/form/Button","dijit/Tooltip","dijit/Dialog"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,on){return _1("prcommon2.interests.Interests",[_2,_4],{templateString:_3,name:"",value:"",displaytitle:"Keywords",search:"",size:"7",testmode:false,selectonly:false,startopen:false,interesttypeid:1,nofilter:false,restrict:1,compact:false,showhelp:false,constructor:function(){this.disabled=false;this._extended=false;this._load_selection_call=_b.hitch(this,this._load_selection);this.interest_timer=null;},statup2:function(){this.master_type.set("value",-1);this.inherited(arguments);},postCreate:function(){this.master_type.set("store",PRCOMMON.utils.stores.interest_sections());this.master_type.set("value",-1);on(this.interest_list_select.domNode,"keyup",_b.hitch(this,this._interest_select));on(this.interest_list,"change",_b.hitch(this,this.interest_update_selection));on(this.interest_list,"dblclick",_b.hitch(this,this.interest_select_dbl));_c.set(this.andorlabel,"for",this.andor.id);if(this.selectonly==true){_a.set(this.andor.domNode,"display","None");_a.set(this.countnode.domNode,"display","None");_a.set(this.andorlabel,"display","None");}else{this.andor_tip.set("connectId",this.andor.id);}if(this.nofilter){_a.set(this.master_type.domNode,"display","none");}if(this.startopen==true){_a.set(this.togglectrl,"display","none");_a.set(this.selectarea,"display","block");}if(this.showhelp==true){_9.remove(this.show_help_btn,"prmaxhidden");}if(this.compact==true){_9.add(this.button_all.domNode,"prmaxhidden");_9.add(this.button_del_all.domNode,"prmaxhidden");_9.add(this.button_all_line,"prmaxhidden");_9.add(this.button_del_all_line,"prmaxhidden");}this.inherited(arguments);},clear:function(){this._clear_selection_box();this._clear_selected_box();this.master_type.set("value",-1);this.interest_list_select.set("value","");this._get_selector(this._getValueAttr());this._selection_options();if(this.selectonly==false){this.inherited(arguments);}},clear_selection:function(){this._clear_selection_box();this.interest_list_select.set("value","");this._get_selector(this._getValueAttr());},_send_request:function(_d,_e){this._transactionid=PRCOMMON.utils.uuid.createUUID();_6.post("/interests/listuserselection",_7.make_params({data:{word:_d,filter:_e,logic:this.andor.get("value"),interesttypeid:this.interesttypeid,keytypeid:this.keytypeid,restrict:this.restrict,transactionid:this._transactionid}})).then(this._load_selection_call);},_interest_select:function(p1,_f){var _10=this.interest_list_select.get("value");var _11=this.master_type.get("value");if(_f!=null){_10=_f;}if(_11=="-1"&&_10=="*"){_10="";}if(_10.length>0){if(this.interest_timer){clearTimeout(this.interest_timer);this.interest_timer=null;}this.interest_timer=setTimeout(_b.hitch(this,this._send_request,_10,_11),this.searchTime);}else{this.interest_timer=null;this._clear_selection_box();this._selection_options();}},_load_selection:function(_12){if(this._transactionid==_12.transactionid){this._clear_selection_box();for(var i=0;i<_12.data.length;++i){var _13=_12.data[i];this.interest_list.options[this.interest_list.options.length]=new Option(_13[0],_13[1]);}this._selection_options();}},_clear_selection_box:function(){this.interest_list.options.length=0;},_clear_selected_box:function(){this.interest_select.length=0;},and_or:function(){this._get_selector(this._getValueAttr(),true);},interest_update_selection:function(){this._selection_options();},interest_select_dbl:function(){this.interest_select_single();this._selection_options();},interest_select_all:function(){for(var c=0;c<this.interest_list.options.length;c++){var _14=this.interest_list.options[c];var _15=true;for(var c1=0;c1<this.interest_select.options.length;c1++){if(this.interest_select.options[c1].value==_14.value){_15=false;break;}}if(_15){this.interest_select.options[this.interest_select.options.length]=new Option(_14.text,_14.value);}}this._get_selector(this._getValueAttr());this.interest_list.options.length=0;this.interest_update_selection();},interest_select_single:function(){for(var c=0;c<this.interest_list.options.length;c++){var _16=this.interest_list.options[c];if(_16.selected){_16.selected=false;var _17=true;for(var c1=0;c1<this.interest_select.options.length;c1++){if(this.interest_select.options[c1].value==_16.value){_17=false;break;}}if(_17){this.interest_select.options[this.interest_select.options.length]=new Option(_16.text,_16.value);this._get_selector(this._getValueAttr());}}}},interest_remove_all:function(){this.interest_select.options.length=0;this.interest_update_selection();this._get_selector(this._getValueAttr());},interest_remove_single:function(){for(var c=0;c<this.interest_select.options.length;c++){if(this.interest_select.options[c].selected){this.interest_select.options[c]=null;}}this.interest_update_selection();this._get_selector(this._getValueAttr());},add_select:function(_18){this.interest_select.options[this.interest_select.options.length]=new Option(_18.interestname,_18.interestid);},_setValueAttr:function(_19){this.clear();if(_19!=null){var _1a=_19.data;var _1b=false;if(_1a==null||_1a==undefined){_1a=_19;}for(var key in _1a){var _1c=_1a[key];this.interest_select.options[this.interest_select.options.length]=new Option(_1c.interestname,_1c.interestid);_1b=true;}if(_1b){this.make_open();}this._get_selector(this._getValueAttr());}},_getValueAttr:function(){var _1d=Array();for(var c=0;c<this.interest_select.options.length;c++){if(this._extended){_1d[c]={interestid:parseInt(this.interest_select.options[c].value),interestname:this.interest_select.options[c].text};}else{_1d[c]=parseInt(this.interest_select.options[c].value);}}var obj={data:_1d,logic:this.andor.get("value")};if(this._extended){return obj;}else{var _1d=_1d.length>0?_5.stringify(obj):"";this.value=_1d;return _1d;}},_getCountAttr:function(){return this.interest_select.options.length;},_setExtendedAttr:function(_1e){this._extended=_1e;},change_filter:function(){this._interest_select(null,"*");},_selection_options:function(){this.button_all.set("disabled",this.interest_list.length?false:true);this.button_single.set("disabled",this.interest_list.selectedIndex!=-1?false:true);this.button_del_all.set("disabled",this.interest_select.length?false:true);this.button_del_single.set("disabled",this.interest_select.selectedIndex!=-1?false:true);},_capture_extended_content:function(_1f){var _20=this.andor.get("value");return _b.mixin(_1f,{logic:_20});},_setDisabledAttr:function(_21){this.disabled=_21;},_getDisabledAttr:function(){return this.disabled;},_get_selector:function(){if(this.selectonly==false){this.inherited(arguments);}},_focus:function(){this.interest_list_select.focus();},_toggle:function(){if(this.open==false&&(this.master_type.get("value")==null||this.master_type.get("value").length==0)){this.master_type.set("value",-1);}this.inherited(arguments);},_show_help:function(){this.show_help_dialog.show();},_hide_help:function(){this.show_help_dialog.hide();}});});