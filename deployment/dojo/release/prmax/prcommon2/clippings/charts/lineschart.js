//>>built
require({cache:{"url:prcommon2/clippings/charts/templates/lineschart.html":"<div>\r\n    <div data-dojo-type=\"prcommon2/clippings/filter\" data-dojo-attach-point=\"filter_view\" data-dojo-props='region:\"top\", style:\"height:50px;background-color:${back_colour};width:100%;overflow:hidden\"'></div>\r\n    <div data-dojo-type=\"dijit/layout/ContentPane\" data-dojo-props='region:\"center\",style:\"width:100%;height:400px;overflow:hidden;background-color:${back_colour};color:${fore_color}\"'>\r\n        <div style=\"height:400px;width:100%;float:left\" data-dojo-attach-point=\"chart_node_loading_no_data\" class=\"prmaxhidden\">\r\n            <div data-dojo-attach-point=\"chart_node_loading\" style=\"height:400px\">\r\n                <table width=\"100%\" height=\"100%\">\r\n                    <tr>\r\n                        <td style=\"text-align:left;vertical-align:middle\"></td>\r\n                        <td style=\"text-align:center;vertical-align:middle\">\r\n                            <p>Loading Clippings</p><br/><i class=\"fa fa-spinner fa-2x fa-pulse\" style=\"color:#0282A9\"></i>\r\n                        </td>\r\n                        <td style=\"text-align:left;vertical-align:middle\"></td>\r\n                    </tr>\r\n                </table>\r\n            </div>\r\n            <div data-dojo-attach-point=\"chart_node_no_data\" class=\"prmaxhidden\"  style=\"height:400px\">\r\n                <table width=\"100%\" height=\"100%\">\r\n                    <tr>\r\n                        <td style=\"text-align:left;vertical-align:middle\"></td>\r\n                        <td style=\"text-align:center;vertical-align:middle\">\r\n                            <span class='fa-stack fa-lg'><i class='fa fa-ban fa-3x fa-stack-2x text-danger'></i></span><p>No Results</p>\r\n                        </td>\r\n                        <td style=\"text-align:left;vertical-align:middle\"></td>\r\n                    </tr>\r\n                </table>\r\n            </div>\r\n        </div>\r\n        <div style=\"height:400px;width:15%;float:left;margin:0 0 0 15px\" data-dojo-attach-point=\"report_legend_view\" class=\"prmaxhidden\"><br/>\r\n            <div data-dojo-type=\"dijit/layout/ContentPane\" data-dojo-props='style:\"height:34px;padding:0x;margin:0px;overflow:hidden\"'>\r\n                <button data-dojo-attach-event=\"onClick:_preferences\" data-dojo-attach-point=\"preferencesbtn\" data-dojo-type=\"dijit/form/Button\" data-dojo-props='iconClass:\"fa fa-print\",type:\"button\",label:\"Report\"'></button>\r\n                <div data-dojo-attach-point=\"preferences_dlg\" data-dojo-type=\"dijit/Dialog\"title=\"Report Preferences\" data-dojo-props='style:\"width:300px\"'>\r\n                    <div data-dojo-type=\"prcommon2/clippings/charts/preferences\" data-dojo-attach-point=\"preferences_ctrl\"></div>\r\n                </div>\r\n            </div>\r\n            <p>CHANNELS FILTER:</p><br/><br/>\r\n            <div data-dojo-attach-point=\"legend_node_outer\" style=\"height:400px\">\r\n                <div data-dojo-attach-point=\"legend_node\" style=\"height:400px\"></div>\r\n            </div>\r\n        </div>\r\n        <div style=\"height:400px;width:70%;float:left\">\r\n            <div data-dojo-attach-point=\"chart_node\" style=\"height:400px\"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n"}});define("prcommon2/clippings/charts/lineschart",["dojo/_base/declare","ttl/BaseWidgetAMD","dojo/text!../charts/templates/lineschart.html","dijit/layout/BorderContainer","dojox/charting/Chart","dojox/charting/themes/Claro","dojox/charting/themes/Tom","dojox/charting/themes/PrimaryColors","dojox/charting/plot2d/Lines","dojo/store/Observable","dojo/store/Memory","dojox/charting/action2d/Tooltip","dojox/charting/action2d/MoveSlice","dojox/charting/action2d/Magnify","dojox/charting/plot2d/Markers","dojox/charting/widget/SelectableLegend","dojox/charting/axis2d/Default","dojo/request","ttl/utilities2","dojo/_base/lang","dojo/topic","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","prcommon2/clippings/filter","prcommon2/reports/ReportBuilder","prcommon2/clippings/charts/preferences",],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_13,_14,_15,_16,_17,_18){return _1("prcommon2.clippings.charts.lineschart",[_2,_4],{templateString:_3,gutters:false,back_colour:"black",fore_color:"lightblue",constructor:function(){this._linesChart=null;this._loaded=false;this._show_call_back=_14.hitch(this,this._show_call);this._error_call_back=_14.hitch(this,this._error_call);this._chart_event_call_back=_14.hitch(this,this._chart_event_call);this._complete_call_back=_14.hitch(this,this._complete_call);},postCreate:function(){this.inherited(arguments);this.filter_view.set("Updateevent",_14.hitch(this,this.refesh_view));},startup:function(){this.inherited(arguments);this.render_chart();},_create_lines:function(_19){this._linesChart=new _5(this.chart_node,{title:_19.charttitle,titlePos:"top",titleGap:25,titleFont:"normal normal normal 20pt Arial",titleFontColor:"black"});this._linesChart.setTheme(_8);this._linesChart.addPlot("default",{type:_9,markers:true});this._linesChart.connectToPlot("default",this._chart_event_call_back);var _1a=[];for(var i=0;i<_19.dates.length;i++){_1a.push({text:_19.dates[i].label,value:_19.dates[i].value});}this._linesChart.addAxis("x",{labels:_1a,rotation:-90,minorTick:{stroke:"black",length:5,width:3},majorTick:{color:"red",length:10,width:3},labelSizeChange:true});var max=_19.maxvalue+1;this._linesChart.addAxis("y",{min:0,max:max,vertical:true,fixLower:"major",fixUpper:"major",minorTick:{stroke:"black",length:5,width:3},majorTick:{color:"red",length:10,width:3}});for(var key in _19.data){this._linesChart.addSeries(key,_19.data[key],{stroke:{width:1}});}var _1b=new _c(this._linesChart,"default");var _1c=new _d(this._linesChart,"default");var _1d=new _e(this._linesChart,"default",{scale:4});this._linesChart.render();this._leg=new _10({chart:this._linesChart,horizontal:false},this.legend_node);_17.add(this.chart_node_loading_no_data,"prmaxhidden");_17.add(this.chart_node_loading,"prmaxhidden");_17.add(this.chart_node_no_data,"prmaxhidden");},refesh_view:function(){this.render_chart();try{this._leg.destroy();delete this._leg;this._linesChart.destroy();delete this._linesChart;}catch(e){}_17.add(this.report_legend_view,"prmaxhidden");_17.remove(this.chart_node_loading_no_data,"prmaxhidden");_17.remove(this.chart_node_loading,"prmaxhidden");this.legend_node=_18.place("<div data-dojo-attach-point=\"legend_node\" style=\"height:400px\"></div>",this.legend_node_outer,"first");},_refesh_chart:function(_1e){this._create_lines(_1e);},render_chart:function(){var _1f={charttype:"lines"};_14.mixin(_1f,_14.mixin(this.filter_view.get("filter")));_12.post("/clippings/charting/get_chart_data",_13.make_params({data:_1f})).then(this._show_call_back,this._error_call_back);},_show_call:function(_20){if(_20.success=="OK"){_17.remove(this.report_legend_view,"prmaxhidden");if(this._linesChart==null){this._create_lines(_20.data);}else{this._refesh_chart(_20.data);}}else{if(_20.success=="FA"){_17.add(this.report_legend_view,"prmaxhidden");_17.add(this.chart_node_loading,"prmaxhidden");_17.remove(this.chart_node_no_data,"prmaxhidden");}}this.filter_view.update_complete();},_error_call:function(){},_chart_event_call:function(evt){if(evt.type=="onclick"){var _21=this.filter_view._get_filters(false,true);_21.clippingstypedescription=evt.run.name;_21.daterestriction=evt.run.data[evt.index].labelx;_21.clippingstypeid=evt.run.data[evt.index].clippingstypeid;_15.publish("/clipping/refresh_details",_21);_15.publish("/clipping/change_view","clippings_view");}},_preferences:function(){var _22=this.filter_view._get_filters(false,true);var _23={};_23["reportoutputtypeid"]=0;_23["reporttemplateid"]=26;_23["drange"]=_22.drange;_23["tones"]=_22.tones;_23["clientid"]=_22.clientid;_23["issueid"]=_22.issueid;var _24=[];for(var i=0;i<=this._leg._cbs.length-1;i++){if(this._leg._cbs[i].checked){_24.push(this._leg.legends[i].innerText);}}this.preferences_ctrl._load(this.preferences_dlg,_23,_24);this.preferences_dlg.show();},});});