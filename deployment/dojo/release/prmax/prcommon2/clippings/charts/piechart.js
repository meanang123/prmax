//>>built
require({cache:{"url:prcommon2/clippings/charts/templates/piechart.html":"<div>\r\n    <div data-dojo-type=\"prcommon2/clippings/filter\" data-dojo-attach-point=\"filter_view\" data-dojo-props='region:\"top\", style:\"height:40px;background-color:${back_colour};width:100%;overflow:hidden\"'></div>\r\n    <div data-dojo-type=\"dijit/layout/ContentPane\" data-dojo-props='region:\"center\",style:\"width:100%;height:400px;overflow:hidden;background-color:${back_colour};color:${fore_color}\"'>\r\n        <div style=\"height:400px;width:15%;float:left;margin:0 0 0 15px\"><br/>\r\n            <div data-dojo-type=\"dijit/layout/ContentPane\" data-dojo-props='style:\"height:30px;width:100%;padding:0x;margin:0px\"'>\r\n                <button data-dojo-attach-event=\"onClick:_preferences\" data-dojo-attach-point=\"preferencesbtn\" data-dojo-type=\"dijit/form/Button\" data-dojo-props='iconClass:\"fa fa-print\",type:\"button\",label:\"Report\"'></button>\r\n                <div data-dojo-attach-point=\"preferences_dlg\" data-dojo-type=\"dijit/Dialog\" title=\"Report Preferences\" data-dojo-props='style:\"width:300px\"'>\r\n                    <div data-dojo-type=\"prcommon2/clippings/charts/preferences\" data-dojo-attach-point=\"preferences_ctrl\"></div>\r\n                </div>\r\n            </div>\r\n            <p>CHANNELS FILTER:</p><br/><br/>\r\n            <div data-dojo-attach-point=\"legend_node_outer\" style=\"height:400px\">\r\n                <div data-dojo-attach-point=\"legend_node\" style=\"height:400px\"></div>\r\n            </div>\r\n        </div>\r\n        <div style=\"height:400px;width:715px;float:left\">\r\n            <div data-dojo-attach-point=\"chart_node\" style=\"height:400px\"></div>\r\n        </div>\r\n    </div>\r\n\r\n</div>\r\n"}});define("prcommon2/clippings/charts/piechart",["dojo/_base/declare","ttl/BaseWidgetAMD","dojo/text!../charts/templates/piechart.html","dijit/layout/BorderContainer","dojox/charting/Chart","dojox/charting/themes/Claro","dojox/charting/themes/Tom","dojox/charting/themes/PrimaryColors","dojox/charting/plot2d/Pie","dojo/store/Observable","dojo/store/Memory","dojox/charting/action2d/Tooltip","dojox/charting/action2d/MoveSlice","dojox/charting/action2d/Magnify","dojox/charting/plot2d/Markers","dojox/charting/widget/SelectableLegend","dojox/charting/axis2d/Default","dojo/request","ttl/utilities2","dojo/_base/lang","dojo/topic","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dijit/Dialog","prcommon2/clippings/filter","prcommon2/reports/ReportBuilder","prcommon2/clippings/charts/preferences",],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_13,_14,_15,_16,_17,_18,_19){return _1("prcommon2.clippings.charts.piechart",[_2,_4],{templateString:_3,gutters:false,back_colour:"black",fore_color:"lightblue",constructor:function(){this._pieChart=null;this._show_call_back=_14.hitch(this,this._show_call);this._error_call_back=_14.hitch(this,this._error_call);this._chart_event_call_back=_14.hitch(this,this._chart_event_call);},startup:function(){this.inherited(arguments);this.render_chart();},postCreate:function(){this.inherited(arguments);this.filter_view.set("Updateevent",_14.hitch(this,this.refesh_view));},_create_pie:function(_1a){this._pieChart=new _5(this.chart_node,{title:_1a.charttitle,titlePos:"top",titleGap:25,titleFont:"normal normal normal 20pt Arial",titleFontColor:"black"});this._pieChart.setTheme(_8);this._pieChart.addPlot("default",{type:_9,radius:145,fontColor:"black",labelOffset:0,labelStyle:"columns",htmlLabels:true,font:"normal normal normal 12pt Arial",startAngle:-10});this._pieChart.connectToPlot("default",this._chart_event_call_back);this._pieChart.addAxis("x");this._pieChart.addAxis("y",{min:0,vertical:true,fixLower:"major",fixUpper:"major"});this._pieChart.addSeries(_1a.charttitle,_1a.data.pie);var _1b=new _c(this._pieChart,"default");var _1c=new _d(this._pieChart,"default");var _1d=new _e(this._pieChart,"default",{scale:1.2});this._pieChart.render();this._leg=new _10({chart:this._pieChart,horizontal:false},this.legend_node);},refesh_view:function(){this.render_chart();this._leg.destroy();delete this._leg;this._pieChart.destroy();delete this._pieChart;this.legend_node=_18.place("<div data-dojo-attach-point=\"legend_node\" style=\"height:400px\"></div>",this.legend_node_outer,"first");},_refesh_chart:function(_1e){this._create_pie(_1e);},render_chart:function(){var _1f={charttype:"pie"};_14.mixin(_1f,_14.mixin(this.filter_view.get("filter")));_12.post("/clippings/charting/get_chart_data",_13.make_params({data:_1f})).then(this._show_call_back,this._error_call_back);},_show_call:function(_20){if(_20.success=="OK"){if(this._pieChart==null){this._create_pie(_20.data);}else{this._refesh_chart(_20.data);}}this.filter_view.update_complete();},_chart_event_call:function(evt){if(evt.type=="onclick"){var _21=this.filter_view._get_filters(false,true);_21.clippingstypedescription=evt.run.data[evt.index].label;_21.clippingstypeid=evt.run.data[evt.index].clippingstypeid;_15.publish("/clipping/refresh_details",_21);_15.publish("/clipping/change_view","clippings_view");}},_preferences:function(){var _22=this.filter_view._get_filters(false,true);var _23={};_23["reportoutputtypeid"]=0;_23["reporttemplateid"]=25;_23["drange"]=_22.drange;_23["tones"]=_22.tones;_23["clientid"]=_22.clientid;_23["issueid"]=_22.issueid;var _24=[];for(var i=0;i<=this._leg._cbs.length-1;i++){if(this._leg._cbs[i].checked){_24.push(this._leg.legends[i].innerText);}}this.preferences_ctrl._load(this.preferences_dlg,_23,_24);this.preferences_dlg.show();},});});