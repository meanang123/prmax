//>>built
require({cache:{"url:prcommon2/clippings/templates/windowsettings.html":"<div>\r\n    <div data-dojo-attach-point=\"frame\" data-dojo-type=\"dijit/layout/ContentPane\" data-dojo-props='region:\"left\",splitter:true,style:\"width:750px;height:330px\",\"class\":\"common_prmax_layout\"'>\r\n        <h1 style=\"text-align:center\" data-dojo-attach-point=\"heading_text\">Select Chart Options</h1>       \r\n        <form data-dojo-attach-point=\"formnode\" data-dojo-type=\"dijit/form/Form\" data-dojo-props='\"onSubmit\":\"return false\"'>\r\n            <label class=\"label_align_r label_tag label_size_2\">Mode</label><select data-dojo-attach-point=\"dashboardsettingsmodeid\" data-dojo-props='style:\"width:10em\"' data-dojo-type=\"dijit/form/FilteringSelect\" data-dojo-attach-event=\"onChange:_change_mode\"></select>\r\n            <label class=\"label_align_r label_tag label_size_3\" data-dojo-attach-point=\"dashboardsettingsstandardlabel\">Option</label><select data-dojo-attach-point=\"dashboardsettingsstandardid\" data-dojo-props='style:\"width:12em\"' data-dojo-type=\"dijit/form/FilteringSelect\"></select>\r\n            <label class=\"label_align_r label_tag label_size_3\" data-dojo-attach-point=\"dashboardsettingsstandardsearchbylabel\">Results By</label><select data-dojo-attach-point=\"dashboardsettingsstandardsearchbyid\" data-dojo-props='style:\"width:12em\"' data-dojo-type=\"dijit/form/FilteringSelect\"></select>\r\n            <label class=\"label_align_r label_tag label_size_3 prmaxhidden\" data-dojo-attach-point=\"questionlabel\">Question</label><select data-dojo-attach-point='questionid' data-dojo-props='placeHolder:\"No Selection\",style:\"width:12em\",\"class\":\"prmaxhidden\"' data-dojo-type=\"dijit/form/FilteringSelect\"></select><br/>\r\n            <label class=\"label_align_r label_tag label_size_2\">Chart View</label><select data-dojo-type=\"dijit/form/FilteringSelect\" data-dojo-props='style:\"width:10em;color:black\"' data-dojo-attach-point=\"chartviewid\" data-dojo-attach-event=\"onChange:_chartview_change\"></select><br/><br/><br/>\r\n            \r\n            <label class=\"label_align_r label_tag label_size_2\">Data Filters:</label><br/>\r\n            <label class=\"label_align_r label_tag label_size_2\">Dates</label><select data-dojo-type=\"dijit/form/FilteringSelect\" data-dojo-props='style:\"width:10em;color:black\"' data-dojo-attach-point=\"daterangeid\" data-dojo-attach-event=\"onChange: _change_daterange\"></select>\r\n            <label class=\"label_align_r label_tag label_size_3\" data-dojo-attach-point=\"groupby_label\">Group by</label><select data-dojo-type=\"dijit/form/FilteringSelect\" data-dojo-props='style:\"width:12em;color:black\"' data-dojo-attach-point=\"groupbyid\"></select><br/>\r\n            <label class=\"label_align_r label_tag label_size_2\" data-dojo-attach-point=\"by_client_label\">By Client</label><input data-dojo-attach-point=\"by_client\" data-dojo-type=\"dijit/form/CheckBox\" data-dojo-props='\"class\":\"prmaxdefault\",type:\"checkbox\"' data-dojo-attach-event=\"onClick: _by_client\"/>\r\n            <label data-dojo-attach-point=\"client_label_1\" class=\"label_align_r label_tag label_size_3 prmaxhidden\">Client</label><select data-dojo-props='pageSize:20,placeHolder:\"No Selection\",name:\"clientid\",autoComplete:true,searchAttr:\"clientname\",labelType:\"html\",\"class\":\"prmaxhidden\"' data-dojo-type=\"dijit/form/FilteringSelect\" data-dojo-attach-point=\"clientid\" data-dojo-attach-event=\"onChange:_client_change\"></select><br/>\r\n            <label class=\"label_align_r label_tag label_size_2\" data-dojo-attach-point=\"by_issue_label\">By Issue</label><input data-dojo-attach-point=\"by_issue\" data-dojo-type=\"dijit/form/CheckBox\" data-dojo-props='\"class\":\"prmaxdefault\",type:\"checkbox\"' data-dojo-attach-event=\"onClick: _by_issue\"/>\r\n            <label data-dojo-attach-point=\"issue_label_1\" class=\"label_align_r label_tag label_size_3 prmaxhidden\">Issue</label><select data-dojo-props='pageSize:20,placeHolder:\"No Selection\",name:\"issueid\",autoComplete:true,searchAttr:\"name\",labelType:\"html\",\"class\":\"prmaxhidden\"' data-dojo-type=\"dijit/form/FilteringSelect\" data-dojo-attach-point=\"issueid\" ></select><br/><br/>\r\n            \r\n            </br>\r\n            <button data-dojo-attach-event=\"onClick:_clear\" data-dojo-attach-point=\"clearbtn\" data-dojo-type=\"dijit/form/Button\" data-dojo-props='type:\"button\",label:\"Clear\",\"class\":\"btnleft\"'></button>\r\n            <button data-dojo-attach-event=\"onClick:_save_settings\" data-dojo-attach-point=\"savesettingsbtn\" data-dojo-type=\"dojox/form/BusyButton\" data-dojo-props='type:\"button\",busyLabel:\"Please Wait Saving...\",label:\"Save\",\"class\":\"btnright\"'></button>\r\n            <br/><br/><br/><br/>\r\n        </form>\r\n    </div>\r\n</div>\r\n"}});define("prcommon2/clippings/windowsettings",["dojo/_base/declare","ttl/BaseWidgetAMD","dojo/text!../clippings/templates/windowsettings.html","dijit/layout/ContentPane","dijit/layout/BorderContainer","ttl/utilities2","dojo/topic","dojo/request","dojox/data/JsonRestStore","ttl/store/JsonRest","dojo/store/Observable","dojo/_base/lang","dojo/dom-attr","dojo/data/ItemFileReadStore","dojo/data/ItemFileWriteStore","dojo/dom-class","dojo/dom-construct","dijit/form/ValidationTextBox","dijit/form/DateTextBox","dijit/form/NumberTextBox","dijit/form/CurrencyTextBox","dijit/form/Textarea","dijit/form/Select","dojox/validate/regexp","prcommon2/outlet/OutletSelect","prcommon2/date/daterange","dijit/form/ComboBox"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11){return _1("prcommon2.clippings.windowsettings",[_2],{templateString:_3,constructor:function(){this._updatesettings_call_back=_c.hitch(this,this._updatesettings_call);this._load_call_back=_c.hitch(this,this._load_call);this._questions=new _9({target:"/clippings/analyse/get_global_list",idAttribute:"id"});this._clients=new _9({target:"/clients/rest_combo",idAttribute:"id"});this._issues=new _9({target:"/crm/issues/issues_list_rest",idAttribute:"id"});this._chartview=new _e({url:"/common/lookups?searchtype=chartview"});this._dateranges=new _e({url:"/common/lookups?searchtype=dateranges"});this._groupby=new _f({url:"/common/lookups?searchtype=groupby",clearOnClose:true,urlPreventCache:true,nocallback:true});this._dashboardsettingsmode=new _e({url:"/common/lookups?searchtype=dashboardsettingsmode"});this._dashboardsettingsstandard=new _e({url:"/common/lookups?searchtype=dashboardsettingsstandard"});this._dashboardsettingsstandardsearchby=new _f({url:"/common/lookups?searchtype=dashboardsettingsstandardsearchby",clearOnClose:true,urlPreventCache:true,nocallback:true});this._change_client_enabled=true;this._windowid=null;this._customerid=PRMAX.utils.settings.cid;},postCreate:function(){this.chartviewid.set("store",this._chartview);this.daterangeid.set("store",this._dateranges);this.groupbyid.set("store",this._groupby);this.dashboardsettingsmodeid.set("store",this._dashboardsettingsmode);this.dashboardsettingsstandardid.set("store",this._dashboardsettingsstandard);this.dashboardsettingsstandardsearchbyid.set("store",this._dashboardsettingsstandardsearchby);this.questionid.set("store",this._questions);this.clientid.set("store",this._clients);this.issueid.set("store",this._issues);_d.set(this.issue_label_1,"innerHTML",PRMAX.utils.settings.issue_description);_d.set(this.client_label_1,"innerHTML",PRMAX.utils.settings.client_name);this.chartviewid.set("value",1);this.daterangeid.set("value",1);this.groupbyid.set("value",1);this.dashboardsettingsmodeid.set("value",1);this.dashboardsettingsstandardid.set("value",1);this.dashboardsettingsstandardsearchbyid.set("value",1);this.clientid.set("value",null);this.issueid.set("value",null);this.inherited(arguments);},load:function(_12,_13,_14){this._clear();this._dialog=_12;this._windowid=_13;this._customerid=_14;if(this._dashboardsettingsstandardsearchby._itemsByIdentity[3]&&this._dashboardsettingsstandardsearchby._itemsByIdentity[3]!=undefined){this._dashboardsettingsstandardsearchby.deleteItem(this._dashboardsettingsstandardsearchby._itemsByIdentity[3]);}_8.post("/clippings/dashboardsettings/get_for_edit",_6.make_params({data:{customerid:this._customerid,windowid:this._windowid}})).then(this._load_call_back);},_load_call:function(_15){if(_15.success=="OK"){if(_15.data!=null){this.dashboardsettingsmodeid.set("value",_15.data.dashboardsettingsmodeid);if(_15.data.dashboardsettingsmodeid==1){_10.add(this.questionlabel,"prmaxhidden");_10.add(this.questionid.domNode,"prmaxhidden");_10.remove(this.dashboardsettingsstandardlabel,"prmaxhidden");_10.remove(this.dashboardsettingsstandardid.domNode,"prmaxhidden");_10.remove(this.dashboardsettingsstandardsearchbylabel,"prmaxhidden");_10.remove(this.dashboardsettingsstandardsearchbyid.domNode,"prmaxhidden");}else{if(_15.data.dashboardsettingsmodeid==2){_10.add(this.dashboardsettingsstandardlabel,"prmaxhidden");_10.add(this.dashboardsettingsstandardid.domNode,"prmaxhidden");_10.add(this.dashboardsettingsstandardsearchbylabel,"prmaxhidden");_10.add(this.dashboardsettingsstandardsearchbyid.domNode,"prmaxhidden");_10.remove(this.questionlabel,"prmaxhidden");_10.remove(this.questionid.domNode,"prmaxhidden");}}this.dashboardsettingsstandardid.set("value",_15.data.dashboardsettingsstandardid);this.dashboardsettingsstandardsearchbyid.set("value",_15.data.dashboardsettingsstandardsearchbyid);this.questionid.set("value",_15.data.questionid);this._change_client_enabled=false;this.by_client.set("value",_15.data.by_client);if(_15.data.by_client==true){_10.remove(this.client_label_1,"prmaxhidden");_10.remove(this.clientid.domNode,"prmaxhidden");}else{_10.add(this.client_label_1,"prmaxhidden");_10.add(this.clientid.domNode,"prmaxhidden");}this.clientid.set("value",_15.data.clientid);this.by_issue.set("value",_15.data.by_issue);if(_15.data.by_issue==true){_10.remove(this.issue_label_1,"prmaxhidden");_10.remove(this.issueid.domNode,"prmaxhidden");}else{_10.add(this.issue_label_1,"prmaxhidden");_10.add(this.issueid.domNode,"prmaxhidden");}this.issueid.set("value",_15.data.issueid);this.chartviewid.set("value",_15.data.chartviewid);if(_15.data.chartviewid==1){_10.add(this.groupby_label,"prmaxhidden");_10.add(this.groupbyid.domNode,"prmaxhidden");}else{_10.remove(this.groupby_label,"prmaxhidden");_10.remove(this.groupbyid.domNode,"prmaxhidden");}this.daterangeid.set("value",_15.data.daterangeid);this.groupbyid.set("value",_15.data.groupbyid);}}else{alert("Problem");}},_clear:function(){this.clear();},clear:function(){this.dashboardsettingsmodeid.set("value",1);this.dashboardsettingsstandardid.set("value",null);this.dashboardsettingsstandardsearchbyid.set("value",null);this.questionid.set("value",null);this.chartviewid.set("value",1);this.daterangeid.set("value",1);this.groupbyid.set("value",1);_10.add(this.groupby_label,"prmaxhidden");_10.add(this.groupbyid.domNode,"prmaxhidden");this.by_client.set("checked",false);this.by_issue.set("checked",false);_10.add(this.client_label_1,"prmaxhidden");_10.add(this.clientid.domNode,"prmaxhidden");_10.add(this.issue_label_1,"prmaxhidden");_10.add(this.issueid.domNode,"prmaxhidden");this._change_client_enabled=false;this.clientid.set("value",null);this.issueid.set("value",null);this._change_client_enabled=true;this.savesettingsbtn.cancel();},_client_change:function(){var _16=this.clientid.get("value");if(_16==undefined){_16=-1;}this.issueid.set("query",{clientid:_16});if(this._change_client_enabled==true){this.issueid.set("value",null);}this._change_client_enabled=true;},_save_settings:function(){if(_6.form_validator(this.formnode)==false){alert("Please Enter Details");this.savesettingsbtn.cancel();return false;}var _17=this.formnode.get("value");_17["windowid"]=this._windowid;_17["dashboardsettingsstandardid"]=null;_17["dashboardsettingsstandardsearchbyid"]=null;_17["questionid"]=null;_17["clientid"]=null;_17["issueid"]=null;_17["by_client"]=false;_17["by_issue"]=false;_17["customerid"]=this._customerid;_17["dashboardsettingsmodeid"]=this.dashboardsettingsmodeid.get("value");if(this.dashboardsettingsmodeid==1){if(this.dashboardsettingsstandardid.get("value")==""){this.dashboardsettingsstandardid.set("value")=1;}if(this.dashboardsettingsstandardsearchbyid.get("value")==""){this.dashboardsettingsstandardsearchbyid.set("value")=1;}_17["dashboardsettingsstandardid"]=this.dashboardsettingsstandardid.get("value");_17["dashboardsettingsstandardsearchbyid"]=this.dashboardsettingsstandardsearchbyid.get("value");if(this.by_client.checked&&(this.clientid.get("value")==-1||this.clientid.get("value")==null||this.clientid.get("value")=="")){alert("Please Select a Client");this.savesettingsbtn.cancel();return false;}if(this.by_issue.checked&&(this.issueid.get("value")==-1||this.issueid.get("value")==null||this.issueid.get("value")=="")){alert("Please Select an Issue");this.savesettingsbtn.cancel();return false;}}else{if(this.dashboardsettingsmodeid==2){_17["questionid"]=this.questionid.get("value");_17["questiontypeid"]=this.questionid.item.typeid;}}if(this.by_client.checked){_17["by_client"]=true;_17["clientid"]=this.clientid.get("value");}if(this.by_issue.checked){_17["by_issue"]=true;_17["issueid"]=this.issueid.get("value");}_17["chartviewid"]=this.chartviewid.get("value");_17["daterangeid"]=this.daterangeid.get("value");_17["groupbyid"]=this.groupbyid.get("value");this.savesettingsbtn.makeBusy();_8.post("/clippings/dashboardsettings/dashboardsettings_update",_6.make_params({data:_17})).then(this._updatesettings_call_back);},_updatesettings_call:function(_18){if(_18.success=="OK"){alert("Settings saved");this._dialog.hide();_7.publish("/dashboardsettings/update",[_18.data]);}else{alert("Problem saving settings");}this.savesettingsbtn.cancel();},_change_mode:function(){if(this.dashboardsettingsmodeid.get("value")==1){_10.remove(this.dashboardsettingsstandardlabel,"prmaxhidden");_10.remove(this.dashboardsettingsstandardid.domNode,"prmaxhidden");_10.remove(this.dashboardsettingsstandardsearchbylabel,"prmaxhidden");_10.remove(this.dashboardsettingsstandardsearchbyid.domNode,"prmaxhidden");_10.add(this.questionlabel,"prmaxhidden");_10.add(this.questionid.domNode,"prmaxhidden");}else{_10.add(this.dashboardsettingsstandardlabel,"prmaxhidden");_10.add(this.dashboardsettingsstandardid.domNode,"prmaxhidden");_10.add(this.dashboardsettingsstandardsearchbylabel,"prmaxhidden");_10.add(this.dashboardsettingsstandardsearchbyid.domNode,"prmaxhidden");_10.remove(this.questionlabel,"prmaxhidden");_10.remove(this.questionid.domNode,"prmaxhidden");}},_by_client:function(){if(this.by_client.checked){_10.remove(this.client_label_1,"prmaxhidden");_10.remove(this.clientid.domNode,"prmaxhidden");}else{_10.add(this.client_label_1,"prmaxhidden");_10.add(this.clientid.domNode,"prmaxhidden");}},_by_issue:function(){if(this.by_issue.checked){_10.remove(this.issue_label_1,"prmaxhidden");_10.remove(this.issueid.domNode,"prmaxhidden");}else{_10.add(this.issue_label_1,"prmaxhidden");_10.add(this.issueid.domNode,"prmaxhidden");}},_chartview_change:function(){if(this.chartviewid.get("value")==1){_10.add(this.groupby_label,"prmaxhidden");_10.add(this.groupbyid.domNode,"prmaxhidden");}else{_10.remove(this.groupby_label,"prmaxhidden");_10.remove(this.groupbyid.domNode,"prmaxhidden");}},_change_daterange:function(){if(this.daterangeid.get("value")>=6){if(this._groupby._itemsByIdentity[1]&&this._groupby._itemsByIdentity[1]!=undefined){this._groupby.deleteItem(this._groupby._itemsByIdentity[1]);}this._groupby.save();if(this.groupbyid.get("value")==1){this.groupbyid.set("value",2);}}else{if(this.daterangeid.get("value")<6){this._groupby.close();this.groupbyid.set("query",{});}}}});});