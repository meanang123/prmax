//>>built
require({cache:{"url:research/projects/templates/view.html":"<div>\r\n\t<div data-dojo-attach-point=\"zone\" data-dojo-type=\"dijit/layout/StackContainer\" data-dojo-props='region:\"center\"'>\r\n\t\t<div data-dojo-attach-point=\"projects_views\" data-dojo-type=\"dijit/layout/BorderContainer\" data-dojo-props='title:\"projects\",style:\"height:100%;width:100%\",gutters:false'>\r\n\t\t\t<div data-dojo-type=\"dijit/Toolbar\" data-dojo-props='region:\"top\",style:\"height:44px;width:100%;padding:0px;margin:0px\"'>\r\n\t\t\t\t<div data-dojo-type=\"dijit/form/DropDownButton\"  data-dojo-props='iconClass:\"fa fa-filter fa-3x\",label:\"Filter\",showLabel:false'>\r\n\t\t\t\t\t<div data-dojo-type=\"dijit/TooltipDialog\" data-dojo-props='title:\"Filter By\"' data-dojo-attach-event=\"execute:_execute\">\r\n\t\t\t\t\t\t<table>\r\n\t\t\t\t\t\t\t<tr><td><label>Name</label></td><td><input data-dojo-type=\"dijit/form/TextBox\" data-dojo-attach-point=\"projectname\" data-dojo-props='type:\"text\",name:\"projectname\"' ></td></tr>\r\n\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t<td align=\"left\"><button data-dojo-attach-event=\"onClick: _clear_filter\" data-dojo-type=\"dijit/form/Button\" data-dojo-props='type:\"button\"' >Clear Filter by</button></td>\r\n\t\t\t\t\t\t\t\t<td align=\"right\"><button data-dojo-type=\"dijit/form/Button\" data-dojo-props='type:\"submit\",name:\"submit\"'>Filter by</button></td>\r\n\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t</table>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div data-dojo-attach-point=\"projects\" data-dojo-type=\"dijit/layout/ContentPane\" data-dojo-props='region:\"center\"'></div>\r\n\t\t</div>\r\n\t\t<div data-dojo-attach-point=\"edit\" data-dojo-type=\"research/projects/edit\" data-dojo-props='title:\"edit\",style:\"height:100%;width:100%\"'></div>\r\n\t\t<div data-dojo-attach-point=\"update_ctrl\" data-dojo-type=\"research/projects/update\" ></div>\r\n\t</div>\r\n</div>\r\n"}});define("research/projects/view",["dojo/_base/declare","ttl/BaseWidgetAMD","dojo/text!../projects/templates/view.html","dijit/layout/BorderContainer","ttl/grid/Grid","ttl/store/JsonRest","dojo/store/Observable","dojo/request","ttl/utilities2","dojo/json","dojo/topic","dojo/_base/lang","dojox/layout/ExpandoPane","dijit/layout/StackContainer","dijit/layout/ContentPane","research/projects/outletwizard","research/projects/edit","research/projects/update","dijit/Toolbar","dijit/form/DropDownButton","dijit/TooltipDialog","dijit/form/TextBox","dijit/form/Button"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c){return _1("research.projects.view",[_2,_4],{templateString:_3,gutters:false,constructor:function(){this.model=new _7(new _6({target:"/research/admin/projects/projects_list",idProperty:"researchprojectid"}));this._project_deleted_call_back=_c.hitch(this,this._project_deleted_call);this._project_send_call_back=_c.hitch(this,this._project_send_call);this.std_menu=null;this._is_monthly_std_menu=null;_b.subscribe("/project/update",_c.hitch(this,this._update_event));_b.subscribe("/project/add",_c.hitch(this,this._add_event));},postCreate:function(){var _d=[{label:" ",field:"menu",className:"grid-field-image-view",formatter:_9.format_row_ctrl},{label:"Id",className:"dgrid-column-nbr-right",field:"researchprojectid"},{label:"Project",className:"standard",field:"researchprojectname"},{label:"Owner",className:"standard",field:"ownername"},{label:"Start Date",className:"dgrid-column-date-small",field:"start_date_display"},{label:"Complete Date",className:"dgrid-column-date-small",field:"questionnaire_completed_display"},{label:"Nbr",className:"dgrid-column-nbr-right",field:"count"},{label:"R. Comp",className:"dgrid-column-nbr-right",field:"completed"},{label:"C. Comp",className:"dgrid-column-nbr-right",field:"customer_completed"},{label:"Nbr Em",className:"dgrid-column-nbr-right",field:"nbr_to_email"}];this.projects_grid=new _5({columns:_d,selectionMode:"single",store:this.model,sort:[{attribute:"researchprojectid",descending:true}]});this.projects.set("content",this.projects_grid);this.projects_grid.on(" .dgrid-cell:click",_c.hitch(this,this._on_cell_call));_b.subscribe("/projects/list",_c.hitch(this,this._show_list_event));this.inherited(arguments);},_project_deleted_call:function(_e){if(_e.success=="OK"){this.model.remove(_e.researchprojectid);}else{alert("Problem Deleting Project");}},_on_cell_call:function(e){var _f=this.projects_grid.cell(e);if(_f==null||_f.row==null){return;}this._selected_row=_f.row.data;if(_f.column.field=="menu"){this._show_menu(e);}else{this._edit_project();}},_show_menu:function(evt){var _10=null;if(this._selected_row.ismonthly==true){if(this._is_monthly_std_menu===null){this._is_monthly_std_menu=new dijit.Menu();this._is_monthly_std_menu.addChild(new dijit.MenuItem({label:"Delete Project",onClick:_c.hitch(this,this._delete_project)}));this._is_monthly_std_menu.addChild(new dijit.MenuItem({label:"Edit Project",onClick:_c.hitch(this,this._edit_project)}));this._is_monthly_std_menu.addChild(new dijit.MenuItem({label:"Update Project",onClick:_c.hitch(this,this._update_project)}));this._is_monthly_std_menu.startup();}_10=this._is_monthly_std_menu;}else{if(this.std_menu===null){this.std_menu=new dijit.Menu();if(PRMAX.Settings.is_r_adm==true){this.std_menu.addChild(new dijit.MenuItem({label:"Send Email",onClick:_c.hitch(this,this._send_quest)}));}this.std_menu.addChild(new dijit.MenuItem({label:"Delete Project",onClick:_c.hitch(this,this._delete_project)}));this.std_menu.addChild(new dijit.MenuItem({label:"Edit Project",onClick:_c.hitch(this,this._edit_project)}));this.std_menu.addChild(new dijit.MenuItem({label:"Update Project",onClick:_c.hitch(this,this._update_project)}));this.std_menu.startup();}_10=this.std_menu;}_10._openMyself(evt);},_edit_project:function(){this.edit.load(this._selected_row);this.zone.selectChild(this.edit);},_show_projects:function(){this.zone.selectChild(this.projects_views);},_refresh:function(){this.projects_grid.set("query",{});},_show_list_event:function(){this.projects_grid.set("query",{});this.zone.selectChild(this.projects_views);},_delete_project:function(){if(confirm("Delete Project")){_8.post("/research/admin/projects/project_delete",_9.make_params({data:{researchprojectid:this._selected_row.researchprojectid}})).then(this._project_deleted_call_back);}},_update_project:function(){this.update_ctrl.load(this._selected_row.researchprojectid);},_send_quest:function(){_8.post("/research/admin/projects/project_send",_9.make_params({data:{researchprojectid:this._selected_row.researchprojectid}})).then(this._project_send_call_back);},_project_send_call:function(_11){if(_11.success=="OK"){alert("Set Up for sending");this.model.put(_11.data);}else{alert("Problem sending emails");}},_clear_filter:function(){this.researchprojectname.set("value","");},_execute:function(){var _12={};if(arguments[0].researchprojectname.length>0){_12["researchprojectname"]=arguments[0].researchprojectname;}this.projects_grid.set("query",_12);},_update_event:function(_13){this.model.put(_13);},_add_event:function(_14){this.model.add(_14);}});});