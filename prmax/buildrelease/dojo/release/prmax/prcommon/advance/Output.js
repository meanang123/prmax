/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prcommon.advance.Output"]){dojo._hasResource["prcommon.advance.Output"]=true;dojo.provide("prcommon.advance.Output");dojo.require("ttl.BaseWidget");dojo.declare("prcommon.advance.Output",[ttl.BaseWidget],{widgetsInTemplate:true,templateString:"<div>\r\n\t<div  dojoAttachPoint=\"tabcont\" dojotype=\"dijit.layout.TabContainer\" style=\"width:100%;height:100%;padding:0px;margin:0px\" >\r\n\t\t<div dojoType=\"dijit.layout.ContentPane\" title=\"Labels\" preload=\"true\" >\r\n\t\t\t<form dojoType=\"dijit.form.Form\" onsubmit=\"return false\" dojoAttachPoint=\"labelFormNode\">\r\n\t\t\t\t<input type=\"hidden\" dojoType=\"dijit.form.TextBox\" name=\"advancefeatureslistid\" value = \"-1\" dojoAttachPoint=\"advancefeatureslistid_2\">\r\n\t\t\t\t<table width=\"100%\" class=\"prmaxtable\" >\r\n\t\t\t\t\t<tr><td colspan=\"2\">&nbsp;</td></tr>\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\" >Label Format</td>\r\n\t\t\t\t\t\t<td><select  name=\"labelid\" class=\"prmaxrequired\"\r\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"labelTemplateNode\"\r\n\t\t\t\t\t\t\tautoComplete=\"true\"\r\n\t\t\t\t\t\t\t searchAttr=\"name\"\r\n\t\t\t\t\t\t\t labelAttr=\"name\"\r\n\t\t\t\t\t\t\t dojoType=\"dijit.form.FilteringSelect\"\r\n\t\t\t\t\t\t\t required=\"true\"\r\n\t\t\t\t\t\t\tinvalidMessage=\"Please select label format\"\r\n\t\t\t\t\t\t\t labelType=\"html\"></select></td></tr>\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\" valign=\"top\">Selection</td><td><div  name = \"selector\" dojoAttachPoint=\"labelSelectionNode\" dojoType=\"prmax.common.SelectOptions\" ></div></td></tr>\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\" valign=\"top\">Show Label Outlines</td><td><input name=\"frame\" value=\"1\" class=\"prmaxinput\" type=\"checkbox\" dojoType=\"dijit.form.CheckBox\" /></td></tr>\r\n\t\t\t\t\t<tr><td colspan=\"2\">&nbsp;</td></tr>\r\n\t\t\t\t\t<tr><td colspan=\"2\" ><table width=\"100%\" class=\"prmaxtable\"><tr><td><div dojoType=\"prmax.common.ReportBuilder\" dojoAttachPoint=\"labelReportNode\" style=\"display:none\"></div></td></tr>\r\n\t\t\t\t\t\t<tr><td colspan=\"2\" align=\"right\"><button class=\"prmaxbutton\" dojoType=\"dojox.form.BusyButton\" busyLabel=\"Please Wait Generating Labels...\" label=\"Labels\" dojoAttachPoint=\"labelReportButtonNode\" dojoAttachEvent=\"onClick:_labelreport\"></button></td></tr>\r\n\t\t\t\t\t</table></td></tr>\r\n\t\t\t\t</table>\r\n\t\t\t</form>\r\n\t\t</div>\r\n\t\t<div dojoType=\"dijit.layout.ContentPane\" title=\"Reports\" preload=\"true\" selected>\r\n\t\t\t<form dojoType=\"dijit.form.Form\" onsubmit=\"return false\" dojoAttachPoint=\"formNode\">\r\n\t\t\t\t<input type=\"hidden\" dojoType=\"dijit.form.TextBox\" name=\"advancefeatureslistid\" value = \"-1\" dojoAttachPoint=\"advancefeatureslistid_1\">\r\n\t\t\t\t<table width=\"100%\" class=\"prmaxtable\" >\r\n\t\t\t\t\t<tr><td colspan=\"2\">&nbsp;</td></tr>\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\" >Report</td>\r\n\t\t\t\t\t\t<td><select  name=\"reporttemplateid\" class=\"prmaxrequired\"\r\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"reportTemplateNode\"\r\n\t\t\t\t\t\t\t\tautoComplete=\"true\"\r\n\t\t\t\t\t\t\t\t searchAttr=\"reporttemplatename\"\r\n\t\t\t\t\t\t\t\t labelAttr=\"reporttemplatename\"\r\n\t\t\t\t\t\t\t\t dojoType=\"dijit.form.FilteringSelect\"\r\n\t\t\t\t\t\t\t\t labelType=\"html\"></select></td></tr>\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\">Selection</td><td><div  name = \"selector\" dojoAttachPoint=\"selectionNode\"  dojoType=\"prmax.common.SelectOptions\" ></div></td></tr>\r\n\t\t\t\t\t<tr><td colspan=\"2\">&nbsp;</td></tr>\r\n\t\t\t\t\t<tr><td colspan=\"2\" >\r\n\t\t\t\t\t\t<table width=\"100%\" class=\"prmaxtable\">\r\n\t\t\t\t\t\t\t<tr><td><div dojoType=\"prmax.common.ReportBuilder\" dojoAttachPoint=\"reportNode\" style=\"display:none\"></div></td></tr>\r\n\t\t\t\t\t\t\t<tr><td colspan=\"2\" align=\"right\"><button class=\"prmaxbutton\" dojoType=\"dojox.form.BusyButton\" busyLabel=\"Please Wait Generating Report...\" label=\"Generate\" dojoAttachPoint=\"reportButtonNode\" dojoAttachEvent=\"onClick:_report\"></button></td></tr>\r\n\t\t\t\t\t\t</table></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</form>\r\n\t\t</div>\r\n\t\t<div dojoAttachPoint=\"excelview\" dojoType=\"dijit.layout.ContentPane\" title=\"Excel\" preload=\"true\" >\r\n\t\t\t<form dojoType=\"dijit.form.Form\" onsubmit=\"return false\" dojoAttachPoint=\"csvFormNode\">\r\n\t\t\t\t<input type=\"hidden\" dojoType=\"dijit.form.TextBox\" name=\"advancefeatureslistid\" value = \"-1\" dojoAttachPoint=\"advancefeatureslistid_3\">\r\n\t\t\t\t<table width=\"100%\" class=\"prmaxtable\" >\r\n\t\t\t\t\t<tr><td colspan=\"2\">&nbsp;</td></tr>\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\" >Formats</td><td><select  name=\"reporttemplateid\" class=\"prmaxrequired\" dojoAttachPoint=\"csvTemplateNode\" autoComplete=\"true\" searchAttr=\"reporttemplatename\" labelAttr=\"reporttemplatename\" dojoType=\"dijit.form.FilteringSelect\" labelType=\"html\"></select></td></tr>\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\">Selection</td><td><div name = \"selector\" dojoAttachPoint=\"csvSelectionNode\" dojoType=\"prmax.common.SelectOptions\" ></div></td></tr>\r\n\t\t\t\t\t<tr><td colspan=\"2\">&nbsp;</td></tr>\r\n\t\t\t\t\t<tr><td colspan=\"2\" >\r\n\t\t\t\t\t\t<table width=\"100%\" class=\"prmaxtable\">\r\n\t\t\t\t\t\t\t<tr><td><div dojoType=\"prmax.common.ReportBuilder\" dojoAttachPoint=\"csvReportNode\" style=\"display:none\"></div></td></tr>\r\n\t\t\t\t\t\t\t<tr><td colspan=\"2\" align=\"right\"><button class=\"prmaxbutton\" dojoType=\"dojox.form.BusyButton\" busyLabel=\"Please Wait Excel Report...\" label=\"Report\" dojoAttachPoint=\"csvReportButtonNode\" dojoAttachEvent=\"onClick:_csvreport\"></td></tr>\r\n\t\t\t\t\t\t</table></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</form>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n",constructor:function(){this._reportlist=new dojo.data.ItemFileReadStore({url:"/reports/reporttemplates?reportsourceid=6"});this._labellist=new dojo.data.ItemFileReadStore({url:"/common/lookups?searchtype=labels"});this._csvlist=new dojo.data.ItemFileReadStore({url:"/reports/reporttemplates?reportsourceid=7"});this._completecall=dojo.hitch(this,this._complete);},postCreate:function(){this.inherited(arguments);this.reportTemplateNode.store=this._reportlist;this.labelTemplateNode.store=this._labellist;this.csvTemplateNode.store=this._csvlist;},startup:function(){this.inherited(arguments);if(PRMAX.utils.settings.no_export==true){this.excelview.controlButton.domNode.style.display="none";}},Load:function(_1,_2){this.Clear();this.selectionNode.setOptions(_2);this.labelSelectionNode.setOptions(_2);this.csvSelectionNode.setOptions(_2);this.advancefeatureslistid_1.set("value",_1);this.advancefeatureslistid_2.set("value",_1);this.advancefeatureslistid_3.set("value",_1);},_report:function(){if(ttl.utilities.formValidator(this.formNode)==false){alert("Not all required field filled in");this.reportButtonNode.cancel();return;}var _3=this.formNode.get("value");_3["reportoutputtypeid"]=0;_3["sortorder"]=1;this.reportNode.SetCompleted(this._completecall);this.reportNode.StartNoDialog(_3);},_complete:function(){dojo.publish(PRCOMMON.Events.Dialog_Close,["adv_out"]);this.labelReportButtonNode.cancel();this.labelReportNode.hide();this.reportButtonNode.cancel();this.reportNode.hide();},Clear:function(_4){this.labelReportButtonNode.cancel();this.reportButtonNode.cancel();this.csvReportButtonNode.cancel();this.labelReportNode.Stop();this.labelSelectionNode.setOptions(_4);this.reportNode.Stop();this.selectionNode.setOptions(_4);this.csvReportNode.Stop();this.csvSelectionNode.setOptions(_4);},resize:function(){this.tabcont.resize(arguments[0]);},_labelreport:function(){if(ttl.utilities.formValidator(this.labelFormNode)==false){alert("Not all required field filled in");this.labelReportButtonNode.cancel();return;}if(ttl.utilities.testPopUpBlocker()==true){alert("Pop-up blocked");this.labelReportButtonNode.cancel();return;}var _5=this.labelFormNode.get("value");_5["reporttemplateid"]=0;_5["reportoutputtypeid"]=3;_5["sortorder"]=PRMAX.search.getSortIndex();_5["searchtypeid"]=10;this.labelReportNode.SetCompleted(this._completecall);this.labelReportNode.StartNoDialog(_5);},_csvreport:function(){if(ttl.utilities.formValidator(this.csvFormNode)==false){alert("Not all required field filled in");this.csvReportButtonNode.cancel();return;}var _6=this.csvFormNode.get("value");_6["reportoutputtypeid"]=2;_6["sortorder"]=PRMAX.search.getSortIndex();_6["searchtypeid"]=10;this.csvReportNode.SetCompleted(this._completecall);this.csvReportNode.StartNoDialog(_6);}});}