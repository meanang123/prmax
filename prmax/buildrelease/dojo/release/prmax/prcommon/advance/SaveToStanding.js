/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prcommon.advance.SaveToStanding"]){dojo._hasResource["prcommon.advance.SaveToStanding"]=true;dojo.provide("prcommon.advance.SaveToStanding");dojo.require("ttl.BaseWidget");dojo.declare("prcommon.advance.SaveToStanding",[ttl.BaseWidget],{widgetsInTemplate:true,templateString:"<div>\r\n\t<div  dojoAttachPoint=\"borderCtrl\" dojotype=\"dijit.layout.BorderContainer\" style=\"width:100%;height:100%\" >\r\n\t\t<div  dojoAttachPoint=\"tabController\" dojotype=\"dijit.layout.TabContainer\" style=\"width:100%;height:100%\">\r\n\t\t\t<div dojoAttachPoint=\"savetolisttab\" dojoType=\"dijit.layout.ContentPane\" title=\"Existing Media List\" style=\"width:100%;height:385px;padding:5px\">\r\n\t\t\t\t<form class=\"prmaxdefault\" dojoAttachPoint=\"requiredNode\" onSubmit=\"return false\" dojoType=\"dijit.form.Form\">\r\n\t\t\t\t\t<input type=\"hidden\" dojoType=\"dijit.form.TextBox\" dojoAttachPoint=\"advancefeatureslistid\" name=\"advancefeatureslistid\" >\r\n\t\t\t\t\t<table width=\"100%\" class=\"prmaxtable\" cellpadding=\"0\" cellpadding=\"0\">\r\n\t\t\t\t\t\t<tr><td colspan=\"2\">&nbsp;</td></tr>\r\n\t\t\t\t\t\t<tr><td class=\"prmaxrowtag\" valign=\"top\">Selection</td><td><div name=\"selection\" dojoAttachPoint=\"source\" dojoType=\"prmax.common.SelectOptions\" ></td></tr>\r\n\t\t\t\t\t\t<tr><td class=\"prmaxrowtag\" width=\"20%\" >List Name</td><td><div dojoType=\"dijit.form.FilteringSelect\"\r\n\t\t\t\t\t\t\t\tname=\"listid\" dojoAttachPoint=\"lists\" required=\"true\" pageSize=\"20\" autoComplete=\"true\" labelAttr=\"listname\" searchAttr=\"listname\"\r\n\t\t\t\t        promptMessage=\"Please Select a list\"\r\n\t\t\t\t\t\t\t\tmissingMessage=\"A Standling List is Required\"></div></td></tr>\r\n\t\t\t\t\t\t<tr><td colspan=\"2\">&nbsp;</td></tr>\r\n\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t<td align=\"left\"><button class=\"prmaxbutton\" dojoType=\"dijit.form.Button\" type=\"button\" dojoAttachEvent=\"onClick:_Cancel\" >Cancel</button></td>\r\n\t\t\t\t\t\t\t<td align=\"right\"><button class=\"prmaxbutton\" type=\"button\" dojoAttachEvent=\"onClick:_DoSave\" dojoAttachPoint=\"saveNode\" dojoType=\"dojox.form.BusyButton\" busyLabel=\"Please Wait Saving To...\" label=\"Add to Existing Media List\"></button></td></tr>\r\n\t\t\t\t\t</table>\r\n\t\t\t\t</form>\r\n\t\t\t</div>\r\n\t\t\t<div dojoType=\"dijit.layout.ContentPane\" title=\"New Media List\" style=\"width:100%;height:385px;padding:5px\">\r\n\t\t\t\t<form class=\"prmaxdefault\" dojoAttachPoint=\"formNew\" dojoType=\"dijit.form.Form\" onsubmit=\"return false\">\r\n\t\t\t\t\t<input type=\"hidden\" dojoType=\"dijit.form.TextBox\" dojoAttachPoint=\"advancefeatureslistid2\" name=\"advancefeatureslistid\" >\r\n\t\t\t\t\t<table class=\"prmaxtable\" width=\"100%\">\r\n\t\t\t\t\t\t<tr><td colspan=\"2\">&nbsp;</td></tr>\r\n\t\t\t\t\t\t<tr><td class=\"prmaxrowtag\" valign=\"top\">Selection</td><td><div name=\"selection\" dojoAttachPoint=\"source2\" dojoType=\"prmax.common.SelectOptions\" ></td></tr>\r\n\t\t\t\t\t\t<tr><td class=\"prmaxrowtag\">New Media List Name</label></td><td><input dojoAttachPoint=\"listname\" dojoType=\"dijit.form.ValidationTextBox\" name=\"listname\" required=\"true\" trim=\"true\" maxlength=\"45\" promptMessage=\"Enter new list name\" type=\"text\"></td></tr>\r\n\t\t\t\t\t\t<tr><td colspan=\"2\">&nbsp;</td></tr>\r\n\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t<td align=\"left\"><button class=\"prmaxbutton\" dojoType=\"dijit.form.Button\" type=\"button\" dojoAttachEvent=\"onClick:_Cancel\" >Cancel</button></td>\r\n\t\t\t\t\t\t\t\t<td align=\"right\"><button class=\"prmaxbutton\" dojoAttachEvent=\"onClick:_SaveNew\" dojoAttachPoint=\"saveNewNode\" dojoType=\"dojox.form.BusyButton\" type=\"button\" >Add to New Media List</button></td>\r\n\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t</table>\r\n\t\t\t\t</form>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n",constructor:function(){this._SavedCallBack=dojo.hitch(this,this._SavedCall);this._SaveNewCallBack=dojo.hitch(this,this._SaveNewCall);this.store=new dojox.data.QueryReadStore({url:"/lists/lists?listtypeid=1",onError:ttl.utilities.globalerrorchecker});},postCreate:function(){this.lists.store=this.store;this.inherited(arguments);},Load:function(_1,_2,_3){this._Clear();this.advancefeatureslistid.set("value",_1);this.source.setOptions(_2);this.advancefeatureslistid2.set("value",_1);this.source2.setOptions(_2);this._dlg=_3;},_DoSave:function(){if(ttl.utilities.formValidator(this.requiredNode)==false||confirm("Save To Media List?")==false){this.saveNode.cancel();return;}dojo.xhrPost(ttl.utilities.makeParams({load:this._SavedCallBack,url:"/advance/save_to_standing",content:this.requiredNode.get("value")}));},_SavedCall:function(_4){if(_4.success=="OK"){alert("Saved to Media List");this._dlg.hide();this._Clear();}else{alert("Problem Saving to Media List");}this.saveNode.cancel();},_SaveNewCall:function(_5){if(_5.success=="OK"){this._dlg.hide();this._Clear();alert("Saved to Media List");}else{if(_5.success=="DU"){this.listname.focus();alert("List Already exists");}else{alert("Problem Saving to Media List");}}this.saveNewNode.cancel();},_SaveNew:function(){if(ttl.utilities.formValidator(this.formNew)==false||confirm("Save To New Media List?")==false){this.saveNewNode.cancel();return;}dojo.xhrPost(ttl.utilities.makeParams({load:this._SaveNewCallBack,url:"/advance/save_to_standing_new",content:this.formNew.get("value")}));},_Cancel:function(){this._dlg.hide();this._Clear();},_Clear:function(){this.saveNewNode.cancel();this.saveNode.cancel();this.listname.set("value","");this.tabController.selectChild(this.savetolisttab);this.advancefeatureslistid.set("value",null);this.advancefeatureslistid2.set("value",null);},resize:function(){this.tabController.resize({h:435,width:400});}});}