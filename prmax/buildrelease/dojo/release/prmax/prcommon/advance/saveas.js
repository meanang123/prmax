/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prcommon.advance.saveas"]){dojo._hasResource["prcommon.advance.saveas"]=true;dojo.provide("prcommon.advance.saveas");dojo.require("ttl.BaseWidget");dojo.declare("prcommon.advance.saveas",[ttl.BaseWidget],{widgetsInTemplate:true,templateString:"<div>\r\n\t<div  dojoAttachPoint=\"borderCtrl\" dojotype=\"dijit.layout.BorderContainer\" style=\"width:100%;height:100%\" >\r\n\t\t<div  dojoAttachPoint=\"tabController\" dojotype=\"dijit.layout.TabContainer\" style=\"width:100%;height:100%\">\r\n\t\t\t<div dojoAttachPoint=\"savetolisttab\" dojoType=\"dijit.layout.ContentPane\" title=\"Save To Existing List\" style=\"width:100%;height:385px;padding:5px\">\r\n\t\t\t\t<form class=\"prmaxdefault\" dojoAttachPoint=\"form\" dojoType=\"dijit.form.Form\" onsubmit=\"return false\">\r\n\t\t\t\t<input dojoType=\"dijit.form.TextBox\" type=\"hidden\" dojoAttachPoint=\"advancefeatureslistid\" name=\"advancefeatureslistid\"></input>\r\n\t\t\t\t<br/>\r\n\t\t\t\t<table class=\"prmaxtable\" cellpadding=\"0\" cellspacing =\"0\" style=\"border-style:collapsed\" width=\"100%\">\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\" valign=\"top\">Selection</td><td><div name=\"selection\" dojoAttachPoint=\"source\" dojoType=\"prmax.common.SelectOptions\" i></td></tr\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td class=\"prmaxlabeltag\" >Features List Name</label></td>\r\n\t\t\t\t\t\t<td><input name=\"destinationid\" dojoType=\"dijit.form.FilteringSelect\" dojoAttachPoint=\"lists\" pageSize=\"20\" autoComplete=\"true\" labelAttr=\"advancefeatureslistdescription\" searchAttr=\"advancefeatureslistdescription\"></input></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t<tr><td>&nbsp;</td></tr>\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\">List Options</td><td>\r\n\t\t\t\t\t\t\t<input dojoAttachPoint=\"override_button\" type=\"radio\" name=\"overwrite\" dojotype=\"dijit.form.RadioButton\" value=\"1\" /> <label dojoAttachPoint=\"label_overwrite\" class=\"prmaxlabeltag\" >Overwrite</label>\r\n\t\t\t\t\t\t\t<input dojoAttachPoint=\"append_button\" type=\"radio\" name=\"overwrite\" dojotype=\"dijit.form.RadioButton\" value=\"0\" checked =\"checked\"/> <label class=\"prmaxlabeltag\" dojoAttachPoint=\"label_append\" >Append</label>\r\n\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t<tr><td>&nbsp;</td></tr>\r\n\t\t\t\t\t<tr><td>&nbsp;</td></tr>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td align=\"left\"><button class=\"prmaxbutton\" dojoType=\"dijit.form.Button\" dojoAttachEvent=\"onClick:_Cancel\" type=\"button\" >Close</button></td>\r\n\t\t\t\t\t\t<td align=\"right\"><button class=\"prmaxbutton\" dojoAttachEvent=\"onClick:_Save\" dojoAttachPoint=\"saveNode\" dojoType=\"dojox.form.BusyButton\" busyLabel=\"Please Wait Saving...\" label=\"Save\"></td>\r\n\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t</table>\r\n\t\t\t\t</form>\r\n\t\t\t</div>\r\n\t\t\t<div dojoType=\"dijit.layout.ContentPane\" title=\"Save To New List\" style=\"width:100%;height:385px;padding:5px\">\r\n\t\t\t\t<form class=\"prmaxdefault\" dojoAttachPoint=\"form2\" dojoType=\"dijit.form.Form\" onsubmit=\"return false\">\r\n\t\t\t\t<input dojoType=\"dijit.form.TextBox\" type=\"hidden\" dojoAttachPoint=\"advancefeatureslistid2\" name=\"advancefeatureslistid\"></input>\r\n\t\t\t\t<br/>\r\n\t\t\t\t<table class=\"prmaxtable\" cellpadding=\"0\" cellspacing =\"0\" style=\"border-style:collapsed\" width=\"100%\">\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\" valign=\"top\">Selection</td><td><div name=\"selection\" dojoAttachPoint=\"source2\" dojoType=\"prmax.common.SelectOptions\" i></td></tr>\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\">New List Name</td><td><input dojoType=\"dijit.form.ValidationTextBox\" name=\"listname\" dojoAttachPoint=\"listname\" required=\"true\" trim=\"true\"></td><td></td></tr>\r\n\t\t\t\t\t<tr><td>&nbsp;</td></tr>\r\n\t\t\t\t\t<tr><td>&nbsp;</td></tr>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td align=\"left\"><button class=\"prmaxbutton\" dojoType=\"dijit.form.Button\" dojoAttachEvent=\"onClick:_Cancel\" type=\"button\" >Close</button></td>\r\n\t\t\t\t\t\t<td align=\"right\"><button class=\"prmaxbutton\" dojoAttachEvent=\"onClick:_Add\" dojoAttachPoint=\"addNode\" dojoType=\"dojox.form.BusyButton\" busyLabel=\"Please Wait Saving...\" label=\"Save\"></td>\r\n\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t</table>\r\n\t\t\t\t</form>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n",constructor:function(){this._SaveAsCallBack=dojo.hitch(this,this._SaveAsCall);this._SaveCallBack=dojo.hitch(this,this._SaveCall);this.store=new dojox.data.QueryReadStore({url:"/advance/lists",onError:ttl.utilities.globalerrorchecker});},postCreate:function(){this.lists.store=this.store;this.inherited(arguments);},focus:function(){this.listname.focus();},Load:function(_1,_2){this.advancefeatureslistid.set("value",_1);this.advancefeatureslistid2.set("value",_1);this.source.setOptions(_2);this.source2.setOptions(_2);this._Clear();},_Cancel:function(){dojo.publish(PRCOMMON.Events.Dialog_Close,["adv_saveas_del"]);this._Clear();},_Clear:function(){this.saveNode.cancel();this.addNode.cancel();this.listname.set("value","");this.lists.set("value",null);this.tabController.selectChild(this.savetolisttab);},_SaveAsCall:function(_3){if(_3.success=="OK"){dojo.publish(PRCOMMON.Events.Advance_Session_Changed,[_3.data]);this._Clear();this._Cancel();}else{if(_3.success=="SA"){alert("Cannot Save to Self");}else{alert("problem Saving too list");}}this.saveNode.cancel();},_Save:function(){if(ttl.utilities.formValidator(this.form)==false){alert("Not all required fields filled in");return;}dojo.xhrPost(ttl.utilities.makeParams({load:this._SaveAsCallBack,url:"/advance/saveas",content:this.form.get("value")}));},_Add:function(){if(ttl.utilities.formValidator(this.form2)==false){alert("Not all required fields filled in");return;}dojo.xhrPost(ttl.utilities.makeParams({load:this._SaveCallBack,url:"/advance/saveas_new",content:this.form2.get("value")}));},_SaveCall:function(_4){if(_4.success=="OK"){dojo.publish(PRCOMMON.Events.Advance_Session_Changed,[_4.data]);this._Clear();this._Cancel();}else{if(_4.success=="DU"){alert("List Already Exists");this.listname.focus();}else{alert("Problem Creating List");}}this.addNode.cancel();},resize:function(){this.tabController.resize({h:435,width:400});}});}