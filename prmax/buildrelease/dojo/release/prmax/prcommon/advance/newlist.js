/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prcommon.advance.newlist"]){dojo._hasResource["prcommon.advance.newlist"]=true;dojo.provide("prcommon.advance.newlist");dojo.require("ttl.BaseWidget");dojo.declare("prcommon.advance.newlist",[ttl.BaseWidget],{widgetsInTemplate:true,templateString:"<div>\r\n\t<form class=\"prmaxdefault\" dojoAttachPoint=\"form\" dojoType=\"dijit.form.Form\" onsubmit=\"return false\">\r\n\t<input type=\"hidden\" dojoType=\"dijit.form.TextBox\" dojoAttachPoint=\"advancefeatureslistid\" name =\"advancefeatureslistid\">\r\n\t<br/>\r\n\t<table class=\"prmaxtable\" cellpadding=\"0\" cellspacing =\"0\" style=\"border-style:collapsed\" width=\"100%\">\r\n\t\t<tr>\r\n\t\t\t<td class=\"prmaxlabeltag\" >List Name</label></td>\r\n\t\t\t<td><input dojoType=\"dijit.form.ValidationTextBox\" name=\"listname\" dojoAttachPoint=\"listname\" required=\"true\" trim=\"true\" maxlength=\"45\" promptMessage=\"Enter new list name\" type=\"text\"  ></td>\r\n\t\t</tr>\r\n\t\t<tr><td>&nbsp;</td></tr>\r\n\t\t<tr><td>&nbsp;</td></tr>\r\n\t\t<tr><td>&nbsp;</td></tr>\r\n\t\t<tr>\r\n\t\t\t<td align=\"left\"><button class=\"prmaxbutton\" dojoType=\"dijit.form.Button\" dojoAttachEvent=\"onClick:_Cancel\" type=\"button\" >Cancel</button></td>\r\n\t\t\t<td align=\"right\"><button class=\"prmaxbutton\" iconClass=\"dijitPrmaxIcon dijitPrmaxAdd\" dojoAttachEvent=\"onClick:_Save\" dojoAttachPoint=\"saveNode\" dojoType=\"dojox.form.BusyButton\" busyLabel=\"Please Wait Saving...\" label=\"Save\"></td>\r\n\t\t</tr>\r\n\t\t<tr><td>&nbsp;</td></tr>\r\n\t\t</table>\r\n\t</form>\r\n</div>\r\n",constructor:function(){this._SaveCallBack=dojo.hitch(this,this._SaveCall);this._advancefeatureslistid=null;},focus:function(){this.listname.focus();},Load:function(_1){dojo.attr(this.advancefeatureslistid,"value",_1);this._advancefeatureslistid=_1;},_Cancel:function(){dojo.publish(PRCOMMON.Events.Dialog_Close,["adv_save_del"]);this.saveNode.cancel();},show:function(){this.saveNode.cancel();this.listname.set("value",null);this.listname.focus();},_SaveCall:function(_2){if(_2.success=="OK"){this.listname.set("value",null);this._Cancel();_2.data.advance.selected=false;if(this._advancefeatureslistid==null){_2.data.advance.qty=0;dojo.publish(PRCOMMON.Events.Feature_List_Add,[_2.data.advance]);}else{_2.data.advance.qty=_2.data.qty;dojo.publish(PRCOMMON.Events.Feature_List_Update,[_2.data.advance]);}}else{if(_2.success=="DU"){alert("List Already Exists");this.saveNode.cancel();this.listname.focus();}else{alert("Problem Creating List");this.saveNode.cancel();}}},_Save:function(){if(ttl.utilities.formValidator(this.form)==false){alert("Not all required fields filled in");return;}dojo.xhrPost(ttl.utilities.makeParams({load:this._SaveCallBack,url:"/advance/createlist",content:this.form.get("value")}));}});}