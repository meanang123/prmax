/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prcommon.advance.listview"]){dojo._hasResource["prcommon.advance.listview"]=true;dojo.provide("prcommon.advance.listview");dojo.declare("prcommon.advance.listview",[ttl.BaseWidget],{widgetsInTemplate:true,templateString:"<div>\r\n\t<div dojoAttachPoint=\"frame\" dojoType=\"dijit.layout.BorderContainer\" style=\"width:100%;height:100%\">\r\n\t\t<div dojoType=\"dijit.layout.ContentPane\" region=\"top\"  style=\"height:50%\">\r\n\t\t\t<div dojoAttachPoint=\"innerframe\" class=\"outletdisplay prmaxhidden\">\r\n\t\t\t\t<table style=\"width:100%;border-style:collapsed; margin:5px\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowdisplaylarge\" valign=\"top\" width=\"10%\"></td><td class=\"prmaxrowdisplaylarge\" dojoAttachPoint=\"feature\"></td></tr>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<tr><td width=\"10%\"class=\"prmaxrowtag\"></td><td class=\"prmaxrowdisplayinfo\" dojoAttachPoint=\"contactdisplay\"></td></tr>\r\n\t\t\t\t\t<tr><td width=\"10%\"class=\"prmaxrowtag\"></td><td class=\"prmaxrowdisplayinfo\" dojoAttachPoint=\"editorialdisplay\"></td></tr>\r\n\t\t\t\t\t<tr><td width=\"10%\"class=\"prmaxrowtag\"></td><td class=\"prmaxrowdisplayinfo\" dojoAttachPoint=\"coverdisplay\"></td></tr>\r\n\t\t\t\t\t<tr><td width=\"10%\"class=\"prmaxrowtag\"></td><td class=\"prmaxrowdisplayinfo\" dojoAttachPoint=\"publicationdisplay\"></td></tr>\r\n\r\n<!--\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\" width=\"20%\">Feature Details</td><td class=\"prmaxrowdisplay\" dojoAttachPoint=\"featuredescription\"></td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\" width=\"20%\">Editorial Date</td><td class=\"prmaxrowdisplay\" dojoAttachPoint=\"editorial_date\"></td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">Cover Date</td><td class=\"prmaxrowdisplay\" dojoAttachPoint=\"cover_date\"></td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">Publication Date</td><td class=\"prmaxrowdisplay\" dojoAttachPoint=\"publicationdate\"></td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">Feature Interest</td><td class=\"prmaxrowdisplay\" dojoAttachPoint=\"interests\"></td></tr>\r\n-->\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div dojoType=\"dijit.layout.ContentPane\" region=\"center\" style=\"height:50%\">\r\n\t\t\t<div dojoAttachPoint=\"grid\" dojoType=\"dojox.grid.DataGrid\" query=\"{ name:'*'}\" rowsPerPage=\"50\" style=\"width:100%;height:100%\" ></div>\r\n\t\t</div>\r\n\r\n\t</div>\r\n</div>\r\n",constructor:function(){this.model=new prcommon.data.QueryWriteStore({url:"/advance/listoutlet",nocallback:false,onError:ttl.utilities.globalerrorchecker});this._LoadAdvanceCallBack=dojo.hitch(this,this._LoadAdvanceCall);},postCreate:function(){this.grid.set("structure",this.view);this.grid._setStore(this.model);this.grid["onRowClick"]=dojo.hitch(this,this._OnSelectRow);this.grid["onCellClick"]=dojo.hitch(this,this._OnSelectRow);this.grid["onStyleRow"]=dojo.hitch(this,ttl.GridHelpers.onStyleRow);this.inherited(arguments);},Load:function(_1,_2){this.grid.setQuery(ttl.utilities.getPreventCache({outletid:_1}));if(_2&&_2!=-1){this.LoadAdvance(_2);}else{dojo.addClass(this.innerframe,"prmaxhidden");}},_OnSelectRow:function(e){var _3=this.grid.getItem(e.rowIndex);this.grid.selection.clickSelectEvent(e);this.LoadAdvance(_3.i.advancefeatureid);},_LoadAdvanceCall:function(_4){if(_4.success=="OK"){var _5="";var _6="";var _7="";var _8="";dojo.attr(this.feature,"innerHTML",_4.data.advance.feature);if(_4.data.advance.editorial_date_display){_6="Editorial Deadline "+_4.data.advance.editorial_date_display;dojo.attr(this.editorialdisplay,"innerHTML",_6);}if(_4.data.advance.cover_date_display){_7="Cover Date "+_4.data.advance.cover_date_display;dojo.attr(this.coverdisplay,"innerHTML",_7);}if(_4.data.advance.contactname){_5="Contact "+_4.data.advance.contactname+" "+_4.data.advance.contactemail;dojo.attr(this.contactdisplay,"innerHTML",_5);}if(_4.data.advance.pub_date_display){_8="Puiblication Date "+_4.data.advance.pub_date_display;dojo.attr(this.publicationdisplay,"innerHTML",_8);}dojo.removeClass(this.innerframe,"prmaxhidden");}else{alert("Load Features Problem");}},ShowFeature:function(_9){this.LoadAdvance(_9);},LoadAdvance:function(_a){dojo.xhrPost(ttl.utilities.makeParams({load:this._LoadAdvanceCallBack,url:"/advance/get_ext",content:{advancefeatureid:_a}}));},view:{cells:[[{name:"Publication Date",width:"220px",field:"pub_date_display"},{name:"Feature",width:"auto",field:"feature"}]]},resize:function(){this.frame.resize(arguments[0]);this.inherited(arguments);}});}