/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prcommon.clippings.clippingoutput"]){dojo._hasResource["prcommon.clippings.clippingoutput"]=true;dojo.provide("prcommon.clippings.clippingoutput");dojo.require("ttl.BaseWidget");dojo.require("dijit.layout.TabContainer");dojo.require("prmax.common.ReportBuilder");dojo.declare("prcommon.clippings.clippingoutput",[ttl.BaseWidget],{templateString:"<div>\r\n\t\t<div data-dojo-attach-point=\"tabcont\" data-dojo-type=\"dijit.layout.TabContainer\" data-dojo-props='style:\"width:100%;height:100%;padding:0px;margin:0px\"' >\r\n\t\t\t<div data-dojo-type=\"dijit.layout.ContentPane\"  data-dojo-props='style:\"width:100%;height:100%\",title:\"PowerPoint\"'>\r\n\t\t\t\t<br/>\r\n\t\t\t\t<label>Style</label><select data-dojo-props='autoComplete:true,searchAttr:\"name\",labelType:\"html\",style:\"width:8em\",name:\"clippingsreportid\"' data-dojo-type=\"dijit.form.FilteringSelect\" data-dojo-attach-point=\"crppid\"></select>\r\n\t\t\t</div>\r\n\t\t\t<div data-dojo-type=\"dijit.layout.ContentPane\"  data-dojo-props='style:\"width:100%;height:100%\",title:\"Excel\"'>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div data-dojo-type=\"dijit.layout.ContentPane\" data-dojo-props='style:\"height:50px;width:100%;padding:0x;margin:0px;overflow:hidden\"'>\r\n\t\t\t<div data-dojo-type=\"prmax.common.ReportBuilder\" data-dojo-attach-point=\"report_node\" data-dojo-props='style:\"display:none\"'></div>\r\n\t\t\t<button data-dojo-type=\"dojox.form.BusyButton\" data-dojo-props='busyLabel:\"Please Wait Generating Report...\",label:\"Generate\",style:\"float:right\"' data-dojo-attach-point=\"reportbtn\" data-dojo-attach-event=\"onClick:_report\"></button>\r\n\t\t</div>\r\n</div>\r\n\r\n",widgetsInTemplate:true,constructor:function(){this._pp_reports=new dojo.data.ItemFileReadStore({url:"/common/lookups_restricted?searchtype=clippingreports&set=1"});this._complete_call_back=dojo.hitch(this,this._complete_call);},postCreate:function(){this.inherited(arguments);this.crppid.set("store",this._pp_reports);},startup:function(){this.inherited(arguments);},resize:function(){this.tabcont.resize({w:600,h:280});},_report:function(){var _1={};_1["reporttemplateid"]=-2;_1["clippingsreportid"]=this.crppid.get("value");this.report_node.SetCompleted(this._complete_call_back);this.report_node.StartNoDialog(_1);},_complete_call:function(){this.reportbtn.cancel();this.report_node.hide();},});}