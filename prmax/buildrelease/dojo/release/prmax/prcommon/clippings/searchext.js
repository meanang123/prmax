/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prcommon.clippings.searchext"]){dojo._hasResource["prcommon.clippings.searchext"]=true;dojo.provide("prcommon.clippings.searchext");dojo.require("ttl.BaseWidget");dojo.require("prcommon.date.daterange");dojo.require("dojox.data.JsonRestStore");dojo.declare("prcommon.clippings.searchext",[ttl.BaseWidget],{widgetsInTemplate:true,templateString:"<div >\r\n\t<form data-dojo-attach-point=\"form\" data-dojo-props='onsubmit:\"return false\",\"class\":\"common_prmax_layout\"' data-dojo-type=\"dijit.form.Form\">\r\n\t\t<br/>\r\n\t\t<label class=\"label_1 label_right\">Client</label><select data-dojo-props='autoComplete:true,searchAttr:\"clientname\",labelType:\"html\",style:\"width:8em\",placeHolder:\"No Selection\"' data-dojo-type=\"dijit.form.FilteringSelect\" data-dojo-attach-point=\"clientid\"></select><br/>\r\n\t\t<p class=\"spacer\">&nbsp;</p>\r\n\t\t<label class=\"label_1 label_right\">Date Range</label><div data-dojo-type=\"prcommon.date.daterange\" data-dojo-attach-point=\"drange\" data-dojo-props='value:\"\",name:\"drange\"'></div><br/>\r\n\t\t<p class=\"spacer\">&nbsp;</p>\r\n\t\t<label class=\"label_1 label_right\" data-dojo-attach-point=\"issue_label_1\">Issue</label><select data-dojo-props='name:\"issueid\",autoComplete:true,searchAttr:\"name\",invalidMessage:\"Select\",labelType:\"html\",placeHolder:\"No Selection\"' data-dojo-type=\"dijit.form.FilteringSelect\" data-dojo-attach-point=\"issueid\"></select></br>\r\n\t\t<p class=\"spacer\">&nbsp;</p>\r\n\t\t<label class=\"label_1 label_right\">Outlet</label><select data-dojo-props='name:\"outletid\",autoComplete:true,searchAttr:\"outletname\",required:true,placeHolder:\"No Selection\",pageSize:20,required:false' data-dojo-type=\"dijit.form.FilteringSelect\" data-dojo-attach-point=\"outletid\"></select></br>\r\n\t\t<p class=\"spacer\">&nbsp;</p>\r\n\t\t<label class=\"label_1 label_right\">Text</label><input data-dojo-type=\"dijit.form.TextBox\" data-dojo-attach-point=\"textid\" data-dojo-props='type:\"text\",name:\"textid\"' ></input><br/>\r\n\t\t<p class=\"spacer_large\">&nbsp;</p>\r\n\t\t<div data-dojo-attach-event=\"onClick:_do_clear\" data-dojo-type=\"dijit.form.Button\" data-dojo-props='label:\"Clear\",\"class\":\"btnleft\"'></div>\r\n\t\t<div data-dojo-attach-event=\"onClick:_do_search\" data-dojo-type=\"dijit.form.Button\" data-dojo-props='label:\"Search\",\"class\":\"btnright\"'></div><br/><br/>\r\n\t</form>\r\n</div>\r\n\r\n",constructor:function(){this._clients=new dojox.data.JsonRestStore({target:"/clients/rest_combo",idAttribute:"id"});this._outlets=new dojox.data.JsonRestStore({target:"/outlets/list_outlets",idAttribute:"outletid"});this._issues=new dojox.data.JsonRestStore({target:"/crm/issues/issues_list_rest",idAttribute:"id"});},postCreate:function(){this.clientid.set("store",this._clients);this.clientid.set("value","-1");this.outletid.set("store",this._outlets);this.issueid.set("store",this._issues);this.issueid.set("value",null);dojo.attr(this.issue_label_1,"innerHTML",PRMAX.utils.settings.issue_description);this.inherited(arguments);},load:function(_1){this._search_func=_1;},clear:function(){this.clientid.set("value","-1");this.issueid.set("value","-1");this.outletid.set("value",null);this.drange.clear();this.textid.set("value","");},_do_clear:function(){this.clear();},_do_search:function(){var _2={drange:this.drange.get("value")};var _3=this.clientid.get("value");if(_3!=null&&_3!=-1&&_3!=""){_2["clientid"]=_3;}_3=this.issueid.get("value");if(_3!=null&&_3!=-1&&_3!=""){_2["issueid"]=_3;}if(this.textid.get("value")!=""){_2["textid"]=this.textid.get("value");}value=this.outletid.get("value");if(_3!=null&&_3!=-1&&_3!=""){_2["outletid"]=_3;}this._search_func(_2);}});}