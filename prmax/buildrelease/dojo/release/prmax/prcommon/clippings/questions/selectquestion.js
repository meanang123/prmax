/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prcommon.clippings.questions.selectquestion"]){dojo._hasResource["prcommon.clippings.questions.selectquestion"]=true;dojo.provide("prcommon.clippings.questions.selectquestion");dojo.require("ttl.BaseWidget");dojo.require("dijit.Menu");dojo.require("dijit.MenuBar");dojo.require("dijit.MenuBarItem");dojo.require("dijit.PopupMenuBarItem");dojo.declare("prcommon.clippings.questions.selectquestion",[ttl.BaseWidget],{widgetsInTemplate:true,templateString:"<div style=\"margin:10px\">\r\n\t<h2>Add Existing Question</h2>\r\n\t<form data-dojo-attach-point=\"form\" data-dojo-props='onsubmit:\"return false\",\"class\":\"common_prmax_layout\"' data-dojo-type=\"dijit.form.Form\">\r\n\t\t<input data-dojo-props='type:\"hidden\",value:-1,name:\"clientid\"' data-dojo-attach-point=\"clientid\" data-dojo-type=\"dijit.form.TextBox\" />\r\n\t\t<input data-dojo-props='type:\"hidden\",value:-1,name:\"issueid\"' data-dojo-attach-point=\"issueid\" data-dojo-type=\"dijit.form.TextBox\" />\r\n\t\t<hr/>\r\n\t\t<label>Select Question</label><select data-dojo-props='\"class\":\"prmaxinput\", name:\"questionid\",autoComplete:true,searchAttr:\"questiontext\",labelType:\"html\",style:\"width:8em\"' data-dojo-type=\"dijit.form.FilteringSelect\" data-dojo-attach-point=\"questionid\"></select><br/>\r\n\t\t<button data-dojo-attach-event=\"onClick:_save\" data-dojo-attach-point=\"savebtn\" data-dojo-type=\"dojox.form.BusyButton\" data-dojo-props='type:\"button\",busyLabel:\"Please Wait Saving ...\",label:\"Save\",\"class\":\"btnright \"'></button>\r\n\t</form>\r\n</div>\r\n\r\n",publish_path:"/clippings/question/analysis",globalonly:false,constructor:function(){this._questions=new dojox.data.JsonRestStore({target:"/clippings/questions/list_by_source",idAttribute:"questionid"});this._save_call_back=dojo.hitch(this,this._save_call);},postCreate:function(){this.questionid.set("store",this._questions);this.inherited(arguments);if(this.globalonly==true){var _1={globalonly:1};this.savebtn.cancel();this.questionid.set("query",_1);this.questionid.set("value",null);}},load:function(_2,_3){this.clientid.set("value",_2);this.issueid.set("value",_3);this._clientid=_2;this._issueid=_3;var _4={};if(_2!=null){_4["iclientid"]=_2;}if(_3!=null){_4["iissueid"]=_3;}this.savebtn.cancel();this.questionid.set("query",_4);this.questionid.set("value",null);},_save:function(){if(ttl.utilities.formValidator(this.form)==false){alert("Not all required field filled in");this.savebtn.cancel();return;}dojo.xhrPost(ttl.utilities.makeParams({load:this._save_call_back,url:"/clippings/analyse/add_question_to_analysis",content:this.form.get("value")}));},_save_call:function(_5){if(_5.success=="OK"){dojo.publish(this.publish_path,[_5.data,this._clientid,this._issueid]);}else{alert("Problem");}this.savebtn.cancel();},clear:function(){if(this.globalonly==true){var _6={globalonly:1};this.savebtn.cancel();this.questionid.set("query",_6);this.questionid.set("value",null);}}});}