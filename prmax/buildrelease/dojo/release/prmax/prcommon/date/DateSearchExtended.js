/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prcommon.date.DateSearchExtended"]){dojo._hasResource["prcommon.date.DateSearchExtended"]=true;dojo.provide("prcommon.date.DateSearchExtended");dojo.require("ttl.BaseWidget");dojo.require("dijit.form.DateTextBox");dojo.require("prcommon.search.std_search");dojo.declare("prcommon.date.DateSearchExtended",[prcommon.search.std_search,ttl.BaseWidget],{widgetsInTemplate:true,noselection:"No Selection",name:"",required:false,templateString:"<div>\r\n\t<table style=\"width:99%;border-style:collapsed\" class=\"prmaxtable\" cellpadding=\"0\" cellspacing=\"0\" >\r\n\t\t<tr><td width=\"20%\" ><span class=\"prmaxrowtag\">${displayname}</span></td>\r\n\t\t\t<td width=\"70%\" >\r\n\t\t\t\t<select class=\"prmaxdate\" style=\"width:7em\" dojoType=\"dijit.form.ComboBox\" autocomplete=\"false\" value=\"No Selection\" dojoAttachPoint=\"option\" dojoAttachEvent=\"onChange:_OptionChanged\">\r\n\t\t\t\t\t\t<option>No Selection</option>\r\n\t\t\t\t\t\t<option>Before</option>\r\n\t\t\t\t\t\t<option>After</option>\r\n\t\t\t\t\t\t<option>Between</option>\r\n\t\t\t\t</select>\r\n\t\t\t\t<input dojoAttachPoint=\"from_date_box\" class=\"prmaxbutton prmaxdate prmaxhidden\" type=\"text\"  dojoType=\"dijit.form.DateTextBox\" dojoAttachEvent=\"onChange:_DateChanged\" style=\"width:6em\">\r\n\t\t\t\t<label dojoAttachPoint=\"to_box_label\" class=\"prmaxhidden\"> and </label><input dojoAttachPoint=\"to_date_box\" class=\"prmaxbutton prmaxdate prmaxhidden\" type=\"text\"  dojoType=\"dijit.form.DateTextBox\" style=\"width:6em\" dojoAttachEvent=\"onChange:_DateChanged\" >\r\n\t\t\t\t<input dojoAttachPoint=\"month_checkbox\" type=\"checkbox\" checked value=\"1\" dojoType=\"dijit.form.CheckBox\" dojoAttachEvent=\"onChange:_DateChanged\" ><label dojoAttachPoint=\"label_box\" checked >Include Months</label>\r\n\t\t\t</td>\r\n\t\t\t<td width=\"10%\" align=\"right\"><div dojoAttachPoint=\"countNode\" dojotype=\"prmax.search.SearchCount\"></div></td>\r\n\t\t</tr>\r\n\t</table>\r\n</div>\r\n",postCreate:function(){this.from_date_box.set("value",new Date());this.to_date_box.set("value",new Date());this.inherited(arguments);},_getData:function(){var _1=this.option.get("value");if(_1!=this.noselection){return dojo.toJson({option:_1,from_date:ttl.utilities.toJsonDate(this.from_date_box.get("value")),to_date:ttl.utilities.toJsonDate(this.to_date_box.get("value")),month:this.month_checkbox.get("value")});}return "";},_defaultSettings:function(){this.option.set("value",this.noselection);this.from_date_box.set("value",new Date());this.to_date_box.set("value",new Date());this.month_checkbox.set("checked",true);},_setValueAttr:function(_2){if(_2==null||_2===""){this._defaultSettings();}else{obj=dojo.fromJson(_2);try{this.option.set("value",obj.option);this.from_date_box.set("value",ttl.utilities.fromJsonDate(obj.from_date));this.to_date_box.set("value",ttl.utilities.fromJsonDate(obj.to_date));this.month_checkbox.set("checked",obj.month);}catch(e){this._defaultSettings();}}this._ShowOptions();this._Get(this._getData());},_getValueAttr:function(){return this._getData();},_OptionChanged:function(){this._ShowOptions();this._Get(this._getData());},_ShowOptions:function(){var _3=false;var _4=false;switch(this.option.get("value")){case this.noselection:break;case "After":_3=true;break;case "Before":_3=true;break;case "Between":_3=true;_4=true;break;}if(_3){dojo.removeClass(this.from_date_box.domNode,"prmaxhidden");}else{dojo.addClass(this.from_date_box.domNode,"prmaxhidden");}if(_4){dojo.removeClass(this.to_date_box.domNode,"prmaxhidden");dojo.removeClass(this.to_box_label,"prmaxhidden");}else{dojo.addClass(this.to_date_box.domNode,"prmaxhidden");dojo.addClass(this.to_box_label,"prmaxhidden");}},_DateChanged:function(){this._Get(this._getData());},Clear:function(){this._setValueAttr(null);}});}