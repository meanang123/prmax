/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prcommon.date.daterange"]){dojo._hasResource["prcommon.date.daterange"]=true;dojo.provide("prcommon.date.daterange");dojo.require("ttl.BaseWidget");dojo.declare("prcommon.date.daterange",[ttl.BaseWidget],{widgetsInTemplate:true,name:"",value:"",no_select:true,templateString:"<div>\r\n\t<div style=\"width:100%\">\r\n\t<select data-dojo-type=\"dijit.form.FilteringSelect\" data-dojo-props='style:\"margin-right:5px;float:left;width:80px\",\"class\":\"pprrowdate\",autocomplete:false' data-dojo-attach-point=\"option\" data-dojo-attach-event=\"onChange:_option_changed\"></select>\r\n\t<input data-dojo-attach-point=\"from_date_box\" data-dojo-props='style:\"margin-right:5px;float:left;width:94px\",\"class\":\"pprhidden pprrowdate\",type:\"text\"' data-dojo-type=\"dijit.form.DateTextBox\" data-dojo-attach-event=\"onChange:_date_changed\">\r\n\t<div data-dojo-attach-point=\"to_box_label\" style=\"float:left;margin-right:7px;margin-top:4px;vertical-align:bottom\" class=\"pprhidden\"> and </div>\r\n\t<input data-dojo-attach-point=\"to_date_box\" data-dojo-props='style:\"float:left;width:94px\",\"class\":\"pprhidden pprrowdate\",type:\"text\"' data-dojo-type=\"dijit.form.DateTextBox\" data-dojo-attach-event=\"onChange:_date_changed\" >\r\n\t</div>\r\n</div>\r\n",default_value:0,constructor:function(){this._options=null;this._start_date=new Date();this._end_date=new Date();},postCreate:function(){this.inherited(arguments);if(this.no_select==true){this._options={identifier:"id",label:"name",items:[{id:0,name:"None"},{id:1,name:"Before"},{id:2,name:"After"},{id:3,name:"Between"}]};this.option.store=new dojo.data.ItemFileReadStore({data:this._options});this.option.set("value",0);}else{this._options={identifier:"id",label:"name",items:[{id:1,name:"Before"},{id:2,name:"After"},{id:3,name:"Between"}]};this.option.store=new dojo.data.ItemFileReadStore({data:this._options});this.option.set("value",1);if(this.default_value==0){this.default_value=1;}}this.from_date_box.set("value",new Date());this.to_date_box.set("value",new Date());this.option.set("value",this.default_value);},_option_changed:function(){switch(this.option.get("value")){default:case "0":dojo.addClass(this.from_date_box.domNode,"prmaxhidden");dojo.addClass(this.to_box_label,"prmaxhidden");dojo.addClass(this.to_date_box.domNode,"prmaxhidden");break;case "1":case "2":dojo.removeClass(this.from_date_box.domNode,"prmaxhidden");dojo.addClass(this.to_box_label,"prmaxhidden");dojo.addClass(this.to_date_box.domNode,"prmaxhidden");break;case "3":dojo.removeClass(this.from_date_box.domNode,"prmaxhidden");dojo.removeClass(this.to_box_label,"prmaxhidden");dojo.removeClass(this.to_date_box.domNode,"prmaxhidden");break;}},_date_changed:function(){if(this.option.get("value")=="3"){}},isValid:function(){return true;},_getValueAttr:function(){try{var _1=parseInt(this.option.get("value"));var _2=0;for(var _3 in this._options.items){if(this._options.items[_3].id[0]==_1){_2=this._options.items[_3].name[0];break;}}return dojo.toJson({option:_2,from_date:ttl.utilities.toJsonDate(this.from_date_box.get("value")),to_date:ttl.utilities.toJsonDate(this.to_date_box.get("value"))});}catch(e){return "";}},_setValueAttr:function(_4){if(_4==null){this.clear();}},clear:function(){this.option.set("value",this.default_value);this.from_date_box.set("value",this._start_date);this.to_date_box.set("value",this._end_date);},set_range_to_week:function(){this._end_date=new Date();this._start_date.setDate(this._end_date.getDate()-6);this.from_date_box.set("value",this._start_date);this.to_date_box.set("value",this._end_date);}});}