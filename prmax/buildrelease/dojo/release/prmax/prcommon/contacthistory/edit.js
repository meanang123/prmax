/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prcommon.contacthistory.edit"]){dojo._hasResource["prcommon.contacthistory.edit"]=true;dojo.provide("prcommon.contacthistory.edit");dojo.require("ttl.BaseWidget");dojo.declare("prcommon.contacthistory.edit",[ttl.BaseWidget],{widgetsInTemplate:true,displaytitle:"Keywords",templateString:"<div>\r\n\t<div data-dojo-attach-point=\"dialog_ctrl\" data-dojo-type=\"dijit.Dialog\" data-dojo-props='title:\"Private Notes\",style:\"width:500px;height:400px\"'>\r\n\t\t<div style=\"width:99%;height:320px\">\r\n\t\t\t<textarea data-dojo-attach-point=\"profile\" data-dojo-type=\"dijit.form.Textarea\" data-dojo-props='name:\"profile\",style:\"width:99%;height:99%\"'></textarea>\r\n\t\t</div>\r\n\t\t<button type=\"button\" data-dojo-type=\"dijit.form.Button\" data-dojo-props='label:\"Close\"' data-dojo-attach-event=\"onClick:_Close\"></button>\r\n\t\t<button class=\"prmaxbuttongreybutton\" data-dojo-attach-event=\"onClick:_Update\" data-dojo-attach-point=\"savenode\" data-dojo-type=\"dojox.form.BusyButton\" data-dojo-props='style:\"float:right\",type:\"button\",busyLabel:\"Please Wait Saving...\",label:\"Save\"'></button>\r\n\t</div>\r\n</div>\r\n",constructor:function(){dojo.subscribe("/crm/edit_notes",dojo.hitch(this,this._show_event));this._show_notes_call_back=dojo.hitch(this,this._show_notes_call);this._update_notes_call_back=dojo.hitch(this,this._update_notes_call);},_show_notes_call:function(_1){if(_1.success=="OK"){this.profile.set("value",_1.data);this.savenode.cancel();this.dialog_ctrl.show();}else{alert("Problem Loading Private notes");}},_update_notes_call:function(_2){if(_2.success=="OK"){alert("Private Notes Updated");dojo.publish(PRCOMMON.Events.Update_Notes,[this._outletid,this._employeeid]);this.dialog_ctrl.hide();}else{alert("Problem Updating Private notes");}this.savenode.cancel();},_show_event:function(_3,_4){this._outletid=_3;this._employeeid=_4;dojo.xhrPost(ttl.utilities.makeParams({load:this._show_notes_call_back,url:"/crm/get_private_notes",content:{outletid:_3,employeeid:_4}}));this.dialog_ctrl.show();},_Update:function(){dojo.xhrPost(ttl.utilities.makeParams({load:this._update_notes_call_back,url:"/crm/update_private_notes",content:{outletid:this._outletid,employeeid:this._employeeid,profile:this.profile.get("value")}}));},_Close:function(){this.dialog_ctrl.hide();}});}