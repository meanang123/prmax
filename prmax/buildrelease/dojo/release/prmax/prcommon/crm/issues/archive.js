/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prcommon.crm.issues.archive"]){dojo._hasResource["prcommon.crm.issues.archive"]=true;dojo.provide("prcommon.crm.issues.archive");dojo.declare("prcommon.crm.issues.archive",[ttl.BaseWidget],{mode:"archive",widgetsInTemplate:true,templateString:"<div style=\"width:300px\">\r\n\t<span class=\"common_prmax_layout\">\r\n\t\t<form class=\"prmaxdefault\" data-dojo-attach-point=\"formnode\" data-dojo-type=\"dijit.form.Form\" onSubmit=\"return false\">\r\n\t\t\t<input data-dojo-props='name:\"issueid\",type:\"hidden\",value:\"-1\"' data-dojo-attach-point=\"issueid\" data-dojo-type=\"dijit.form.TextBox\"/><br/>\r\n\t\t\t<label>Issue Name</label><p data-dojo-attach-point=\"issuename\"></p><br/><br/>\r\n\t\t\t<button data-dojo-attach-event=\"onClick:_close\" data-dojo-attach-point=\"closebtn\" data-dojo-type=\"dijit.form.Button\" data-dojo-props='type:\"button\",label:\"Close\",\"class\":\"btnleft\"'></button>\r\n\t\t\t<button data-dojo-attach-event=\"onClick:_save\" data-dojo-attach-point=\"savebtn\" data-dojo-type=\"dojox.form.BusyButton\" data-dojo-props='type:\"button\",busyLabel:\"Please Wait Archiving...\",label:\"Change Issue Status\",\"class\":\"btnright \"'></button><br/><br/>\r\n\t\t</form>\r\n\t</span>\r\n</div>\r\n",constructor:function(){this._save_call_back=dojo.hitch(this,this._save_call);this._add_issue_call_back=dojo.hitch(this,this._add_issue_call);},postCreate:function(){this.inherited(arguments);this._dialog=null;},_save:function(){if(ttl.utilities.formValidator(this.formnode)==false){alert("Not all required field filled in");this.savebtn.cancel();return;}var _1="/crm/issues/archive";if(this.mode=="unarchive"){_1="/crm/issues/unarchive";}dojo.xhrPost(ttl.utilities.makeParams({load:this._save_call_back,url:_1,content:this.formnode.get("value")}));},_setDialogAttr:function(_2){this._dialog=_2;},_save_call:function(_3){if(_3.success=="OK"){dojo.publish(PRCOMMON.Events.Issue_Update,[_3.data]);this._close();}else{alert("Problem Changing Issue Status");this.savebtn.cancel();}},_clear:function(){this.savebtn.cancel();},_close:function(){if(this._dialog!=null){this._dialog.hide();}this._clear();},clear:function(){this._clear();},load:function(_4,_5){this._clear();this.mode=_5;this.issueid.set("value",_4.issueid);dojo.attr(this.issuename,"innerHTML",_4.name);}});}