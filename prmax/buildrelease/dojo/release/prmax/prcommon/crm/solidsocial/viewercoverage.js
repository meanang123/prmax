/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prcommon.crm.solidsocial.viewercoverage"]){dojo._hasResource["prcommon.crm.solidsocial.viewercoverage"]=true;dojo.provide("prcommon.crm.solidsocial.viewercoverage");dojo.require("dijit.layout.BorderContainer");dojo.require("prcommon.crm.solidsocial.addsearchprofile");dojo.declare("prcommon.crm.solidsocial.viewercoverage",[ttl.BaseWidget],{widgetsInTemplate:true,issue_view:"/crm/issues/coverage_view?issueid=${issueid}",templateString:"<div>\r\n\t<div data-dojo-attach-point=\"frame\" data-dojo-type=\"dijit.layout.BorderContainer\" data-dojo-props='gutters:false,style:\"width:100%;height:100%\"' >\r\n\t\t<div data-dojo-type=\"dijit.layout.StackContainer\" data-dojo-attach-point=\"controls\" data-dojo-props='region:\"center\"'>\r\n\t\t\t<div data-dojo-attach-point=\"addsearchprofile\" data-dojo-type=\"prcommon.crm.solidsocial.addsearchprofile\" data-dojo-props='style:\"width:100%;height:100%\",selected:\"selected\"'></div>\r\n\t\t\t<div data-dojo-attach-point=\"issue_view_ctrl\" data-dojo-type=\"dijit.layout.ContentPane\" data-dojo-props='style:\"width:100%;height:100%\"'></div>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n",constructor:function(){this._load_call_back=dojo.hitch(this,this._load_call);dojo.subscribe("/crm/issue/profile_new",dojo.hitch(this,this._profile_new_event));},postCreate:function(){this.inherited(arguments);},load:function(_1){this._issueid=_1;this.addsearchprofile.load(_1);dojo.xhrPost(ttl.utilities.makeParams({load:this._load_call_back,url:"/crm/issues/has_coverage",content:{issueid:_1}}));},_load_call:function(_2){if(_2.success=="OK"){if(_2.has_coverage){this._show_coverage();}else{}}else{}},resize:function(){this.frame.resize(arguments[0]);},_profile_new_event:function(_3){if(this._issueid==_3){this._show_coverage();}},_show_coverage:function(){this.issue_view_ctrl.set("href",dojo.string.substitute(this.issue_view,{issueid:this._issueid}));this.controls.selectChild(this.issue_view_ctrl);}});}