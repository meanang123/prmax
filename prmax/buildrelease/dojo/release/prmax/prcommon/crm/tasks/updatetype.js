/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prcommon.crm.tasks.updatetype"]){dojo._hasResource["prcommon.crm.tasks.updatetype"]=true;dojo.provide("prcommon.crm.tasks.updatetype");dojo.declare("prcommon.crm.tasks.updatetype",[ttl.BaseWidget],{widgetsInTemplate:true,templateString:"<div>\r\n\t<form data-dojo-attach-point=\"form\"  data-dojo-props='onsubmit:\"return false\"' data-dojo-type=\"dijit.form.Form\">\r\n\t\t<table width=\"99%\" class=\"prmaxtable\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" style=\"padding-top:5px\">\r\n\t\t\t<tr>\r\n\t\t\t\t<td align=\"right\" valign=\"top\" class=\"prmaxrowtag\">Description</td>\r\n\t\t\t\t<td><input data-dojo-props='tasktypedescription:\"text\",required:true,name:\"tasktypedescription\",style:\"width:20em\"' data-dojo-type=\"dijit.form.ValidationTextBox\" data-dojo-attach-point=\"tasktypedescription\" ></td>\r\n\t\t\t</tr>\r\n\t\t\t<tr>\r\n\t\t\t\t<td align=\"right\" valign=\"top\" class=\"prmaxrowtag\">Status</td>\r\n\t\t\t\t<td><select data-dojo-props='name:\"tasktypestatusid\",autoComplete:true,labelType:\"html\"' data-dojo-type=\"dijit.form.FilteringSelect\" data-dojo-attach-point=\"tasktypestatusid\" ></select></td>\r\n\t\t\t</tr>\r\n\t\t\t<tr>\r\n\t\t\t\t<td><button data-dojo-type=\"dijit.form.Button\" data-dojo-attach-point=\"clsbtn\" data-dojo-attach-event=\"onClick:_close\" data-dojo-props='label:\"Close\"'></button></td>\r\n\t\t\t\t<td align=\"right\"><button data-dojo-type=\"dojox.form.BusyButton\" data-dojo-attach-point=\"updbtn\" data-dojo-props='busyLabel:\"Updating ...\",label:\"Update\"' data-dojo-attach-event=\"onClick:_update_tasktype\"></button></td>\r\n\t\t\t</tr>\r\n\t\t</table>\r\n\t</form>\r\n</div>\r\n",constructor:function(){this._load_call_back=dojo.hitch(this,this._load_call);this._upd_call_back=dojo.hitch(this,this._upd_call);this._tasktypestatus=new dojo.data.ItemFileReadStore({url:"/common/lookups?searchtype=tasktypestatus"});},postCreate:function(){this.tasktypestatusid.store=this._tasktypestatus;this.inherited(arguments);},_load_call:function(_1){if(_1.success=="OK"){this.tasktypestatusid.set("value",_1.data.tasktypestatusid);this.tasktypedescription.set("value",_1.data.tasktypedescription);}else{alert("Problem Loading Task Type");}},load:function(_2,_3){this._tasktypeid=_3;this._dialog=_2;this._clear();dojo.xhrPost(ttl.utilities.makeParams({load:this._load_call_back,url:"/crm/tasks/get_tasktype",content:{tasktypeid:this._tasktypeid}}));},_clear:function(){this.updbtn.cancel();this.tasktypedescription.set("value","");this.tasktypestatusid.set("value",1);},_close:function(){if(this._dialog!=null){this._dialog.hide();}},_update_tasktype:function(){if(ttl.utilities.formValidator(this.form)==false){alert("Please Enter Details");this.updbtn.cancel();return false;}var _4=this.form.get("value");_4["tasktypeid"]=this._tasktypeid;dojo.xhrPost(ttl.utilities.makeParams({load:dojo.hitch(this,this._upd_call_back),url:"/crm/tasks/tasktype_update",content:_4}));},_upd_call:function(_5){if(_5.success=="OK"){alert("Task Type Updated");this._close();this._clear();dojo.publish("tasktype/update",[_5.data]);}else{alert("Problem Updating Task");}this.updbtn.cancel();}});}