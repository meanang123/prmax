/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prmax.pressrelease.distributiontemplate.viewer"]){dojo._hasResource["prmax.pressrelease.distributiontemplate.viewer"]=true;dojo.provide("prmax.pressrelease.distributiontemplate.viewer");dojo.require("prmax.pressrelease.distributiontemplate.template_add");dojo.require("prmax.pressrelease.distributiontemplate.template_update");dojo.declare("prmax.pressrelease.distributiontemplate.viewer",[ttl.BaseWidget],{widgetsInTemplate:true,templateString:"<div>\r\n\t<div data-dojo-attach-point=\"frame\" data-dojo-type=\"dijit.layout.BorderContainer\" data-dojo-point='style:\"width:100%;height:100%\",gutters:false' >\r\n\t\t<span class=\"std_menu_view\">\r\n\t\t\t<div data-dojo-type=\"dijit.Toolbar\" data-dojo-props='region:\"top\",style:\"height:46px;width:100%;overflow:hidden\",\"class\":\"std_menu_view\"'>\r\n\t\t\t\t<div style=\"height:100%;width:220px;float:left;padding-top:10px;font-weight:bold\" class=\"prmaxrowdisplaylarge\">Distribtion Templates</div>\r\n\t\t\t\t<button data-dojo-attach-event=\"onClick:_add_template_footer\" data-dojo-type=\"dijit.form.Button\" data-dojo-props='iconClass:\"fa fa-plus fa-4x\",label:\"Add Footer\",showLabel:true'></button>\r\n\t\t\t\t<button data-dojo-attach-event=\"onClick:_add_template_header\" data-dojo-type=\"dijit.form.Button\" data-dojo-props='iconClass:\"fa fa-plus fa-4x\",label:\"Add Header\",showLabel:true'></button>\r\n\t\t\t</div>\r\n\t\t</span>\r\n\t\t<div data-dojo-type=\"dijit.layout.ContentPane\"  data-dojo-props='region:\"center\",splitter:true'>\r\n\t\t\t<div data-dojo-attach-point=\"viewer_grid\" data-dojo-type=\"dojox.grid.DataGrid\" data-dojo-props='query:{ },rowsPerPage:30,style:\"width:100%;height:100%\"' ></div>\r\n\t\t</div>\r\n\t\t<div data-dojo-attach-point=\"clipping_view_ctrl\" data-dojo-type=\"dijit.layout.StackContainer\" data-dojo-props='region:\"right\",splitter:true,style:\"width:50%;height:100%\"'>\r\n\t\t\t<div data-dojo-type=\"dijit.layout.ContentPane\" data-dojo-attach-point=\"blank_view\" data-dojo-props='style:\"width:100%;height:100%\"'></div>\r\n\t\t\t<div data-dojo-type=\"prmax.pressrelease.distributiontemplate.template_update\" data-dojo-attach-point=\"update_template_ctrl\" data-dojo-props='style:\"width:100%;height:100%\",\"class\":\"scrollpanel\"'></div>\r\n\t\t</div>\r\n\t</div>\r\n\t<div data-dojo-attach-point=\"add_template_dlg\" data-dojo-type=\"dijit.Dialog\" data-dojo-props='title:\"Add Template\",style:\"width:600px;height:600px\"'>\r\n\t\t<div data-dojo-attach-point=\"add_template_ctrl\" data-dojo-type=\"prmax.pressrelease.distributiontemplate.template_add\"></div>\r\n\t</div>\r\n</div>\r\n",constructor:function(){this._templates_store=new dojox.data.JsonRestStore({target:"/emails/distributiontemplates/templates_list",idAttribute:"distributiontemplateid"});this._show_update_call_back=dojo.hitch(this,this._show_update_call);this._show_add_call_back=dojo.hitch(this,this._show_add_call);},view:{cells:[[{name:"Description",width:"auto",field:"description"},{name:"Type",width:"auto",field:"distributiontemplatesdescription"}]]},postCreate:function(){this.viewer_grid.set("structure",this.view);this.viewer_grid._setStore(this._templates_store);this.viewer_grid.onRowClick=dojo.hitch(this,this._on_select_row);this.inherited(arguments);},_on_select_row:function(e){var _1=this.viewer_grid.getItem(e.rowIndex);if(_1){this._row=_1;this.update_template_ctrl.load(_1.distributiontemplateid,this._show_update_call_back);this.viewer_grid.selection.clickSelectEvent(e);}},_show_update_call:function(_2){switch(_2){case "show":this.clipping_view_ctrl.selectChild(this.update_template_ctrl);break;case "hide":this.clipping_view_ctrl.selectChild(this.blank_view);this.update_template_ctrl.clear();break;case "delete":this.clipping_view_ctrl.selectChild(this.blank_view);this.update_template_ctrl.clear();this._templates_store.deleteItem(this._row);break;}},_show_add_call:function(_3,_4){switch(_3){case "show":this.clipping_view_ctrl.selectChild(this.blank_view);this.update_template_ctrl.clear();this.add_template_ctrl.clear();this.add_template_dlg.show();break;case "hide":this.add_template_dlg.hide();this.add_template_ctrl.clear();if(_4){this._templates_store.newItem(_4);}break;}},resize:function(){this.frame.resize(arguments[0]);},_add_template_footer:function(){this.add_template_dlg.set("title","Add Footer");this.add_template_ctrl.load(this._show_add_call_back,2);this._show_add_call("show");},_add_template_header:function(){this.add_template_dlg.set("title","Add Header");this.add_template_ctrl.load(this._show_add_call_back,1);this._show_add_call("show");}});}