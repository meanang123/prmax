/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prmax.pressrelease.Duplicate"]){dojo._hasResource["prmax.pressrelease.Duplicate"]=true;dojo.provide("prmax.pressrelease.Duplicate");dojo.declare("prmax.pressrelease.Duplicate",[ttl.BaseWidget],{widgetsInTemplate:true,templateString:"<div>\r\n\t<form class=\"prmaxdefault\" data-dojo-attach-point=\"form\" data-dojo-type=\"dijit.form.Form\" onsubmit=\"return false\">\r\n\t\t<input data-dojo-props='name:\"emailtemplateid\",type:\"hidden\"' data-dojo-attach-point=\"emailtemplateid\" value=\"\" data-dojo-type=\"dijit.form.TextBox\"/>\r\n\t\t<table class=\"prmaxtable\" cellpadding=\"0\" cellspacing =\"0\">\r\n\t\t\t<tr><td colspan=\"2\">&nbsp;</td></tr>\r\n\t\t\t<tr>\r\n\t\t\t\t<td class=\"prmaxlabeltag\" data-dojo-attach-point=\"distr_label\">New Distribution Name</label></td>\r\n\t\t\t\t<td><input data-dojo-type=\"dijit.form.ValidationTextBox\" name=\"emailtemplatename\" data-dojo-attach-point=\"emailtemplatename\" required=\"true\" trim=\"true\" maxlength=\"45\" promptMessage=\"Enter Distribution name\" type=\"text\" ></td>\r\n\t\t\t</tr>\r\n\t\t\t<tr><td colspan=\"2\">&nbsp;</td></tr>\r\n\t\t\t<tr>\r\n\t\t\t\t<td align=\"left\"><button class=\"prmaxbutton\" data-dojo-type=\"dijit.form.Button\" data-dojo-attach-event=\"onClick:_Cancel\" type=\"button\" >Cancel</button></td>\r\n\t\t\t\t<td align=\"right\"><button data-dojo-attach-event=\"onClick:_Save\" data-dojo-attach-point=\"saveNode\" data-dojo-type=\"dojox.form.BusyButton\" data-dojo-props='style:\"float:right\",type:\"button\",label:\"Create\"'></button></td>\r\n\t\t\t</tr>\r\n\t\t</table>\r\n\t</form>\r\n</div>\r\n",constructor:function(){this._dlg=null;this._SavedCall=dojo.hitch(this,this._Saved);},postCreate:function(){dojo.subscribe("/update/distribution_label",dojo.hitch(this,this._UpdateDistributionLabelEvent));dojo.attr(this.distr_label,"innerHTML","New "+PRMAX.utils.settings.distribution_description+" Name");this.inherited(arguments);},_UpdateDistributionLabelEvent:function(){dojo.attr(this.distr_label,"innerHTML","New "+PRMAX.utils.settings.distribution_description+" Name");},Load:function(_1,_2){this._dlg=_1;this._Clear();this.emailtemplateid.set("value",_2);},_Cancel:function(){this.hide();},_Save:function(){if(ttl.utilities.formValidator(this.form)==false){alert("Not all required field filled in");this.saveNode.cancel();return;}var _3={};_3["emailtemplateid"]=this.emailtemplateid.get("value");_3["emailtemplatename"]=this.emailtemplatename.get("value");dojo.xhrPost(ttl.utilities.makeParams({load:this._SavedCall,url:"/emails/template_duplicate",content:_3}));},_Saved:function(_4){if(_4.success=="OK"){dojo.publish(PRCOMMON.Events.PressReleaseStart,[_4.data]);this.hide();}else{if(_4.success=="DU"){alert("Distribution Name Already Exists");this.emailtemplatename.focus();}else{if(_4.success=="VF"){alert("Distribution: "+_4.error_message[0][1]);this.emailtemplatename.focus();}else{alert("Problem with Distribution");this.emailtemplatename.focus();}}}this.saveNode.cancel();},_Clear:function(){this.emailtemplatename.set("value",null);this.saveNode.cancel();this.emailtemplateid.set("value",null);},hide:function(){if(this._dlg){this._dlg.hide();}this._Clear();}});}