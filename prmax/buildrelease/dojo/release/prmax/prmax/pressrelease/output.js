/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prmax.pressrelease.output"]){dojo._hasResource["prmax.pressrelease.output"]=true;dojo.provide("prmax.pressrelease.output");dojo.require("prmax.common.ReportBuilder");dojo.require("prcommon.date.daterange");dojo.declare("prmax.pressrelease.output",[ttl.BaseWidget],{widgetsInTemplate:true,templateString:"<div>\r\n<span class=\"common_prmax_layout\"><br/>\r\n\t<form data-dojo-attach-point=\"form_output\" data-dojo-type=\"dijit.form.Form\" data-dojo-props='onSubmit:\"return false\"'>\r\n\t\t<input data-dojo-attach-point=\"reporttemplateid\" data-dojo-props='name:\"reporttemplateid\",type:\"hidden\",value:37'  data-dojo-type=\"dijit.form.TextBox\"/>\r\n\t\t<div style=\"margin:5px\">\r\n\t\t\t<label class=\"label_1\">Output Format</label>\r\n\t\t\t<label data-dojo-attach-point=\"pdf_label\">Pdf&nbsp;<input data-dojo-attach-point=\"pdf\" data-dojo-props=\"name:'reportoutputtypeid',value:'0',type:'radio',checked:true\" data-dojo-type=\"dijit.form.RadioButton\"></label>\r\n\t\t\t<label data-dojo-attach-point=\"excel_label\">Excel&nbsp;<input data-dojo-attach-point=\"excel\" data-dojo-props=\"name:'reportoutputtypeid',value:'4',type:'radio'\" data-dojo-type=\"dijit.form.RadioButton\"></label><br/><br/>\r\n\t\t</div>\t\r\n\t\t<div style=\"margin:5px\">\r\n\t\t\t<label class=\"label_1\" data-dojo-attach-point=\"sent_label\">Sent</label>\r\n\t\t\t<select data-dojo-type=\"dijit.form.ComboBox\" data-dojo-props='style:\"width:8em;color:black\",value:\"Display Sent\",autocomplete:false' data-dojo-attach-point=\"option\" data-dojo-attach-event=\"onChange:_OptionChanged\">\r\n\t\t\t\t<option>Display All</option>\r\n\t\t\t\t<option>Display Draft</option>\r\n\t\t\t\t<option>Display Sent</option>\r\n\t\t\t</select><br />\r\n\t\t</div>\r\n\t\t<div style=\"margin:5px\"><label class=\"label_1\" data-dojo-attach-point=\"drange_label\">Date Range</label><div data-dojo-type=\"prcommon.date.daterange\" data-dojo-attach-point=\"drange\" data-dojo-props='value:\"\",name:\"drange\"'></div><br/></div>\r\n\t\t<div style=\"margin:5px\"><label class=\"label_1\" data-dojo-attach-point=\"client_label\">Client</label><select data-dojo-props='name:\"clientid\",autoComplete:true,searchAttr:\"clientname\",labelType:\"html\",required:false' data-dojo-type=\"dijit.form.FilteringSelect\" data-dojo-attach-point=\"clientid\"></select><br/></br></div>\t\r\n\t\t\r\n\t\t<div data-dojo-type=\"prmax.common.ReportBuilder\" data-dojo-attach-point=\"reportnode\" data-dojo-props='style:\"display:none\"'></div>\r\n\t\t<div style=\"margin:5px\">\r\n\t\t\t<button data-dojo-attach-event=\"onClick:_close\" data-dojo-attach-point=\"closebtn\" data-dojo-type=\"dijit.form.Button\" data-dojo-props='type:\"button\",label:\"Close\",\"class\":\"btnleft prmaxhidden\"'></button>\r\n\t\t\t<button data-dojo-attach-event=\"onClick:_do_report\" data-dojo-attach-point=\"reportbtn\" data-dojo-type=\"dijit.form.Button\" data-dojo-props='type:\"button\",label:\"Generate\",\"class\":\"btnright\"'></button><br/><br/>\r\n\t\t</div>\r\n\t</form>\r\n</span>\r\n</div>\r\n",constructor:function(){this._dialog=null;this._complete_call_back=dojo.hitch(this,this._complete_call);this._clients=new dojox.data.JsonRestStore({target:"/clients/rest_combo",idAttribute:"id"});},postCreate:function(){this.inherited(arguments);this.clientid.set("store",this._clients);this.clientid.set("value",-1);},_do_report:function(){var _1=this.form_output.get("value");_1["option"]=this.option.get("value");dojo.addClass(this.reportbtn.domNode,"prmaxhidden");this.reportnode.SetCompleted(this._complete_call_back);this.reportnode.StartNoDialog(_1);},clear:function(){this.reportnode.hide();this.pdf.set("checked",true);this.excel.set("checked",false);this.option.set("value","Display Sent");this.clientid.set("value",-1);this.drange.set("value",null);dojo.removeClass(this.reportbtn.domNode,"prmaxhidden");},_setDialogAttr:function(_2){this._dialog=_2;if(this._dialog!=null){dojo.removeClass(this.closebtn.domNode,"prmaxhidden");}},_close:function(){if(this._dialog){this._dialog.hide();this.clear();}},_complete_call:function(){this.reportnode.hide();this._close();this.clear();},_OptionChanged:function(){if(this.option.get("value")=="Display Sent"){dojo.removeClass(this.drange_label,"prmaxhidden");dojo.removeClass(this.drange.domNode,"prmaxhidden");}else{dojo.addClass(this.drange_label,"prmaxhidden");dojo.addClass(this.drange.domNode,"prmaxhidden");this.drange.option.set("value",null);}},});}