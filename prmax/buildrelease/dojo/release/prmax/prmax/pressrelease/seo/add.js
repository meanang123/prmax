/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prmax.pressrelease.seo.add"]){dojo._hasResource["prmax.pressrelease.seo.add"]=true;dojo.provide("prmax.pressrelease.seo.add");dojo.require("prmax.pressrelease.seo.edit");dojo.require("prmax.email.loadworddocument");dojo.declare("prmax.pressrelease.seo.add",[ttl.BaseWidget],{widgetsInTemplate:true,templateString:"<div>\r\n\t<div data-dojo-attach-point=\"borderControl\" data-dojo-type=\"dijit.layout.BorderContainer\" data-dojo-props='style:\"width:100%;height:100%\",gutters:false'>\r\n\t\t<div data-dojo-type=\"dijit.layout.ContentPane\" data-dojo-attach-point=\"controls\" data-dojo-props='region:\"top\",style:\"height:42px;width:100%;overflow:hidden\",\"class\":\"std_menu_view\"'>\r\n\t\t\t<div data-dojo-type=\"dijit.Toolbar\" data-dojo-props='style:\"height:99%;width:100%;padding:0px;margin:0px\",\"class\":\"std_menu_view\"'>\r\n\t\t\t\t<div data-dojo-attach-event=\"onClick:_Publish\" data-dojo-type=\"dijit.form.Button\" data-dojo-props='iconClass:\"fa fa-outdent fa-3x\",label:\"Save and Publish SEO\",showLabel:false'></div>\r\n\t\t\t\t<div data-dojo-attach-event=\"onClick:_Save\" data-dojo-type=\"dijit.form.Button\" data-dojo-props='iconClass:\"fa fa-floppy-o fa-3x\",label:\"Save SEO\",showLabel:false'></div>\r\n\t\t\t\t<div data-dojo-attach-event=\"onClick:_LoadWord\" data-dojo-type=\"dijit.form.Button\" data-dojo-props='iconClass:\"fa fa-file-word-o fa-3x\",label:\"Load Word Document\",showLabel:false,sourcename:\"seo_add\"'></div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div data-dojo-type=\"dijit.layout.ContentPane\" data-dojo-props='region:\"center\"'>\r\n\t\t\t<div data-dojo-type=\"prmax.pressrelease.seo.edit\" data-dojo-attach-point=\"editctrl\" data-dojo-props='style:\"width:100%;height:100%\"'></div>\r\n\t\t</div>\r\n\t</div>\r\n\t<div data-dojo-type=\"dijit.Dialog\" data-dojo-props='title:\"Load Word Document\"' data-dojo-attach-point=\"dlg_load_word\">\r\n\t\t<div data-dojo-attach-point=\"word_ctrl\" data-dojo-type=\"prmax.email.loadworddocument\" data-dojo-props='sourcename:\"seo_add\"' ></div>\r\n\t\t<div data-dojo-attach-event=\"onClick:_Close\" data-dojo-type=\"dijit.form.Button\" data-dojo-props='label:\"Close\",style:\"float:left;padding-right:20px\"'></div>\r\n\t</div>\r\n</div>\r\n",constructor:function(){this._PublishCallBack=dojo.hitch(this,this._PublishCall);this._SaveCallBack=dojo.hitch(this,this._SaveCall);this._parent_call_back=null;dojo.subscribe(PRCOMMON.Events.Word_Html_Data,dojo.hitch(this,this._word_html_data_event));},_Load_Word_Doc:function(_1){this.editctrl.seocontent.set("value",_1);this.dlg_load_word.hide();},postCreate:function(){this.word_ctrl.Load(dojo.hitch(this,this._Load_Word_Doc));this.inherited(arguments);},resize:function(){this.borderControl.resize(arguments[0]);},_PublishCall:function(_2){if(_2.success=="OK"){alert("SEO Release Published");if(this._parent_call_back){this._parent_call_back(_2.data);}this.editctrl.Clear();}else{alert("Problem Publishing SEO");}},Load:function(_3){this._parent_call_back=_3;},Clear:function(){this.editctrl.Clear();},_Publish:function(){if(this.editctrl.isValid()==false){return;}if(confirm("Publish SEO Release")==true){dojo.xhrPost(ttl.utilities.makeParams({load:this._PublishCallBack,url:"/emails/seorelease/save_and_publish",content:this.editctrl.seoform({})}));}},_LoadWord:function(){this.word_ctrl.Clear();this.dlg_load_word.show();},_Close:function(){this.word_ctrl.Clear();this.dlg_load_word.hide();},_SaveCall:function(_4){if(_4.success=="OK"){this.editctrl.set("seoreleaseid",_4.data.seoreleaseid);if(this._parent_call_back){this._parent_call_back(_4.data);}alert("SEO Saved");}else{alert("Problem Saving SEO");}},_Save:function(){if(this.editctrl.isValid()==false){return;}dojo.xhrPost(ttl.utilities.makeParams({load:this._SaveCallBack,url:"/emails/seorelease/save",content:this.editctrl.seoform({})}));},_word_html_data_event:function(_5){if(_5.sourcename=="seo_add"){this.editctrl.seocontent.set("value",_5.html);}}});}