/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prmax.freelance.FreelanceEdit"]){dojo._hasResource["prmax.freelance.FreelanceEdit"]=true;dojo.provide("prmax.freelance.FreelanceEdit");dojo.require("dijit._Templated");dojo.require("dijit._Widget");dojo.require("dijit._Container");dojo.require("prcommon.interests.Interests");dojo.require("ttl.utilities");dojo.declare("prmax.freelance.FreelanceEdit",[dijit._Widget,dijit._Templated,dijit._Container],{widgetsInTemplate:true,mode:0,templateString:"<div >\r\n\t<div dojoAttachPoint=\"borderControl\" dojotype=\"dijit.layout.BorderContainer\" style=\"width:100%;height:100%\" >\r\n\t\t<div dojotype=\"dijit.layout.ContentPane\"  region=\"top\"  style=\"width:100%;height:3em\">\r\n\t\t\t<div class=\"prmaxHeadingLocation prmaxHeadingStyle\" dojoAttachPoint=\"headingNode\" ></div>\r\n\t\t</div>\r\n\t\t<div dojotype=\"dijit.layout.ContentPane\"   style=\"width:100%padding-left:5px\" region=\"center\"  >\r\n\t\t\t<form  class=\"prmaxdefault\" dojoAttachPoint=\"requiredNode\" dojoType=\"dijit.form.Form\">\r\n\t\t\t\t<input type=\"hidden\" dojoAttachPoint=\"outletNode\" dojotype=\"dijit.form.TextBox\" name=\"outletid\"  value=\"-1\"/>\r\n\t\t\t\t<table style=\"width:100%\" class=\"prmaxtable\">\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\" align=\"right\">Name</td><td>\r\n\t\t\t\t\t\t<input dojoAttachPoint=\"title\" name=\"title\" type=\"text\" trim=\"true\" dojoType=\"dijit.form.TextBox\" style=\"width: 2em;\" ></input>\r\n\t\t\t\t\t\t<input dojoAttachPoint=\"firstname\" name=\"firstname\" type=\"text\" trim=\"true\" dojoType=\"dijit.form.TextBox\" style=\"width: 7em;\" ></input>\r\n\t\t\t\t\t\t<input dojoAttachPoint=\"familyname\" class=\"prmaxrequired\" name=\"familyname\" type=\"text\" trim=\"true\" required=\"true\" invalidMessage=\"Please enter Surname\" dojoType=\"dijit.form.ValidationTextBox\" style=\"width: 12em;\"></input>\r\n\t\t\t\t\t</td></tr>\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\" align=\"right\" >Country</td><td><select style=\"width:200px\" class=\"prmaxrequired\" name=\"countryid\" autoComplete=\"true\" searchAttr=\"name\" dojoType=\"dijit.form.FilteringSelect\" required=\"true\" invalidMessage=\"Please select Country Name\" labelType=\"html\" dojoAttachPoint=\"countryid\"></select></td></tr>\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\" align=\"right\">Address:</td><td><input dojoAttachPoint=\"address1\" name=\"address1\" type=\"text\" size=\"40\" required=\"true\" dojoType=\"dijit.form.TextBox\"/></td></tr>\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\" align=\"right\">Address 2:</td><td><input dojoAttachPoint=\"address2\" name=\"address2\" type=\"text\" size=\"40\" maxlength=\"80\" dojoType=\"dijit.form.TextBox\"/></td></tr>\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\" align=\"right\">Town</td><td><input dojoAttachPoint=\"townname\" name=\"townname\" type=\"text\" size=\"30\" dojoType=\"dijit.form.TextBox\"/></td></tr>\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\" align=\"right\">County</td><td><input dojoAttachPoint=\"county\" name=\"county\" type=\"text\" dojoType=\"dijit.form.TextBox\"/></td></tr>\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\" align=\"right\">Postcode:</td><td><input dojoAttachPoint=\"postcode\" name=\"postcode\" type=\"text\" size=\"20\" maxlength=\"10\" dojoType=\"dijit.form.TextBox\"/></td></tr>\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\" align=\"right\">Www:</td><td><input dojoAttachPoint=\"www\" name=\"www\" type=\"text\" size=\"40\" maxlength=\"120\" trim=\"true\" dojoType=\"dijit.form.TextBox\" /></td></tr>\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\" align=\"right\">Email:</td><td><input dojoAttachPoint=\"email\" name=\"email\" type=\"text\" size=\"40\" maxlength=\"80\" trim=\"true\" dojoType=\"dijit.form.ValidationTextBox\" regExpGen=\"dojox.validate.regexp.emailAddress\" trim=\"true\" invalidMessage=\"invalid email address\" size=\"40\" maxlength=\"70\"/></td></tr>\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\" align=\"right\">Tel:</td><td><input dojoAttachPoint=\"tel\" name=\"tel\" type=\"text\" size=\"25\" maxlength=\"40\" dojoType=\"dijit.form.TextBox\"/></td></tr>\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\" align=\"right\">Fax:</td><td><input dojoAttachPoint=\"fax\" name=\"fax\" type=\"text\" size=\"25\" maxlength=\"40\" dojoType=\"dijit.form.TextBox\"/></td></tr>\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\" align=\"right\">Mobile:</td><td><input dojoAttachPoint=\"mobile\" name=\"mobile\" type=\"text\" size=\"25\" maxlength=\"40\" dojoType=\"dijit.form.TextBox\"/></td></tr>\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\" align=\"right\">Twitter</td><td><input dojoAttachPoint=\"twitter\" class=\"prmaxinput\" name=\"twitter\" type=\"text\" maxlength=\"80\" dojoType=\"dijit.form.ValidationTextBox\" regExpGen=\"dojox.validate.regexp.url\" trim=\"true\" style=\"width:90%\"/></td></tr>\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\" align=\"right\">Facebook</td><td><input dojoAttachPoint=\"facebook\" class=\"prmaxinput\" name=\"facebook\" type=\"text\" maxlength=\"80\" dojoType=\"dijit.form.ValidationTextBox\" regExpGen=\"dojox.validate.regexp.url\"  trim=\"true\" style=\"width:90%\"/></td></tr>\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\" align=\"right\">Linkedin</td><td><input dojoAttachPoint=\"linkedin\" class=\"prmaxinput\" name=\"linkedin\" type=\"text\" maxlength=\"80\" dojoType=\"dijit.form.ValidationTextBox\" regExpGen=\"dojox.validate.regexp.url\" trim=\"true\" style=\"width:90%\" /></td></tr>\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\" align=\"right\">Instagram</td><td><input dojoAttachPoint=\"instagram\" class=\"prmaxinput\" name=\"instagram\" type=\"text\" maxlength=\"80\" dojoType=\"dijit.form.ValidationTextBox\" regExpGen=\"dojox.validate.regexp.url\" trim=\"true\" style=\"width:90%\" /></td></tr>\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\" valign=\"top\" align=\"right\">Keywords:</td>\r\n\t\t\t\t\t<td><div  dojoAttachPoint=\"interests\" name=\"interests\" title=\"\" startopen=\"true\" restrict=\"0\" dojoType=\"prcommon.interests.Interests\" selectonly=\"true\" keytypeid=\"6\" displaytitle=\"\"></div></td></tr>\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\" align=\"right\">Profile:</td>\r\n\t\t\t\t\t<td><textarea dojoAttachPoint=\"profile\" name=\"profile\" class=\"dijitTextarea\" dojoType=\"dijit.form.Textarea\"  style=\"width: 24em;\" ></textarea></td></tr>\r\n\t\t\t\t</table>\r\n\t\t\t</form>\r\n\t\t</div>\r\n\t\t<div dojotype=\"dijit.layout.ContentPane\"  region=\"bottom\"  style=\"width:100%;height:3em;padding-right:3px;\">\r\n\t\t\t<table style=\"width:100%;border-style:collapsed\"><tr><td align=\"right\">\r\n\t\t\t\t<button class=\"prmaxbutton\"  type=\"button\" iconClass=\"dijitPrmaxIcon dijitPrmaxIconNew\" dojoAttachPoint=\"newNode\" dojoType=\"dijit.form.Button\" dojoAttachEvent=\"onClick:New\" label=\"New\" disabled=\"disabled\"></button>\r\n\t\t\t\t<button class=\"prmaxbutton\"  type=\"button\" dojoAttachPoint=\"saveNode\"  dojoType=\"dojox.form.BusyButton\" busyLabel=\"Please Wait Saving...\" dojoAttachEvent=\"onClick:Save\" label=\"Save\"></button>\r\n\t\t\t\t</td></tr>\r\n\t\t\t</table>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n",constructor:function(){this._SavedCallBack=dojo.hitch(this,this._Saved);this._LoadCallBack=dojo.hitch(this,this._Loaded);this.outletid=-1;},postCreate:function(){this.save_url=(this.mode==0)?"/outlets/freelance_save":"/outlets/freelance_update";this.borderControl.startup();this.borderControl.resize(arguments[0]);this.countryid.store=PRCOMMON.utils.stores.Countries();this.inherited(arguments);},startup:function(){if(this.mode==1){this.headingNode.innerHTML="Updating Freelance";this.newNode.set("disabled",true);}this.inherited(arguments);},_Loaded:function(_1){this.Clear();this.countryid.set("value",_1.data.outlet.countryid);this.outletNode.set("value",_1.data.outlet.outletid);this.title.set("value",_1.data.contact.prefix);this.firstname.set("value",_1.data.contact.firstname);this.familyname.set("value",_1.data.contact.familyname);this.address1.set("value",_1.data.address.address1);this.address2.set("value",_1.data.address.address2);this.townname.set("value",_1.data.address.townname);this.county.set("value",_1.data.address.county);this.postcode.set("value",_1.data.address.postcode);this.www.set("value",_1.data.outlet.www);this.email.set("value",_1.data.comm.email);this.tel.set("value",_1.data.comm.tel);this.fax.set("value",_1.data.comm.fax);this.mobile.set("value",_1.data.comm.mobile);this.twitter.set("value",_1.data.comm.twitter);this.facebook.set("value",_1.data.comm.facebook);this.linkedin.set("value",_1.data.comm.linkedin);this.instagram.set("value",_1.data.comm.instagram);this.interests.set("value",_1.data.interests);this.profile.set("value",_1.data.outlet.profile);dojo.attr(this.headingNode,"innerHTML","Editing Freelance");this.saveNode.set("disabled",false);this.newNode.set("disabled",true);},_Saved:function(_2){if(_2.success=="OK"){ttl.utilities.showMessageStd("Saved",1000);if(this.outletNode.get("value")==-1){this.New();}else{dojo.publish(PRCOMMON.Events.Outlet_Updated,[_2.data]);}}else{ttl.utilities.hideMessage();alert("Failed");}this.saveNode.cancel();},Load:function(_3){this.saveNode.cancel();this.saveNode.set("disabled",true);this.outletNode.set("value",_3);dojo.xhrPost(ttl.utilities.makeParams({load:this._LoadCallBack,url:"/outlets/freelance_load",content:{outletid:_3}}));},Save:function(){if(ttl.utilities.formValidator(this.requiredNode)==false){alert("Not all required field filled in");this.saveNode.cancel();return;}ttl.utilities.showMessageStd("Saving .........",1000);dojo.xhrPost(ttl.utilities.makeParams({load:this._SavedCallBack,url:this.save_url,content:this.requiredNode.get("value")}));},New:function(){this.Clear();},Clear:function(){this.saveNode.cancel();this.countryid.set("value",1);this.newNode.set("disabled",false);this.outletNode.set("value",-1);this.title.focus();this.title.set("value","");this.firstname.set("value","");this.familyname.set("value","");this.address1.set("value","");this.address2.set("value","");this.townname.set("value","");this.county.set("value","");this.postcode.set("value","");this.www.set("value","");this.email.set("value","");this.tel.set("value","");this.fax.set("value","");this.mobile.set("value","");this.interests.set("value","");this.profile.set("value","");this.twitter.set("value","");this.facebook.set("value","");this.linkedin.set("value","");this.instagram.set("value","");dojo.attr(this.headingNode,"innerHTML","Adding Freelance");},resize:function(){this.borderControl.resize(arguments[0]);}});}