/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prmax.customer.activity.output"]){dojo._hasResource["prmax.customer.activity.output"]=true;dojo.provide("prmax.customer.activity.output");dojo.require("prmax.common.ReportBuilder");dojo.require("prcommon.date.daterange");dojo.declare("prmax.customer.activity.output",[ttl.BaseWidget],{widgetsInTemplate:true,templateString:"<div>\r\n<span class=\"common_prmax_layout\"><br/>\r\n\t<form data-dojo-attach-point=\"form_output\" data-dojo-type=\"dijit.form.Form\" data-dojo-props='onSubmit:\"return false\"'>\r\n\t\t<input data-dojo-attach-point=\"reporttemplateid\" data-dojo-props='name:\"reporttemplateid\",type:\"hidden\",value:33'  data-dojo-type=\"dijit.form.TextBox\"/>\r\n\t\t<label class=\"label_1\">Output Format</label>\r\n\t\t<label data-dojo-attach-point=\"pdf_label\">Pdf&nbsp;<input data-dojo-attach-point=\"pdf\" data-dojo-props=\"name:'reportoutputtypeid',value:'0',type:'radio',checked:true\" data-dojo-type=\"dijit.form.RadioButton\"></label>\r\n\t\t<label data-dojo-attach-point=\"csv_label\">Csv&nbsp;<input data-dojo-attach-point=\"csv\" data-dojo-props=\"name:'reportoutputtypeid',value:'2',type:'radio'\" data-dojo-type=\"dijit.form.RadioButton\"></label>\r\n\t\t<label data-dojo-attach-point=\"excel_label\">Excel&nbsp;<input data-dojo-attach-point=\"excel\" data-dojo-props=\"name:'reportoutputtypeid',value:'4',type:'radio'\" data-dojo-type=\"dijit.form.RadioButton\"></label><br/></br>\r\n\t\t<label class=\"label_1\">Date Range</label><div data-dojo-type=\"prcommon.date.daterange\" data-dojo-attach-point=\"drange\" data-dojo-props='value:\"\",name:\"drange\"'></div><br/>\r\n\r\n\t\t<label class=\"label_1\" data-dojo-attach-point=\"user_label\">User</label><select data-dojo-props='placeHolder:\"No Selection\",name:\"user\",labelType:\"html\",required:false' data-dojo-type=\"dijit.form.FilteringSelect\" data-dojo-attach-point=\"users\"></select><br/>\r\n\t\t<label class=\"label_1\" data-dojo-attach-point=\"type_label\">Type</label><select data-dojo-props='placeHolder:\"No Selection\",name:\"objecttype\",labelType:\"html\",required:false' data-dojo-type=\"dijit.form.FilteringSelect\" data-dojo-attach-point=\"objecttypes\"></select><br/></br>\r\n\r\n\t\t<div data-dojo-type=\"prmax.common.ReportBuilder\" data-dojo-attach-point=\"reportnode\" data-dojo-props='style:\"display:none\"'></div>\r\n\t\t<button data-dojo-attach-event=\"onClick:_clear_filter\" data-dojo-attach-point=\"clearbtn\" data-dojo-type=\"dijit.form.Button\" data-dojo-props='type:\"button\",label:\"Clear\",\"class\":\"btnleft prmaxhidden\"'></button>\r\n\t\t<button data-dojo-attach-event=\"onClick:_close\" data-dojo-attach-point=\"closebtn\" data-dojo-type=\"dijit.form.Button\" data-dojo-props='type:\"button\",label:\"Close\",\"class\":\"btnleft prmaxhidden\"'></button>\r\n\t\t<button data-dojo-attach-event=\"onClick:_do_report\" data-dojo-attach-point=\"reportbtn\" data-dojo-type=\"dijit.form.Button\" data-dojo-props='type:\"button\",label:\"Generate\",\"class\":\"btnright\"'></button>\r\n\t\t<br/><br/>\r\n\t</form>\r\n</span>\r\n</div>\r\n",constructor:function(){this._dialog=null;this._complete_call_back=dojo.hitch(this,this._complete_call);this._users=new dojo.data.ItemFileReadStore({url:"/user/user_list"});this._objecttypes=new dojo.data.ItemFileReadStore({url:"/activity/objecttype_list"});dojo.subscribe("/update/distribution_label",dojo.hitch(this,this._UpdateDistributionLabelEvent));},postCreate:function(){this.inherited(arguments);this.users.store=this._users;this.objecttypes.store=this._objecttypes;},_do_report:function(){var _1=this.form_output.get("value");dojo.addClass(this.reportbtn.domNode,"prmaxhidden");this.reportnode.SetCompleted(this._complete_call_back);this.reportnode.StartNoDialog(_1);},clear:function(){this.reportnode.hide();dojo.removeClass(this.reportbtn.domNode,"prmaxhidden");},_setDialogAttr:function(_2){this._dialog=_2;if(this._dialog!=null){dojo.removeClass(this.closebtn.domNode,"prmaxhidden");dojo.removeClass(this.clearbtn.domNode,"prmaxhidden");}},_close:function(){if(this._dialog){this.reportnode.Stop();this._dialog.hide();this.clear();}},_complete_call:function(){this.reportnode.hide();this._close();this.clear();},_clear_filter:function(){this.users.set("value",null);this.objecttypes.set("value",null);this.drange.set("value",null);this.pdf.set("checked",true);this.reportnode.Stop();dojo.removeClass(this.reportbtn.domNode,"prmaxhidden");},_UpdateDistributionLabelEvent:function(){this._objecttypes=new dojo.data.ItemFileReadStore({url:"/activity/objecttype_list"});},});}