/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prmax.customer.Customer"]){dojo._hasResource["prmax.customer.Customer"]=true;dojo.provide("prmax.customer.Customer");dojo.declare("prmax.customer.Customer",[ttl.BaseWidget],{widgetsInTemplate:true,parentid:"",templateString:"<div>\r\n<div dojoType=\"dijit.TitlePane\" title=\"Contact Details\" open=\"true\" style=\"width:100%\" >\r\n<form dojoAttachPoint=\"customerForm\" onsubmit=\"return false\" dojoType=\"dijit.form.Form\">\r\n<table class=\"prmaxtable\" width=\"100%\">\r\n<tr><td class=\"prmaxrowtag\" style=\"width:30%\">Business Name</td><td width=\"70%\"><input class=\"prmaxinput\" dojoAttachPoint=\"customername\" name=\"customername\" type=\"text\" trim=\"true\" required=\"true\" invalidMessage=\"Please Enter the name of the business\" dojoType=\"dijit.form.ValidationTextBox\" ></td></tr>\r\n<tr><td class=\"prmaxrowtag\" align=\"right\" >Title</td><td><input class=\"prmaxinput\" name=\"contact_title\" dojoAttachPoint=\"contact_title\" type=\"text\" trim=\"true\" dojoType=\"dijit.form.TextBox\" style=\"width: 2em;\" ></input></td></tr>\r\n<tr><td class=\"prmaxrowtag\" align=\"right\" >First Name</td><td><input class=\"prmaxrequired\" name=\"contact_firstname\" dojoAttachPoint=\"contact_firstname\" type=\"text\" trim=\"true\" required=\"true\" dojoType=\"dijit.form.TextBox\" style=\"width: 8em;\" ></input><td></tr>\r\n<tr><td class=\"prmaxrowtag\" align=\"right\" >Surname</td><td><input class=\"prmaxrequired\" name=\"contact_surname\" dojoAttachPoint=\"contact_surname\" type=\"text\" trim=\"true\" required=\"true\" dojoType=\"dijit.form.TextBox\" style=\"width: 12em;\"></input></td></tr>\r\n<tr><td class=\"prmaxrowtag\" >Address:</td><td><input class=\"prmaxinput\" dojoAttachPoint=\"address1\" name=\"address1\" type=\"text\" size=\"40\" required=\"true\" dojoType=\"dijit.form.TextBox\"/></td></tr>\r\n<tr><td class=\"prmaxrowtag\" >Address 2:</td><td><input class=\"prmaxinput\" dojoAttachPoint=\"address2\" name=\"address2\" type=\"text\" size=\"40\" maxlength=\"80\" dojoType=\"dijit.form.TextBox\"/></td></tr>\r\n<tr><td class=\"prmaxrowtag\" >Town</td><td><input class=\"prmaxinput\" dojoAttachPoint=\"townname\" name=\"townname\" type=\"text\" size=\"30\" dojoType=\"dijit.form.TextBox\"/></td></tr>\r\n<tr><td class=\"prmaxrowtag\" >County</td><td><input class=\"prmaxinput\" dojoAttachPoint=\"county\" name=\"county\" type=\"text\" dojoType=\"dijit.form.TextBox\"/></td></tr>\r\n<tr><td class=\"prmaxrowtag\" >Postcode:</td><td><input class=\"prmaxinput\" dojoAttachPoint=\"postcode\" name=\"postcode\" type=\"text\" style=\"width:10em\" maxlength=\"10\" dojoType=\"dijit.form.TextBox\"/></td></tr>\r\n<tr><td class=\"prmaxrowtag\" >Email:</td><td><input class=\"prmaxinput\" dojoAttachPoint=\"email\" name=\"email\" type=\"text\" size=\"40\" maxlength=\"80\" trim=\"true\" required=\"true\" dojoType=\"dijit.form.ValidationTextBox\" regExpGen=\"dojox.validate.regexp.emailAddress\" trim=\"true\" invalidMessage=\"invalid email address\" size=\"40\" maxlength=\"70\"/></td></tr>\r\n<tr><td class=\"prmaxrowtag\" >Tel:</td><td><input class=\"prmaxinput\" dojoAttachPoint=\"tel\" name=\"tel\" type=\"text\" size=\"25\" maxlength=\"40\" dojoType=\"dijit.form.TextBox\"/></td></tr>\r\n<tr><td class=\"prmaxrowtag\" colspan=\"2\" align=\"right\"><button iconClass=\"dijitPrmaxIcon dijitPrmaxUpdate\" dojoAttachPoint=\"saveNode\" disabled=\"disabled\" dojoType=\"dojox.form.BusyButton\" busyLabel=\"Please Wait Saving...\" dojoAttachEvent=\"onClick:_CustomerSave\" label=\"Save\" class=\"prmaxbutton\"></button></td></tr>\r\n</table>\r\n</form>\r\n</div>\r\n<div dojoType=\"dijit.TitlePane\" title=\"Licence\" open=\"true\" style=\"width:100%\" >\r\n<table class=\"prmaxtable\" width=\"100%\">\r\n<tr><td class=\"prmaxrowtag\" style=\"width:30%\">Licence Expires</td><td><input  class=\"prmaxinputdisabled\" dojoAttachPoint=\"licence_expire\" type=\"text\" disabled=\"disabled\" style=\"width:12em\" dojoType=\"dijit.form.TextBox\"/></td></tr>\r\n<tr><td class=\"prmaxrowtag\" >Max Logins</td><td><input class=\"prmaxinputdisabled\" dojoAttachPoint=\"logins\" type=\"text\" disabled=\"disabled\" style=\"width:8em\" dojoType=\"dijit.form.TextBox\"/></td></tr>\r\n</table></div>\r\n<div style=\"width:100%;padding-top:10px;padding-right:4px\">\r\n<button   style=\"float:right\" type=\"button\" class=\"prmaxbutton\" dojoType=\"dijit.form.Button\" dojoAttachEvent=\"onClick:_Close\" ><div class=\"prmaxbuttonlarge\">Close</div></button>\r\n<div>\r\n\r\n</div>\r\n",constructor:function(){this._LoadCallBack=dojo.hitch(this,this._Load);this._SavedCallBack=dojo.hitch(this,this._Saved);},startup:function(){dojo.connect(this.customerForm,"onSubmit",dojo.hitch(this,this._onCustomerSubmit));this.Load();this.inherited(arguments);},_Load:function(_1){this.customername.set("value",_1.data.customername);this.contact_title.set("value",_1.data.contact_title);this.contact_firstname.set("value",_1.data.contact_firstname);this.contact_surname.set("value",_1.data.contact_surname);this.address1.set("value",_1.data.address1);this.address2.set("value",_1.data.address2);this.townname.set("value",_1.data.townname);this.county.set("value",_1.data.county);this.postcode.set("value",_1.data.postcode);this.email.set("value",_1.data.email);this.tel.set("value",_1.data.tel);this.licence_expire.set("value",_1.data.licence_expire);this.logins.set("value",_1.data.logins);this.customername.focus();this.saveNode.set("disabled",false);},_Saved:function(_2){this.saveNode.cancel();},_CustomerSave:function(){this.customerForm.submit();},_onCustomerSubmit:function(){try{if(ttl.utilities.formValidator(this.customerForm)==false){alert("Not all required field filled in");this.saveNode.cancel();return;}var _3=this.customerForm.get("value");ttl.utilities.showMessageStd("Saving .........",1000);dojo.xhrPost(ttl.utilities.makeParams({load:this._SavedCallBack,url:"/customers/update",content:_3}));}catch(e){alert(e);}},Load:function(){dojo.xhrPost(ttl.utilities.makeParams({load:this._LoadCallBack,url:"/customers/get"}));},Clear:function(){this.saveNode.cancel();},_Close:function(){this.Clear();dojo.publish(PRCOMMON.Events.Dialog_Close,["customer"]);}});}