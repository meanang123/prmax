/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prmax.geographical.GeographicalTree"]){dojo._hasResource["prmax.geographical.GeographicalTree"]=true;dojo.provide("prmax.geographical.GeographicalTree");dojo.require("ttl.BaseWidget");dojo.require("dojox.rpc.Service");dojo.require("dojox.data.JsonRestStore");dojo.require("dijit.tree.ForestStoreModel");dojo.require("dijit.Tree");dojo.declare("prmax.geographical.GeographicalTree",[ttl.BaseWidget],{templateString:"<div>\r\n\t<div dojoAttachPoint=\"frame\" dojotype=\"dijit.layout.BorderContainer\" style=\"width:100%;height:100%\" gutters=\"false\" >\r\n\t\t<div dojoAttachPoint=\"tree\" dojotype=\"dijit.layout.ContentPane\"  region=\"center\" ></div>\r\n\t\t<div dojotype=\"dijit.layout.ContentPane\"  region=\"bottom\" style=\"width:100%;height:2em\">\r\n\t\t\t<button style=\"float:right;padding-right:10px\" dojoType=\"dijit.form.Button\" type=\"button\" dojoAttachEvent=\"onClick:_Close\">Close</button>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n",constructor:function(){this.inherited(arguments);this.jsonStore=new dojox.data.JsonRestStore({target:"/geographical/resttree",labelAttribute:"name"});this.myModel=new dijit.tree.ForestStoreModel({store:this.jsonStore,deferItemLoadingUntilExpand:true,query:"root",childrenAttrs:["children"]});},postCreate:function(){this.treenode=new dijit.Tree({model:this.myModel,showRoot:true,label:"Countries",persist:false});this.tree.domNode.appendChild(this.treenode.domNode);this.treenode.startup();dojo.connect(this.treenode,"onDblClick",dojo.hitch(this,this._SelectNode));this.inherited(arguments);},_SelectNode:function(e){dojo.publish(PRCOMMON.Events.Geographical_Selected,[{geographicalid:e.id,geographicalname:e.name}]);},_Close:function(){dojo.publish(PRCOMMON.Events.Dialog_Close,["geog_close"]);},resize:function(){this.frame.resize(arguments[0]);this.inherited(arguments);}});}