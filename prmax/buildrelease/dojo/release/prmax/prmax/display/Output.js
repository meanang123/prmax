/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prmax.display.Output"]){dojo._hasResource["prmax.display.Output"]=true;dojo.provide("prmax.display.Output");dojo.require("dijit._Templated");dojo.require("dijit._Widget");dojo.require("dijit._Container");dojo.declare("prmax.display.Output",[dijit._Widget,dijit._Templated,dijit._Container],{widgetsInTemplate:true,selection:-1,templateString:"<div style=\"width:710px;height:465px;overflow:auto;padding:0px;margin:0px\">\r\n\t<div  dojoAttachPoint=\"tabcont\" dojotype=\"dijit.layout.TabContainer\" style=\"width:100%;height:100%;padding:0px;margin:0px\" >\r\n\t\t<div dojoAttachPoint=\"excelview\" dojoType=\"dijit.layout.ContentPane\" title=\"Excel\" preload=\"true\"  selected >\r\n\t\t\t<form dojoType=\"dijit.form.Form\" onsubmit=\"return false\" dojoAttachPoint=\"csvFormNode\">\r\n\t\t\t<table width=\"100%\" class=\"prmaxtable\" >\r\n\t\t\t\t<tr><td colspan=\"2\">&nbsp;</td></tr>\r\n\t\t\t\t<tr><td class=\"prmaxrowtag\" >Formats</td>\r\n\t\t\t\t\t<td><select  name=\"reporttemplateid\" class=\"prmaxrequired\"\r\n\t\t\t\t\t\t\tdojoAttachPoint=\"csvTemplateNode\"\r\n\t\t\t\t\t\t\tautoComplete=\"true\"\r\n\t\t\t\t\t\t\t searchAttr=\"reporttemplatename\"\r\n\t\t\t\t\t\t\t labelAttr=\"reporttemplatename\"\r\n\t\t\t\t\t\t\t dojoType=\"dijit.form.FilteringSelect\"\r\n\t\t\t\t\t\t\t labelType=\"html\"></select></td></tr>\r\n\t\t\t\t<tr><td class=\"prmaxrowtag\">Selection</td>\r\n\t\t\t\t\t<td><div  name = \"selector\"\r\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"csvSelectionNode\"\r\n\t\t\t\t\t\t\t\t dojoType=\"prmax.common.SelectOptions\" ></div></td></tr>\r\n\t\t\t\t<tr><td colspan=\"2\">&nbsp;</td></tr>\r\n\t\t\t\t<tr><td colspan=\"2\" >\r\n\t\t\t\t\t<table width=\"90%\" class=\"prmaxtable\">\r\n\t\t\t\t\t\t<tr><td><div dojoType=\"prmax.common.ReportBuilder\" dojoAttachPoint=\"csvReportNode\" style=\"display:none\"></div></td></tr>\r\n\t\t\t\t\t\t<tr><td colspan=\"2\" align=\"right\"><button class=\"prmaxbutton\" dojoType=\"dojox.form.BusyButton\" busyLabel=\"Please Wait Generating Report...\" label=\"Generate\" dojoAttachPoint=\"csvReportButtonNode\" dojoAttachEvent=\"onClick:_csvreport\"></button></td></tr>\r\n\t\t\t\t\t</table></td></tr>\r\n\t\t\t\t\t<tr><td colspan=\"2\"><div dojoAttachPoint=\"csv_notshown\" class=\"prmaxhidden\">If you cannot see the report, please press <a  dojoAttachPoint=\"csv_link\" href=\"\"  target=\"_blank\">here</a></div></td></tr>\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t</table>\r\n\t\t\t</form>\r\n\t\t</div>\r\n\t\t<div dojoType=\"dijit.layout.ContentPane\" title=\"Labels\" preload=\"true\" >\r\n\t\t\t<form dojoType=\"dijit.form.Form\" onsubmit=\"return false\" dojoAttachPoint=\"labelFormNode\">\r\n\t\t\t<table width=\"100%\" class=\"prmaxtable\" >\r\n\t\t\t\t<tr><td colspan=\"2\">&nbsp;</td></tr>\r\n\t\t\t\t<tr><td class=\"prmaxrowtag\" >Label Format</td>\r\n\t\t\t\t\t<td><select  name=\"labelid\" class=\"prmaxrequired\"\r\n\t\t\t\t\t\t\tdojoAttachPoint=\"labelTemplateNode\"\r\n\t\t\t\t\t\tautoComplete=\"true\"\r\n\t\t\t\t\t\t searchAttr=\"name\"\r\n\t\t\t\t\t\t labelAttr=\"name\"\r\n\t\t\t\t\t\t dojoType=\"dijit.form.FilteringSelect\"\r\n\t\t\t\t\t\t required=\"true\"\r\n\t\t\t\t\t\tinvalidMessage=\"Please select label format\"\r\n\t\t\t\t\t\t labelType=\"html\"></select></td></tr>\r\n\t\t\t\t<tr><td class=\"prmaxrowtag\" valign=\"top\">Selection</td>\r\n\t\t\t\t\t<td><div  name = \"selector\"\r\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"labelSelectionNode\"\r\n\t\t\t\t\t\t\t\t dojoType=\"prmax.common.SelectOptions\" ></div></td></tr>\r\n\t\t\t\t<tr><td class=\"prmaxrowtag\" valign=\"top\">Show Label Outlines</td>\r\n\t\t\t\t<td><input name=\"frame\" value=\"1\" class=\"prmaxinput\" type=\"checkbox\" dojoType=\"dijit.form.CheckBox\" /></td></tr>\r\n\t\t\t<tr><td colspan=\"2\">&nbsp;</td></tr>\r\n\t\t\t<tr><td colspan=\"2\" >\r\n\t\t\t\t<table width=\"90%\" class=\"prmaxtable\">\r\n\t\t\t\t\t<tr><td><div dojoType=\"prmax.common.ReportBuilder\" dojoAttachPoint=\"labelReportNode\" style=\"display:none\"></div></td></tr>\r\n\t\t\t\t\t<tr><td colspan=\"2\" align=\"right\"><button class=\"prmaxbutton\" dojoType=\"dojox.form.BusyButton\" busyLabel=\"Please Wait Generating Labels...\" label=\"Generate\" dojoAttachPoint=\"labelReportButtonNode\" dojoAttachEvent=\"onClick:_labelreport\"></button></td></tr>\r\n\t\t\t\t</table></td></tr>\r\n\t\t\t<tr><td colspan=\"2\"><div dojoAttachPoint=\"label_notshown\" class=\"prmaxhidden\">If you cannot see the report, please press <a  dojoAttachPoint=\"label_link\" href=\"\"  target=\"_blank\">here</a></div></td></tr>\t\t\t\t\r\n\t\t\t</table>\r\n\t\t\t</form>\r\n\t\t</div>\r\n\t\t<div dojoType=\"dijit.layout.ContentPane\" title=\"Reports\" preload=\"true\" dojoAttachPoint=\"reports\" >\r\n\t\t\t<form dojoType=\"dijit.form.Form\" onsubmit=\"return false\" dojoAttachPoint=\"formNode\">\r\n\t\t\t<table width=\"100%\" class=\"prmaxtable\" >\r\n\t\t\t<tr><td colspan=\"2\">&nbsp;</td></tr>\r\n\t\t\t<tr><td class=\"prmaxrowtag\" >Report</td>\r\n\t\t\t\t<td><select  name=\"reporttemplateid\" class=\"prmaxrequired\"\r\n\t\t\t\t\t\tdojoAttachPoint=\"reportTemplateNode\"\r\n\t\t\t\t\t\tautoComplete=\"true\"\r\n\t\t\t\t\t\t searchAttr=\"reporttemplatename\"\r\n\t\t\t\t\t\t labelAttr=\"reporttemplatename\"\r\n\t\t\t\t\t\t dojoType=\"dijit.form.FilteringSelect\"\r\n\t\t\t\t\t\t labelType=\"html\"></select></td></tr>\r\n\t\t\t<tr><td class=\"prmaxrowtag\">Selection</td>\r\n\t\t\t\t<td><div  name = \"selector\"\r\n\t\t\t\t\t\t\tdojoAttachPoint=\"selectionNode\"\r\n\t\t\t\t\t\t\t dojoType=\"prmax.common.SelectOptions\" ></div></td></tr>\r\n\t\t\t<tr><td class=\"prmaxrowtag\">Report Title</td><td><input data-dojo-type=\"dijit.form.TextBox\" data-dojo-attach-point=\"reporttitle\" data-dojo-props='name:\"reporttitle\"'></td></tr>\r\n\r\n\t\t\t<tr><td colspan=\"2\">&nbsp;</td></tr>\r\n\t\t\t<tr><td colspan=\"2\" >\r\n\t\t\t\t<table width=\"90%\" class=\"prmaxtable\">\r\n\t\t\t\t\t<tr><td><div dojoType=\"prmax.common.ReportBuilder\" dojoAttachPoint=\"reportNode\" style=\"display:none\"></div></td></tr>\r\n\t\t\t\t\t<tr><td colspan=\"2\" align=\"right\"><button class=\"prmaxbutton\" dojoType=\"dojox.form.BusyButton\" busyLabel=\"Please Wait Generating Report...\" label=\"Generate\" dojoAttachPoint=\"reportButtonNode\" dojoAttachEvent=\"onClick:_report\"></button></td></tr>\r\n\t\t\t\t</table></td></tr>\r\n\t\t\t<tr><td colspan=\"2\"><div dojoAttachPoint=\"report_notshown\" class=\"prmaxhidden\">If you cannot see the report, please press <a  dojoAttachPoint=\"report_link\" href=\"\"  target=\"_blank\">here</a></div></td></tr>\t\t\t\t\r\n\t\t\t</table>\r\n\t\t\t</form>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n",constructor:function(){this._reportlist=new dojox.data.QueryReadStore({url:"/reports/reporttemplates?reportsourceid=2",onError:ttl.utilities.globalerrorchecker});csv_typeid=(PRMAX.utils.settings.customertypeid==18)?10:3;this._csvlist=new dojo.data.ItemFileReadStore({url:"/reports/reporttemplates?reportsourceid="+csv_typeid});this._labellist=new dojox.data.QueryReadStore({url:"/common/lookups?searchtype=labels",onError:ttl.utilities.globalerrorchecker});this._completecall=dojo.hitch(this,this._complete);this._csvcompletecall=dojo.hitch(this,this._csvcomplete);this._labelcompletecall=dojo.hitch(this,this._labelcomplete);},postCreate:function(){this.reportTemplateNode.store=this._reportlist;this.csvTemplateNode.store=this._csvlist;this.labelTemplateNode.store=this._labellist;dojo.connect(this.formNode,"onSubmit",dojo.hitch(this,this._Submit));dojo.connect(this.csvFormNode,"onSubmit",dojo.hitch(this,this._csvSubmit));dojo.connect(this.labelFormNode,"onSubmit",dojo.hitch(this,this._labelSubmit));this.selectionNode.setOptions(this.selection);this.csvSelectionNode.setOptions(this.selection);this.labelSelectionNode.setOptions(this.selection);this.csvTemplateNode.set("value",4);this.inherited(arguments);},startup:function(){this.inherited(arguments);if(PRMAX.utils.settings.no_export==true){this.excelview.controlButton.domNode.style.display="none";this.tabcont.selectChild(this.reports);}},_report:function(){if(ttl.utilities.formValidator(this.formNode)==false){alert("Not all required field filled in");this.reportButtonNode.cancel();return;}dojo.addClass(this.report_notshown,"prmaxhidden");this.formNode.submit();},_csvreport:function(){if(ttl.utilities.formValidator(this.csvFormNode)==false){alert("Not all required field filled in");this.csvReportButtonNode.cancel();return;}dojo.addClass(this.csv_notshown,"prmaxhidden");this.csvFormNode.submit();},_Submit:function(){var _1=this.formNode.get("value");_1["reportoutputtypeid"]=0;_1["sortorder"]=PRMAX.search.getSortIndex();_1["searchtypeid"]=1;this.reportNode.SetCompleted(this._completecall);this.reportNode.StartNoDialog(_1);},_csvSubmit:function(){var _2=this.csvFormNode.get("value");_2["reportoutputtypeid"]=2;_2["sortorder"]=PRMAX.search.getSortIndex();_2["searchtypeid"]=1;this.csvReportNode.SetCompleted(this._csvcompletecall);this.csvReportNode.StartNoDialog(_2);},_complete:function(){PRMAX.search.stdDialog.hide();this.reportButtonNode.cancel();dojo.removeClass(this.report_notshown,"prmaxhidden");dojo.attr(this.report_link,"href","/reports/viewpdf?reportid="+this.reportNode.reportid.value);this.reportNode.hide();},_csvcomplete:function(){PRMAX.search.stdDialog.hide();this.csvReportButtonNode.cancel();dojo.removeClass(this.csv_notshown,"prmaxhidden");dojo.attr(this.csv_link,"href","/reports/viewcsv?reportid="+this.csvReportNode.reportid.value);this.csvReportNode.hide();},_labelcomplete:function(){PRMAX.search.stdDialog.hide();this.labelReportButtonNode.cancel();dojo.removeClass(this.label_notshown,"prmaxhidden");dojo.attr(this.label_link,"href","/reports/viewpdf?reportid="+this.labelReportNode.reportid.value);this.labelReportNode.hide();},Clear:function(_3){this.csvReportButtonNode.cancel();this.csvSelectionNode.setOptions(_3);this.csvReportNode.Stop();this.labelReportButtonNode.cancel();this.labelReportNode.Stop();this.labelSelectionNode.setOptions(_3);this.reportButtonNode.cancel();this.reportNode.Stop();this.selectionNode.setOptions(_3);},resize:function(){this.tabcont.resize(arguments[0]);},_labelreport:function(){if(ttl.utilities.formValidator(this.labelFormNode)==false){alert("Not all required field filled in");this.labelReportButtonNode.cancel();return;}if(ttl.utilities.testPopUpBlocker()==true){alert("Pop-up blocked");this.labelReportButtonNode.cancel();return;}dojo.addClass(this.label_notshown,"prmaxhidden");this.labelFormNode.submit();},_labelSubmit:function(){var _4=this.labelFormNode.get("value");_4["reporttemplateid"]=0;_4["reportoutputtypeid"]=3;_4["sortorder"]=PRMAX.search.getSortIndex();_4["searchtypeid"]=1;this.labelReportNode.SetCompleted(this._labelcompletecall);this.labelReportNode.StartNoDialog(_4);}});}