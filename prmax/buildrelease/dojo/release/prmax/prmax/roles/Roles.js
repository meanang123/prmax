/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prmax.roles.Roles"]){dojo._hasResource["prmax.roles.Roles"]=true;dojo.provide("prmax.roles.Roles");dojo.require("prcommon.search.std_search");dojo.declare("prmax.roles.Roles",[prcommon.search.std_search,ttl.BaseWidget],{name:"",value:"",size:"7",startopen:false,searchmode:false,widgetsInTemplate:true,selectonly:true,templateString:"<div dojoAttachPoint=\"roles_search\" >\r\n\t<div class=\"prmaxhidden\" dojoAttachPoint=\"toggleszone\" >\r\n\t<table width=\"100%\" class=\"prmaxtable\" cellpadding=\"0\" cellspacing=\"0\" >\r\n\t\t<tr>\r\n\t\t\t<td width=\"20%\"  class=\"prmaxrowtag\">Job Roles</td>\r\n\t\t\t<td width=\"5%\" ><i dojoAttachPoint=\"toggleCtrl\" dojoAttachEvent=\"onclick:_Toggle\" class=\"fa fa-plus-circle\" style=\"color:#7F7F7F\"></i></td>\r\n\t\t\t<td width=\"75%\"></td>\r\n\t\t</tr>\r\n\t</table></div>\r\n\t<div class=\"dojoInterestPane\" >\r\n\t\t<div dojoAttachPoint=\"selectarea\" style=\"display:none\" >\r\n\t\t\t<table width=\"100%\" class=\"prmaxtable\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\r\n\t\t\t\t  <tr><td width=\"47%\"></td><td width=\"5%\"></td><td width=\"48%\" ></td></tr>\r\n\t\t\t\t  <tr><td colspan=\"3\">\r\n\t\t\t\t  <table style=\"width:100%\" class=\"prmaxtable\" >\r\n\t\t\t\t\t  <tr>\r\n\t\t\t\t\t  <td width=\"70%\" dojoAttachPoint=\"master_type_text\"><span class=\"prmaxrowtag\">Select </span><input class=\"prmaxfocus prmaxinput\" type=\"text\" dojoType=\"dijit.form.TextBox\" style=\"width:150px\" dojoAttachPoint=\"interest_list_select\" dojoAttachEvent=\"onkeyup:interestSelect\" /></td>\r\n\t\t\t\t\t<td><div dojoAttachPoint=\"show_search_itegration\" class=\"prmaxhidden\"><label dojoAttachPoint=\"search_only_label\">Default to Primary</label><input class=\"prmaxdefault\" dojoAttachPoint=\"search_only\"  dojoType=\"dijit.form.CheckBox\" type=\"checkbox\" value=\"1\" /></div></td></tr>\r\n\t\t\t\t\t</table>\r\n\t\t\t\t  </td></tr>\r\n\t\t\t\t  <tr><td ><select style=\"width:100%\" name=\"roles\" dojoAttachPoint=\"interest_list\" size=\"${size}\" class=\"lists\" multiple=\"multiple\" ></select></td>\r\n\t\t\t\t  <td >\r\n\t\t\t\t\t<button class=\"button_add_all\" style=\"padding:0px;margin:0px\" dojoAttachPoint=\"button_all\" disabled=\"true\" type=\"button\" dojoAttachEvent=\"onClick:interestSelectAll\" dojoType=\"dijit.form.Button\"><div class=\"std_movement_button\">&gt;&gt;</div></button><br/>\r\n\t\t\t\t\t<button class=\"button_add_single\" style=\"padding:0px;margin:0px\" dojoAttachPoint=\"button_single\" disabled=\"true\" type=\"button\" dojoType=\"dijit.form.Button\" dojoAttachEvent=\"onClick:interestSelectSingle\"><div class=\"std_movement_button\">&gt;&nbsp;</div></button><br/>\r\n\t\t\t\t\t<button class=\"button_del_all\" style=\"padding:0px;margin:0px\" dojoAttachPoint=\"button_del_all\" disabled=\"true\" type=\"button\" dojoType=\"dijit.form.Button\" dojoAttachEvent=\"onClick:interestRemoveAll\"><div class=\"std_movement_button\">&lt;&lt;</div></button><br/>\r\n\t\t\t\t\t<button class=\"button_del_single\" style=\"padding:0px;margin:0px\" dojoAttachPoint=\"button_del_single\" disabled=\"true\" type=\"button\" dojoType=\"dijit.form.Button\" dojoAttachEvent=\"onClick:interestRemoveSingle\"><div class=\"std_movement_button\">&lt;&nbsp;</div></button></td>\r\n\t\t\t\t  <td ><select style=\"width:100%\" dojoAttachPoint=\"interest_select\" size=\"${size}\" class=\"lists\"  dojoAttachEvent=\"onchange:interestUpdateSelection\"></select></td>\r\n\t\t\t\t  <td>\r\n\t\t\t\t\t<button  style=\"padding:0px;margin:0px\" dojoAttachPoint=\"up\" disabled=\"true\" type=\"button\" dojoAttachEvent=\"onClick:_UpButton\" dojoType=\"dijit.form.Button\"><div style=\"width:2em\">Up</div></button><br/>\r\n\t\t\t\t\t<button style=\"padding:0px;margin:0px\" dojoAttachPoint=\"down\" disabled=\"true\" type=\"button\" dojoType=\"dijit.form.Button\" dojoAttachEvent=\"onClick:_DownButton\"><div style=\"width:2em\">Down</div></button><br/>\r\n\t\t\t\t  </td></tr>\r\n\t\t\t</table>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n",constructor:function(){this.disabled=false;this._extended=false;this._LoadSelectionCall=dojo.hitch(this,this._LoadSelection);this.selectTimer=null;},postCreate:function(){dojo.connect(this.interest_list_select.domNode,"onkeyup",dojo.hitch(this,this.interestSelect));dojo.connect(this.interest_list,"onchange",dojo.hitch(this,this.interestUpdateSelection));dojo.connect(this.interest_list,"ondblclick",dojo.hitch(this,this.interestSelectDbl));if(this.startopen){dojo.style(this.toggleCtrl,"display","none");dojo.style(this.selectarea,"display","block");}else{dojo.style(this.toggleszone,"display","block");dojo.style(this.selectarea,"display","none");}this.inherited(arguments);},Clear:function(){this._ClearSelectionBox();this._ClearSelectedBox();this.interest_list_select.set("value","");this._Get(this._getValueAttr());this._SelectionOptions();this.inherited(arguments);},_Send_Request:function(_1){dojo.xhrPost(ttl.utilities.makeParams({load:this._LoadSelectionCall,url:"/roles/listuserselection",content:{word:_1}}));},interestSelect:function(){var _2=this.interest_list_select.get("value");if(_2.length>0){if(this.selectTimer){clearTimeout(this.selectTimer);this.selectTimer=null;}this.selectTimer=setTimeout(dojo.hitch(this,this._Send_Request,_2),this.searchTime);}else{if(this.selectTimer){clearTimeout(this.selectTimer);this.selectTimer=null;}this._ClearSelectionBox();this._SelectionOptions();}},_LoadSelection:function(_3){this._ClearSelectionBox();for(var i=0;i<_3.data.length;++i){var _4=_3.data[i];this.interest_list.options[this.interest_list.options.length]=new Option(_4[0],_4[1]);}this._SelectionOptions();},_ClearSelectionBox:function(){this.interest_list.options.length=0;},_ClearSelectedBox:function(){this.interest_select.length=0;},interestUpdateSelection:function(){this._SelectionOptions();},interestSelectDbl:function(){this.interestSelectSingle();this._SelectionOptions();},interestSelectAll:function(){for(var c=0;c<this.interest_list.options.length;c++){var _5=this.interest_list.options[c];var _6=true;for(var c1=0;c1<this.interest_select.options.length;c1++){if(this.interest_select.options[c1].value==_5.value){_6=false;break;}}if(_6){this.interest_select.options[this.interest_select.options.length]=new Option(_5.text,_5.value);}}this._Get(this._getValueAttr());this.interest_list.options.length=0;this.interestUpdateSelection();},interestSelectSingle:function(){for(var c=0;c<this.interest_list.options.length;c++){var _7=this.interest_list.options[c];if(_7.selected){_7.selected=false;var _8=true;for(var c1=0;c1<this.interest_select.options.length;c1++){if(this.interest_select.options[c1].value==_7.value){_8=false;break;}}if(_8){this.interest_select.options[this.interest_select.options.length]=new Option(_7.text,_7.value);this._Get(this._getValueAttr());}}}},interestRemoveAll:function(){this.interest_select.options.length=0;this.interestUpdateSelection();this._Get(this._getValueAttr());},interestRemoveSingle:function(){for(var c=0;c<this.interest_select.options.length;c++){if(this.interest_select.options[c].selected){this.interest_select.options[c]=null;}}this.interestUpdateSelection();this._Get(this._getValueAttr());},addSelect:function(_9){this.interest_select.options[this.interest_select.options.length]=new Option(_9.interestname,_9.interestid);},_setValueAttr:function(_a){this.Clear();var _b=_a.data;var _c=false;if(_b==null||_b==undefined){_b=_a;}for(var _d in _b){var _e=_b[_d];this.interest_select.options[this.interest_select.options.length]=new Option(_e.interestname,_e.interestid);opne=true;}if(_c){this.MakeOpen();}this._Get(this._getValueAttr());},_getValueAttr:function(){var _f=Array();for(var c=0;c<this.interest_select.options.length;c++){if(this._extended){_f[c]={interestid:parseInt(this.interest_select.options[c].value),interestname:this.interest_select.options[c].text};}else{_f[c]=parseInt(this.interest_select.options[c].value);}}var obj=this._CaptureExtendedContent({data:_f});if(this._extended){return obj;}else{var _f=_f.length>0?dojo.toJson(obj):"";this.value=_f;return _f;}},_getCountAttr:function(){return this.interest_select.options.length;},_setExtendedAttr:function(_10){this._extended=_10;},changeFilter:function(){this.interestSelect();},_SelectionOptions:function(){this.button_all.set("disabled",this.interest_list.length?false:true);this.button_single.set("disabled",this.interest_list.selectedIndex!=-1?false:true);this.button_del_all.set("disabled",this.interest_select.length?false:true);this.button_del_single.set("disabled",this.interest_select.selectedIndex!=-1?false:true);this._UpDown();},_UpDown:function(){var _11=true;var _12=true;if(this.interest_select.options.length>1&&this.interest_select.selectedIndex!=-1){if(this.interest_select.selectedIndex>0){_11=false;}if(this.interest_select.selectedIndex<this.interest_select.options.length-1){_12=false;}}this.up.set("disabled",_11);this.down.set("disabled",_12);},_UpButton:function(){var _13=this.interest_select.selectedIndex;if(_13!=-1){var _14=this.interest_select.options[_13];var _15=this.interest_select.options[_13-1];this.interest_select.options[_13-1]=new Option(_14.innerHTML,_14.value,true);this.interest_select.options[_13]=new Option(_15.innerHTML,_15.value);this._UpDown();}},_DownButton:function(){var _16=this.interest_select.selectedIndex;if(_16!=-1){var _17=this.interest_select.options[_16];var _18=this.interest_select.options[_16+1];this.interest_select.options[_16+1]=new Option(_17.innerHTML,_17.value,true);this.interest_select.options[_16]=new Option(_18.innerHTML,_18.value);this._UpDown();}},_CaptureExtendedContent:function(_19){var _1a={logic:2};if(this.search_only.get("checked")){_1a.search_only=true;}return dojo.mixin(_19,_1a);},_setDisabledAttr:function(_1b){this.disabled=_1b;},_getDisabledAttr:function(){return this.disabled;},destroy:function(){this.inherited(arguments);},_Get:function(){if(this.selectonly==false){this.inherited(arguments);}},_focus:function(){this.interest_list_select.focus();},_Toggle:function(){this.inherited(arguments);}});}