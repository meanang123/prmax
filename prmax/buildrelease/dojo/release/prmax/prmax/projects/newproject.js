/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prmax.projects.newproject"]){dojo._hasResource["prmax.projects.newproject"]=true;dojo.provide("prmax.projects.newproject");dojo.require("dijit._Templated");dojo.require("dijit._Widget");dojo.require("dijit._Container");dojo.declare("prmax.projects.newproject",[dijit._Widget,dijit._Templated,dijit._Container],{selected:-1,widgetsInTemplate:true,templateString:"<div>\r\n<div  dojoAttachPoint=\"dlg\" dojoType=\"dijit.Dialog\" title=\"Enter New Project\">\r\n\t<form dojoAttachPoint=\"form\" dojoType=\"dijit.form.Form\" onsubmit=\"return false\">\r\n\t<table>\r\n\t\t<tr>\r\n\t\t\t<td><label >Name</label></td>\r\n\t\t\t<td><input dojoType=\"dijit.form.ValidationTextBox\" dojoAttachPoint=\"projectname\" name=\"projectname\" required=\"true\" trim=\"true\" maxlength=\"45\" promptMessage=\"Enter new projects name\" type=\"text\"/></td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td align=\"left\">\r\n\t\t\t\t<button dojoAttachEvent=\"onClick:_Cancel\" dojoType=\"dijit.form.Button\" type=\"button\" >Cancel</button></td>\r\n\t\t\t<td align=\"right\">\r\n\t\t\t\t<button dojoAttachEvent=\"onClick:_Save\" dojoAttachPoint=\"saveNode\"  dojoType=\"dojox.form.BusyButton\" type=\"button\" >Add Project</button></td>\r\n\t\t</tr>\r\n\t</table></form>\r\n</div>\r\n</div>\r\n",constructor:function(){this.callback=null;this._listid=-1;this._SavedCall=dojo.hitch(this,this._Saved);},postCreate:function(){dojo.connect(this.form,"onSubmit",dojo.hitch(this,this._SubmitAdd));},_Save:function(){this.form.submit();},_Cancel:function(){this.hide();},_SubmitAdd:function(){if(ttl.utilities.formValidator(this.form)==false){alert("Not all required field filled in");this.saveNode.cancel();return;}dojo.xhrPost(ttl.utilities.makeParams({load:this._SavedCall,url:"/projects/addnew",content:this.form.get("value")}));},_Saved:function(_1){if(_1.success=="OK"){dojo.publish(PRCOMMON.Events.Project_Add,[_1.project]);alert("Project Added");this.hide();}else{if(_1.success=="DU"){alert("Project Already Exists");this.projectname.focus();this.saveNode.cancel();}else{if(_1.success=="VF"){alert("Project Name: "+_1.error_message[0][1]);this.projectname.focus();}else{alert("Problem with Project");this.projectname.focus();}}}this.saveNode.cancel();},destroy:function(){this.inherited(arguments);},show:function(){this.saveNode.cancel();this.projectname.set("value",null);this.projectname.focus();this.dlg.show();},hide:function(){this.dlg.hide();this.saveNode.cancel();}});}