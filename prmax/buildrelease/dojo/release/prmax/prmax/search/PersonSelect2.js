/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prmax.search.PersonSelect2"]){dojo._hasResource["prmax.search.PersonSelect2"]=true;dojo.provide("prmax.search.PersonSelect2");dojo.require("ttl.BaseWidget");dojo.require("dijit.Dialog");dojo.require("ttl.Form");dojo.require("prmax.search.standard");dojo.require("prcommon.crm.add");dojo.require("prmax.search.PersonSelect");dojo.require("prmax.search.PersonSelectDetails");dojo.declare("prmax.search.PersonSelect2",[ttl.BaseWidget],{templateString:"<div class=\"dijit dijitReset dijitInline dijitLeft dijitTextBox dijitValidationContainer dijitInputField dijitTextBox noborders\">\r\n\t<input data-dojo-props='name:\"outletid\",type:\"hidden\",value:\"-1\"' data-dojo-attach-point=\"outletid\"  data-dojo-type=\"dijit.form.TextBox\" />\r\n\t<input data-dojo-props='name:\"employeeid\",type:\"hidden\",value:\"-1\"' data-dojo-attach-point=\"employeeid\"  data-dojo-type=\"dijit.form.TextBox\" />\r\n\t<p style=\"float:left;position:relative;top:3px;white-space: nowrap;overflow:hidden;width:85%\" class=\"PlaceHolder dijitReset noborders\" data-dojo-attach-point=\"contact_display\"></p>\r\n\t<button data-dojo-attach-event=\"onClick:_select_contact\" data-dojo-type=\"dijit.form.Button\" data-dojo-attach-point=\"selectbtn\" data-dojo-props='type:\"button\",label:\"Select a contact\",style:\"float:right;padding:0px;margin:0px\",iconClass:\"fa fa-search fa-fw\",showLabel: false, \"class\":\"dijitReset\"'></button>\r\n\t<button data-dojo-attach-point=\"clearbtn\" data-dojo-attach-event=\"onClick:_clear\" data-dojo-type=\"dijit.form.Button\" data-dojo-props='style:\"float:right;padding:0px;margin:0px\",type:\"button\",label:\"Clear current selection\",\"class\":\"prmaxhidden dijitReset\",iconClass:\"fa fa-eraser fa-fw\",showLabel: false'></button>\r\n\t<button data-dojo-attach-point=\"infobtn\" data-dojo-attach-event=\"onClick:_load_contact_details\" data-dojo-type=\"dijit.form.Button\" data-dojo-props='style:\"float:right;padding:0px;padding-top:0px;padding-bottom:0px;margin:0px\",type:\"button\",label:\"Show contact details\",\"class\":\"prmaxhidden dijitReset\",iconClass:\"fa fa-info fa-fw\",showLabel: false'></button>\r\n\t<div data-dojo-attach-point=\"person_select_dlg\" data-dojo-type=\"prmax.search.PersonSelect\"></div>\r\n\t<div data-dojo-attach-point=\"selectdetails_dlg\" data-dojo-type=\"dijit.Dialog\" data-dojo-props='title:\"Contact Details\",style:\"width:600px;height:530px\"'>\r\n\t\t<div data-dojo-attach-point=\"selectdetails_ctrl\" data-dojo-type=\"prmax.search.PersonSelectDetails\" data-dojo-props='style:\"width:590px;height:480px\"'></div>\r\n\t</div>\t\t\r\n</div>\r\n\r\n",searchtypeid:7,placeHolder:"Select Contact<br/><br/><br/>",source_url:"/search/list",mode:"search",constructor:function(){this._contactid=null;this._load_call_back=dojo.hitch(this,this._load_call);this._on_select_contact_call_back=dojo.hitch(this,this._on_select_contact);this.show_infotbtn=false;},postCreate:function(){dojo.addClass(this.clearbtn.domNode,"prmaxhidden");dojo.addClass(this.infobtn.domNode,"prmaxhidden");dojo.attr(this.contact_display,"innerHTML",this.placeHolder);this.inherited(arguments);},_show_details_function:function(_1){},_load_call:function(_2){this._contactid=_2.contact.contactid;},_setValueAttr:function(_3){this._contactid=_3;this._set_view();},_setModeAttr:function(_4){this.mode=_4;this._set_view();},_setDisplayvalueAttr:function(_5){if(_5==""||_5==null){dojo.attr(this.contact_display,"innerHTML",this.placeHolder);dojo.addClass(this.contact_display,"PlaceHolder");dojo.addClass(this.clearbtn.domNode,"prmaxhidden");dojo.addClass(this.infobtn.domNode,"prmaxhidden");}else{dojo.attr(this.contact_display,"innerHTML",_5);dojo.removeClass(this.contact_display,"PlaceHolder");dojo.removeClass(this.clearbtn.domNode,"prmaxhidden");dojo.removeClass(this.infobtn.domNode,"prmaxhidden");}},_getValueAttr:function(){return this._contactid;},_clear:function(){this.clear();},_load_contact_details:function(){this.selectdetails_ctrl.set("dialog",this.employeeid.value);this.selectdetails_ctrl.load(this.selectdetails_dlg,this.employeeid.value);this.selectdetails_dlg.show();},_set_view:function(){if(this.mode=="info"){dojo.addClass(this.selectbtn.domNode,"prmaxhidden");dojo.addClass(this.clearbtn.domNode,"prmaxhidden");dojo.removeClass(this.infobtn.domNode,"prmaxhidden");}else{if(this._contactid==null){dojo.removeClass(this.clearbtn.domNode,"prmaxhidden");dojo.addClass(this.infobtn.domNode,"prmaxhidden");dojo.addClass(this.contact_display,"PlaceHolder");}else{dojo.removeClass(this.clearbtn.domNode,"prmaxhidden");dojo.removeClass(this.infobtn.domNode,"prmaxhidden");dojo.removeClass(this.contact_display,"PlaceHolder");}}},_select:function(){},clear:function(){this._clear();},clear:function(){this._contactid=null;dojo.attr(this.contact_display,"innerHTML",this.placeHolder);this._set_view();},_close:function(){this.select_dlg.hide();},_get_form:function(){},_search:function(){},refresh:function(){},_clear_search:function(){},_clear_search_results:function(){},_search_update_event:function(){},_select_contact:function(){this.person_select_dlg.start_search(this._on_select_contact_call_back);},_on_select_contact:function(_6,_7,_8,_9){this.outletid.set("value",_7);this.employeeid.set("value",_6);var _a={};_a["outletid"]=_7;_a["employeeid"]=_6;var _b=_8;if(_9!=""){_b+="<br /><br />"+_9;}dojo.attr(this.contact_display,"innerHTML",_b);dojo.removeClass(this.clearbtn.domNode,"prmaxhidden");dojo.removeClass(this.infobtn.domNode,"prmaxhidden");dojo.publish("/crm/update_person",[_a]);},});}