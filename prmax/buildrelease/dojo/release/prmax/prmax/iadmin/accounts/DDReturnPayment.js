/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prmax.iadmin.accounts.DDReturnPayment"]){dojo._hasResource["prmax.iadmin.accounts.DDReturnPayment"]=true;dojo.provide("prmax.iadmin.accounts.DDReturnPayment");dojo.require("ttl.BaseWidget");dojo.declare("prmax.iadmin.accounts.DDReturnPayment",[ttl.BaseWidget],{widgetsInTemplate:true,templateString:"<div>\r\n\t<form dojoAttachPoint=\"form\"  onsubmit=\"return false\" dojoType=\"dijit.form.Form\">\r\n\t\t<input type=\"hidden\" name=\"icustomerid\" dojoAttachPoint=\"icustomerid\" dojoType=\"dijit.form.TextBox\">\r\n\t\t<table width=\"700px\" cellpadding=\"0\" cellpadding=\"0\" >\r\n\t\t\t<tr><td colspan=\"2\"><div class=\"prmaxrowdisplaylarge\" style=\"text-align:center;display:inline\">Reject Last DD for </div><div class=\"prmaxrowdisplaylarge\" style=\"display:inline\" dojoAttachPoint=\"customername\"></div></td>\r\n\t\t\t<tr><td class=\"prmaxrowlabel\" align=\"right\">Reason Code</td><td><select class=\"prmaxinput\" name=\"paymentreturnreasonid\" dojoAttachPoint=\"paymentreturnreasonid\" style=\"width:10em\" dojoType=\"dijit.form.FilteringSelect\" autoComplete=\"true\"></select></td></tr>\r\n\t\t\t<tr><td class=\"prmaxrowlabel\" align=\"right\" valign=\"top\">Reason</td><td><div class=\"dialogprofileframe\" ><textarea dojoAttachPoint=\"reason\" name=\"reason\" class=\"dijitTextarea\" dojoType=\"dijit.form.Textarea\"  style=\"width:99%;height:99%\" ></textarea></div></td></tr>\r\n\t\t\t<tr><td class=\"prmaxrowlabel\" colspan=\"4\" align=\"right\"><button dojoType=\"dojox.form.BusyButton\" busyLabel=\"Please Wait\" type=\"button\" dojoAttachEvent=\"onClick:_CancelPayment\" dojoAttachPoint=\"okbtn\">Cancel DD Payment</button></td>\r\n\t\t</table>\r\n\t</form>\r\n\r\n</div>\r\n",constructor:function(){this._FailedCallBack=dojo.hitch(this,this._FailedCall);this.paymentreturnreasons=new dojo.data.ItemFileReadStore({url:"/common/lookups?searchtype=paymentreturnreasons",onError:ttl.utilities.globalerrorchecker,clearOnClose:true,urlPreventCache:true});},postCreate:function(){this.inherited(arguments);this.paymentreturnreasonid.store=this.paymentreturnreasons;this.paymentreturnreasonid.set("value",1);this.inherited(arguments);},_Clear:function(){this.icustomerid.set("value",null);this.reason.set("value","");this.okbtn.cancel();},_FailedCall:function(_1){if(_1.success=="OK"){alert("DD cancelled");this._Clear();this._dialog.hide();}else{alert("Problem Failing Last DD");}this.okbtn.cancel();},_CancelPayment:function(){if(confirm("Fail Last DD Payment")){var _2=this.form.get("value");dojo.xhrPost(ttl.utilities.makeParams({load:dojo.hitch(this,this._FailedCallBack),url:"/iadmin/payment_dd_failed",content:_2}));}else{this.okbtn.cancel();}},setCustomer:function(_3,_4,_5,_6){this.okbtn.cancel();this.icustomerid.set("value",_3);this._email=_5;dojo.attr(this.customername,"innerHTML",_4);this._dialog=_6;}});}