/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prmax.iadmin.support.FrontScreen"]){dojo._hasResource["prmax.iadmin.support.FrontScreen"]=true;dojo.provide("prmax.iadmin.support.FrontScreen");dojo.require("ttl.BaseWidget");dojo.declare("prmax.iadmin.support.FrontScreen",[ttl.BaseWidget],{widgetsInTemplate:true,templateString:"<div>\r\n\t<table class=\"prmaxtable\" width=\"100%\">\r\n\t<tr><td class=\"prmaxrowtag\" style=\"width:30%\">Customer</td><td width=\"70%\">\r\n\t\t<select dojoAttachPoint=\"customer_front_id\"\r\n\t\t\t\t\t\t\tdojoAttachEvent=\"onChange:_LoadFrontPageChange\"\r\n\t\t\t\t\t\t\tautoComplete=\"true\"\r\n\t\t\t\t\t\t\tsearchAttr=\"customername\"\r\n\t\t\t\t\t\t\tlabelAttr=\"customername\"\r\n\t\t\t\t\t\t\tdojoType=\"dijit.form.FilteringSelect\"\r\n\t\t\t\t\t\t\tlabelType=\"html\"></select>\r\n\t\t\t\t\t<button dojoType=dijit.form.Button dojoAttachEvent=\"onClick:_UpdateFrontScreen\" type=\"button\" name=\"submit\">Update Front Screen Message</button>\r\n\t\t\t\t\t<button dojoType=dijit.form.Button dojoAttachEvent=\"onClick:_PreviewFrontScreen\" type=\"button\" >Preview Update Front Screen Message</button>\r\n\t</td></tr>\r\n\t</table>\r\n\t<textarea dojoAttachPoint=\"front_page\" class=\"dijitTextarea\" dojoType=\"dijit.form.Textarea\"  style=\"width:100%;height:400px\"></textarea>\r\n</div>\r\n",constructor:function(){this._LoadFrontPageCall=dojo.hitch(this,this._LoadFrontPage);this._UpdateFrontPageResponseCall=dojo.hitch(this,this._UpdateFrontPageResponse);this.customer_front_id_data=new dojox.data.QueryReadStore({url:"/iadmin/customers_combo",onError:ttl.utilities.globalerrorchecker,clearOnClose:true,urlPreventCache:true});},postCreate:function(){this.inherited(arguments);this.customer_front_id.store=this.customer_front_id_data;this.customer_front_id.set("value","-1");this._GetFrontPage(-1);},_UpdateFrontScreen:function(){if(confirm("Update Front Screen")){dojo.xhrPost(ttl.utilities.makeParams({load:dojo.hitch(this,this._UpdateFrontPageResponseCall),url:"/iadmin/update_front_page",content:{"icustomerid":this.customer_front_id.get("value"),info:this.front_page.get("value")}}));}},_UpdateFrontPageResponse:function(_1){if(_1.success=="OK"){alert("Front Page Updated");}else{alert("Problem Updating front page");}},_GetFrontPage:function(_2){dojo.xhrPost(ttl.utilities.makeParams({load:dojo.hitch(this,this._LoadFrontPageCall),url:"/iadmin/get_front_page",content:{"icustomerid":_2}}));},_LoadFrontPageChange:function(){if(this.front_customerid!=arguments[0]){this.front_customerid=arguments[0];this._GetFrontPage(this.front_customerid);}},_PreviewFrontScreen:function(){},_LoadFrontPage:function(_3){if(_3.success=="OK"){this.front_page.set("value",_3.info);}else{alert("Problem Loading Front Page");}}});}