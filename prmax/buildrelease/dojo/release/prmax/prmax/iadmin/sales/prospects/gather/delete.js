/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prmax.iadmin.sales.prospects.gather.delete"]){dojo._hasResource["prmax.iadmin.sales.prospects.gather.delete"]=true;dojo.provide("prmax.iadmin.sales.prospects.gather.delete");dojo.require("ttl.BaseWidget");dojo.require("dojox.validate.regexp");dojo.require("dijit.form.ValidationTextBox");dojo.require("dijit.form.TextBox");dojo.require("dijit.form.FilteringSelect");dojo.require("dijit.form.Button");dojo.require("dojox.form.BusyButton");dojo.require("dijit.Dialog");dojo.require("dijit.form.RadioButton");dojo.require("dojo.data.ItemFileReadStore");dojo.declare("prmax.iadmin.sales.prospects.gather.delete",[ttl.BaseWidget],{templateString:dojo.cache("prmax","iadmin/sales/prospects/gather/templates/delete.html","<div>\r\n\t<br/>\r\n\t<form data-dojo-attach-point=\"form\" data-dojo-props='onsubmit:\"return false\"' data-dojo-type=\"dijit.form.Form\">\r\n\t\t<input data-dojo-attach-point=\"prospectid\" data-dojo-props='type:\"hidden\",name:\"prospectid\"', data-dojo-type=\"dijit.form.TextBox\" ></input>\r\n\t\t<table width=\"600px\" cellpadding=\"0\" cellpadding=\"0\" >\r\n\t\t\t<tr><td colspan=\"2\" class=\"prmaxHeadingStyle\" data-dojo-attach-point=\"title\"></td></tr>\r\n\t\t\t<tr><td><br/></td></tr>\r\n\t\t\t<tr><td class=\"prmaxrowtag\" align=\"right\" width=\"60px\" >Reason</td><td><select data-dojo-props='searchAttr:\"name\",required:true,\"class\":\"prmaxinput\",name:\"unsubscribereasonid\",style:\"width:19em\",autoComplete:true' data-dojo-attach-point=\"unsubscribereasonid\" data-dojo-type=\"dijit.form.FilteringSelect\" ></select></td></tr>\r\n\t\t\t<tr><td><br/></td></tr>\r\n\t\t\t<tr><td class=\"prmaxrowtag\" align=\"right\" valign=\"top\">Action</td><td>\r\n\t\t\t<input data-dojo-props='\"class\":\"prmaxlabeltag\",type:\"radio\",name:\"deleteoption\",value:\"0\",checked:\"checked\"' data-dojo-type=\"dijit.form.RadioButton\" /><label data-dojo-attach-point=\"deletoption_0\">Archive</label><br/>\r\n\t\t\t<input data-dojo-props='\"class\":\"prmaxlabeltag\",type:\"radio\",name:\"deleteoption\",value:\"1\"' data-dojo-type=\"dijit.form.RadioButton\" /><label data-dojo-attach-point=\"deletoption_1\">Unsubscribe</label><br/><br/>\r\n\t\t\t</td></tr>\r\n\t\t\t<tr>\r\n\t\t\t\t<td class=\"prmaxrowtag\"><button data-dojo-type=\"dijit.form.Button\" data-dojo-attach-point=\"closebtn\" data-dojo-props='type:\"button\"' data-dojo-attach-event=\"onClick:_close\">Close</button></td>\r\n\t\t\t\t<td class=\"prmaxrowtag\" align=\"right\"><button data-dojo-type=\"dojox.form.BusyButton\" data-dojo-attach-point=\"addbtn\" data-dojo-props='busyLabel:\"Saving ...\",type:\"button\"' data-dojo-attach-event=\"onClick:_update\">Remove</button></td>\r\n\t\t\t</tr>\r\n\t\t</table>\r\n\t</form>\r\n</div>\r\n"),constructor:function(){this._dialog=null;this._update_call_back=dojo.hitch(this,this._update_call);this._unsubscribereason=new dojo.data.ItemFileReadStore({url:"/common/lookups?searchtype=unsubscribereason"});},postCreate:function(){this.inherited(arguments);this.unsubscribereasonid.set("store",this._unsubscribereason);},_close:function(){this._dialog.hide();},_update:function(){if(ttl.utilities.formValidator(this.form)==false){alert("Please Enter Details");this.addbtn.cancel();return false;}dojo.xhrPost(ttl.utilities.makeParams({load:this._update_call_back,url:"/iadmin/prospects/prospect/delete_prospect",content:this.form.get("value")}));},_update_call:function(_1){if(_1.success=="OK"){dojo.publish("/prospect/prospect/delete",[_1.data]);alert("Prospect Deleted");this._close();this.clear();}else{alert("Problem Deleting Prospect");}this.addbtn.cancel();},load:function(_2,_3,_4){this._dialog=_3;dojo.attr(this.title,"innerHTML",_4);this.clear();this.prospectid.set("value",_2);},clear:function(){this.addbtn.cancel();this.prospectid.set("value",-1);}});}