/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prmax.iadmin.sales.prospects.companies.view"]){dojo._hasResource["prmax.iadmin.sales.prospects.companies.view"]=true;dojo.provide("prmax.iadmin.sales.prospects.companies.view");dojo.require("ttl.BaseWidget");dojo.require("dijit.layout.ContentPane");dojo.require("dijit.layout.BorderContainer");dojo.require("dijit.Toolbar");dojo.require("dijit.form.Button");dojo.require("dijit.layout.ContentPane");dojo.require("dojox.grid.DataGrid");dojo.require("prmax.iadmin.sales.prospects.companies.add");dojo.declare("prmax.iadmin.sales.prospects.companies.view",[ttl.BaseWidget,dijit.layout.BorderContainer],{widgetsInTemplate:true,templateString:dojo.cache("prmax","iadmin/sales/prospects/companies/templates/view.html","<div>\r\n\t<div data-dojo-type=\"dijit.layout.ContentPane\" data-dojo-attach-point=\"controls\" data-dojo-props='region:\"top\",style:\"height:45px;width:100%;overflow:hidden\"'>\r\n\t\t<div data-dojo-type=\"dijit.Toolbar\" data-dojo-props='style:\"height:99%;width:100%;padding:0px;margin:0px\"'>\r\n\t\t\t<div data-dojo-attach-event=\"onClick:_add\" data-dojo-type=\"dijit.form.Button\" data-dojo-props='iconClass:\"PRMaxStdIcon PRMaxAddIcon\",showLabel:true'><span>Add</span></div>\r\n\t\t</div>\r\n\t</div>\r\n\t<div data-dojo-type=\"dijit.layout.ContentPane\" data-dojo-props='region:\"center\"'>\r\n\t\t<div data-dojo-attach-point=\"result_grid\" data-dojo-type=\"dojox.grid.DataGrid\" data-dojo-props='style:\"height:100%;width:100%\",rowsPerPage:50'></div>\r\n\t</div>\r\n\t<div data-dojo-type=\"dijit.Dialog\" data-dojo-props='title:\"Add New Company\"' data-dojo-attach-point=\"adddialog\">\r\n\t\t<div data-dojo-attach-point=\"addctrl\" data-dojo-type=\"prmax.iadmin.sales.prospects.companies.add\" ></div>\r\n\t</div>\r\n\t<div data-dojo-type=\"dijit.Dialog\" data-dojo-props='title:\"rename Company\"' data-dojo-attach-point=\"editdialog\">\r\n\t\t<div data-dojo-attach-point=\"editctrl\" data-dojo-type=\"prmax.iadmin.sales.prospects.companies.add\" data-dojo-props='url:\"/iadmin/prospects/companies/update_company\"'></div>\r\n\t</div>\r\n\r\n</div>\r\n"),constructor:function(){this._store=new dojox.data.JsonRestStore({target:"/iadmin/prospects/companies/list",idAttribute:"prospectcompanyid"});dojo.subscribe("/prospect/comp/add",dojo.hitch(this,this._add_event));},_add_event:function(_1){this._store.newItem(_1);},clear:function(){},postCreate:function(){this.result_grid.set("structure",this.view);this.result_grid._setStore(this._store);this.result_grid.onStyleRow=dojo.hitch(this,ttl.GridHelpers.onStyleRow);this.result_grid.onRowClick=dojo.hitch(this,this._on_select_row);this.inherited(arguments);},_on_select_row:function(e){this._row=this.result_grid.getItem(e.rowIndex);this.result_grid.selection.clickSelectEvent(e);},view:{cells:[[{name:" ",width:"12px",field:"",formatter:ttl.utilities.formatRowCtrl},{name:"Company",width:"400px",field:"prospectcompanyname"}]]},_add:function(){this.addctrl.load(this.adddialog);this.adddialog.show();}});}