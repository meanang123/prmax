/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prmax.iadmin.PrmaxDataSets"]){dojo._hasResource["prmax.iadmin.PrmaxDataSets"]=true;dojo.provide("prmax.iadmin.PrmaxDataSets");dojo.require("ttl.BaseWidget");dojo.require("dojox.data.JsonRestStore");_data_set_selected=function(_1){var _2=_1?"checked.gif":"unchecked.gif";return "<img  height=\"10px\" width=\"10px\" style=\"padding:0x;margin:0px\" src=\"/static/images/"+_2+"\" ></img>";};dojo.declare("prmax.iadmin.PrmaxDataSets",[ttl.BaseWidget],{templateString:"<div>\r\n\t<div  dojoAttachPoint=\"borderControl\" dojotype=\"dijit.layout.BorderContainer\" gutters=\"false\"  style=\"width:100%;height:100%;overflow: hidden; border: 0; padding: 0; margin: 0\" >\r\n\t\t<div dojoAttachPoint=\"datasetsgrid\" dojoType=\"dojox.grid.DataGrid\" query=\"{ name:'*'}\" rowsPerPage=\"50\" region=\"center\"></div>\r\n\t</div>\r\n</div>\r\n",constructor:function(){this._datasets=new dojox.data.JsonRestStore({target:"/iadmin/customer_data_sets",idAttribute:"prmaxdatasetid"});this._update_data_set_call_back=dojo.hitch(this,this._update_data_set_call);this._has_international_data=false;},postCreate:function(){this.inherited(arguments);this.datasetsgrid.set("structure",this.view);this.datasetsgrid._setStore(this._datasets);this.datasetsgrid["onRowClick"]=dojo.hitch(this,this._on_row_select);},_on_row_select:function(e){if(this._has_international_data==true){this._row=this.datasetsgrid.getItem(e.rowIndex);var _3="Remove Data Set "+this._row.prmaxdatasetdescription+" ?";if(this._row.customerprmaxdatasetid==null){_3=null;}if(_3==null||confirm(_3)==true){dojo.xhrPost(ttl.utilities.makeParams({load:this._update_data_set_call_back,url:"/iadmin/customer_data_set_update",content:{"icustomerid":this._customerid,customerprmaxdatasetid:this._row.customerprmaxdatasetid,prmaxdatasetid:this._row.prmaxdatasetid}}));}}else{alert("International Data Disabled");}},_update_data_set_call:function(_4){if(_4.success=="OK"){this._datasets.setValue(this._row,"customerprmaxdatasetid",_4.data.customerprmaxdatasetid);}else{alert("Problem Updating");}},resize:function(){this.inherited(arguments);this.borderControl.resize(arguments[0]);},view:{noscroll:false,cells:[[{name:"Selected",width:"5em",field:"customerprmaxdatasetid",formatter:_data_set_selected},{name:"Data Set",width:"auto",field:"prmaxdatasetdescription"}]]},load:function(_5,_6){if(_5!=null){this._customerid=_5;this.datasetsgrid.setQuery(dojo.mixin(ttl.utilities.getPreventCache(),{icustomerid:_5}));}this._has_international_data=_6;}});}