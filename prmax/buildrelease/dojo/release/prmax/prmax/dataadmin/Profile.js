/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prmax.dataadmin.Profile"]){dojo._hasResource["prmax.dataadmin.Profile"]=true;dojo.provide("prmax.dataadmin.Profile");dojo.declare("prmax.dataadmin.Profile",[ttl.BaseWidget],{widgetsInTemplate:true,templateString:"<div>\r\n\t<form  dojotype=\"dijit.form.Form\" dojoAttachPoint=\"form\" onsubmit=\"return false;\">\r\n\t\t<input type=\"hidden\" name=\"objecttypeid\" value=\"-1\" dojoType=\"dijit.form.TextBox\" dojoAttachPoint=\"objecttypeid\">\r\n\t\t<input type=\"hidden\" name=\"objectid\" value=\"-1\" dojoType=\"dijit.form.TextBox\" dojoAttachPoint=\"objectid\">\r\n\t\t<div  dojoAttachPoint=\"borderControl\" dojotype=\"dijit.layout.BorderContainer\"  style=\"width:100%;height:100%;overflow: hidden; border: 0; padding: 0; margin: 0\" >\r\n\t\t\t<div dojotype=\"dijit.layout.ContentPane\"   style=\"width:100%padding-left:5px\" region=\"center\"  >\r\n\t\t\t\t<div class=\"stdframe\" style=\"height:500px\">\r\n\t\t\t\t\t<textarea dojoAttachPoint=\"profile\"  name=\"profile\" dojoType=\"dijit.form.Textarea\"  style=\"height:500px\"></textarea>\r\n\t\t\t\t</div>\r\n\t\t\t\t<table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\" width=\"20%\">Code</td><td ><select dojoAttachPoint=\"reasoncodeid\" name=\"reasoncodeid\" dojotype =\"dijit.form.FilteringSelect\" searchAttr=\"name\" labelType=\"html\" style=\"width:98%\" class=\"prmaxrequired\"  /></td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\" valign=\"top\">Description</td><td ><div class=\"reasonframe\" ><textarea dojoAttachPoint=\"reason\" name=\"reason\" required=\"true\" dojoType=\"dijit.form.Textarea\" style=\"width:99%;height:80%\"  ></textarea></div></td></tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t\t<div dojotype=\"dijit.layout.ContentPane\"  region=\"bottom\"  style=\"width:100%;height:3em;padding-right:3px;\">\r\n\t\t\t\t<table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\r\n\t\t\t\t\t<tr><td align=\"right\"><button type=\"button\" dojoAttachEvent=\"onClick:_Update\" dojoType=\"dijit.form.Button\" label=\"Update Profile\"></button></td></tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</form>\r\n</div>\r\n",constructor:function(){this._UpdateProfileCallBack=dojo.hitch(this,this._UpdateProfileCall);},postCreate:function(){this.reasoncodeid.store=PRCOMMON.utils.stores.Research_Reason_Update_Codes();this.reasoncodeid.set("value",PRCOMMON.utils.stores.Reason_Upd_Default);this.inherited(arguments);},resize:function(){this.borderControl.resize(arguments[0]);this.profile.resize(arguments[0]);},Load:function(_1,_2,_3){this._ClearReason();this._objectid=_1;this._objecttypeid=_2;this.profile.set("value",_3);},_ClearReason:function(){this.reasoncodeid.set("value",PRCOMMON.utils.stores.Reason_Upd_Default);this.reason.set("value","");},Clear:function(){this._objectid=null;this._objecttypeid=null;this.profile.set("value","");this._ClearReason();},_UpdateProfileCall:function(_4){if(_4.success=="OK"){alert("Profile Updated");this._ClearReason();}else{alert("Failed to update profile");}},_Update:function(){if(ttl.utilities.formValidator(this.form)==false){alert("Not all required field filled in");return;}var _5=this.form.get("value");_5["objectid"]=this._objectid;_5["objecttypeid"]=this._objecttypeid;dojo.xhrPost(ttl.utilities.makeParams({load:this._UpdateProfileCallBack,url:"/outlets/research_profile",content:_5}));}});}