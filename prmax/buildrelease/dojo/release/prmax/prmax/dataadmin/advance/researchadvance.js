/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prmax.dataadmin.advance.researchadvance"]){dojo._hasResource["prmax.dataadmin.advance.researchadvance"]=true;dojo.provide("prmax.dataadmin.advance.researchadvance");dojo.require("ttl.BaseWidget");dojo.require("prcommon.date.DateExtended");dojo.declare("prmax.dataadmin.advance.researchadvance",[ttl.BaseWidget],{widgetsInTemplate:true,templateString:"<div>\r\n\t<div dojoAttachPoint=\"frame\" dojotype=\"dijit.layout.BorderContainer\"  style=\"width:100%;height:99%\" gutters=\"false\" >\r\n\t\t<div dojotype=\"dijit.layout.ContentPane\" region=\"center\">\r\n\t\t\t<form  dojotype=\"dijit.form.Form\" dojoAttachPoint=\"form\" onsubmit=\"return false;\">\r\n\t\t\t\t<input type=\"hidden\" name=\"outletid\" value=\"-1\" dojoType=\"dijit.form.TextBox\" dojoAttachPoint=\"outletid\">\r\n\t\t\t\t<table style=\"width:100%;border-style:collapsed\" cellpadding=\"0\" cellspacing=\"0\">\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\" width=\"120px\">Outlet Status</td><td><select name=\"advancefeaturestatusid\" dojoAttachPoint=\"advancefeaturestatusid\" autoComplete=\"true\" searchAttr=\"name\" labelAttr=\"name\" dojoType=\"dijit.form.FilteringSelect\" pageSize=\"20\" required=\"true\" labelType=\"html\">/select></td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">Research Date</td><td>\r\n\t\t\t\t\t<input type=\"text\"  dojoAttachPoint=\"advance_last_contact\" name = \"advance_last_contact\" required=\"true\" dojoType=\"dijit.form.DateTextBox\" style=\"width:10em\" ></td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">url</td><td><input dojoAttachPoint=\"advance_url\" class=\"prmaxinput\" name=\"advance_url\" type=\"text\" maxlength=\"120\" dojoType=\"dijit.form.ValidationTextBox\" regExpGen=\"dojox.validate.regexp.url\" style=\"width:98%\"/></td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">Research Info</td><td>&nbsp;\t</td></tr>\r\n\t\t\t\t\t<tr><td colspan=\"2\"><div class=\"stdframe\" style=\"height:300px\"><textarea dojoAttachPoint=\"advance_notes\"  name=\"advance_notes\" dojoType=\"dijit.form.Textarea\"  style=\"height:300px;width:99%\"></textarea></div></td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" colspan=\"2\"><button  type=\"button\" class=\"prmaxbutton\" iconClass=\"dijitPrmaxIcon\" dojoAttachPoint=\"saveNode\" dojoType=\"dojox.form.BusyButton\" busyLabel=\"Please Wait Saving...\" dojoAttachEvent=\"onClick:_Save\" label=\"Save\"></button></td></tr>\r\n\t\t\t\t</table>\r\n\t\t\t</form>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n",constructor:function(){this.inherited(arguments);this._SaveCallBack=dojo.hitch(this,this._SaveCall);this._LoadCallBack=dojo.hitch(this,this._LoadCall);this._advancefeaturestatusid=new dojo.data.ItemFileReadStore({url:"/common/lookups?searchtype=advancefeaturestatus"});},postCreate:function(){this.advancefeaturestatusid.store=this._advancefeaturestatusid;this.inherited(arguments);},_SaveCall:function(_1){if(_1.success=="OK"){alert("Research Details Updated");}else{alert("Problem saving Research Details");}this.saveNode.cancel();},_Save:function(){if(ttl.utilities.formValidator(this.form)==false){alert("Not all required field filled in");this.saveNode.cancel();return;}var d=this.advance_last_contact.get("value");var _2=this.form.get("value");_2["advance_last_contact"]=d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate();dojo.xhrPost(ttl.utilities.makeParams({load:this._SaveCallBack,url:"/advance/research_details_save",content:_2}));},resize:function(){this.frame.resize(arguments[0]);this.inherited(arguments);},Load:function(_3){this.outletid.set("value",_3);dojo.xhrPost(ttl.utilities.makeParams({load:this._LoadCallBack,url:"/advance/getResearchExt",content:{outletid:_3}}));},_LoadCall:function(_4){if(_4.success=="OK"){this.advance_last_contact.set("value",new Date(_4.data.advance_last_contact.year,_4.data.advance_last_contact.month-1,_4.data.advance_last_contact.day));this.advance_url.set("value",_4.data.advance_url);this.advance_notes.set("value",_4.data.advance_notes);this.advancefeaturestatusid.set("value",_4.data.advancefeaturestatusid);}else{alert("Problem Loading Research Details");}}});}