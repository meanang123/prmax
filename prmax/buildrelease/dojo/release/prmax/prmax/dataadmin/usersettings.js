/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prmax.dataadmin.usersettings"]){dojo._hasResource["prmax.dataadmin.usersettings"]=true;dojo.provide("prmax.dataadmin.usersettings");dojo.declare("prmax.dataadmin.usersettings",[ttl.BaseWidget],{widgetsInTemplate:true,templateString:"<div>\r\n\t<form  dojotype=\"dijit.form.Form\" dojoAttachPoint=\"form\" onsubmit=\"return false;\">\r\n\t\t<table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\r\n\t\t\t<tr><td colspan=\"2\" class=\"prmaxrowdisplaylarge\">Researcher Setting</td></tr>\r\n\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">Display Name</td><td><input class=\"prmaxrequired\" name=\"display_name\" type=\"text\" dojoAttachPoint=\"display_name\"  maxlength=\"80\" trim=\"true\" required=\"true\" dojoType=\"dijit.form.ValidationTextBox\" style=\"width:15em\"/></td></tr>\r\n\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">Job Title</td><td><input class=\"prmaxrequired\" name=\"job_title\" type=\"text\" dojoAttachPoint=\"job_title\"  maxlength=\"80\" trim=\"true\" required=\"true\" dojoType=\"dijit.form.ValidationTextBox\" style=\"width:15em\"/></td></tr>\r\n\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">Email</td><td ><input class=\"prmaxrequired\" name=\"email_address\" dojoAttachPoint=\"email_address\" type=\"text\" dojoType=\"dijit.form.ValidationTextBox\" regExpGen=\"dojox.validate.regexp.emailAddress\" trim=\"true\" invalidMessage=\"invalid email address\" style=\"width:25em\" maxlength=\"70\"></tr>\r\n\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">Tel</td><td><input class=\"prmaxrequired\" name=\"tel\" type=\"text\" dojoAttachPoint=\"tel\" size=\"25\" maxlength=\"40\" dojoType=\"dijit.form.TextBox\" style=\"width:15em\" required=\"true\"/></td></tr>\r\n\t\t\t<tr><td></td><td><button disabled=\"disabled\" dojoAttachEvent=\"onClick:_Update\" dojoAttachPoint=\"saveNode\" dojoType=\"dojox.form.BusyButton\" type=\"button\" busyLabel=\"Please Wait Saving...\" label=\"Save\"></button></td></tr>\r\n\t\t</table>\r\n\t</form>\r\n</div>\r\n",constructor:function(){this._LoadCallBack=dojo.hitch(this,this._LoadCall);this._UpdateCallBack=dojo.hitch(this,this._UpdateCall);},postCreate:function(){this.inherited(arguments);dojo.xhrPost(ttl.utilities.makeParams({load:this._LoadCallBack,url:"/user/research_get_settings"}));},_LoadCall:function(_1){if(_1.success=="OK"){this.display_name.set("value",_1.user.display_name);this.job_title.set("value",_1.user.job_title);this.email_address.set("value",_1.user.email_address);this.tel.set("value",_1.user.tel);this.saveNode.set("disabled",false);}else{alert("problem loading settings");}},_UpdateCall:function(_2){if(_2.success=="OK"){alert("Settings Updated");}else{if(_2.success=="DU"){alert("Email Address Already Exists");}else{alert("Problem Saving settings");}}this.saveNode.cancel();},_Update:function(){if(ttl.utilities.formValidator(this.form)==false){alert("Not all required field filled in");this.saveNode.cancel();return;}if(confirm("Update Settings?")){dojo.xhrPost(ttl.utilities.makeParams({load:this._UpdateCallBack,url:"/user/research_update_settings",content:this.form.get("value")}));}}});}