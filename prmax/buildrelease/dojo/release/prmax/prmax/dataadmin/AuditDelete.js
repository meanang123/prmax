/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prmax.dataadmin.AuditDelete"]){dojo._hasResource["prmax.dataadmin.AuditDelete"]=true;dojo.provide("prmax.dataadmin.AuditDelete");dojo.declare("prmax.dataadmin.AuditDelete",[ttl.BaseWidget],{widgetsInTemplate:true,objecttypeid:1,templateString:"<div>\r\n\t<div  dojoAttachPoint=\"borderControl\" dojotype=\"dijit.layout.BorderContainer\"  style=\"width:100%;height:100%;overflow: hidden; border: 0; padding: 0; margin: 0\" >\r\n\t\t<div dojotype=\"dijit.layout.ContentPane\" region=\"top\" style=\"width:100%;height:45px;\">\r\n\t\t\t<div style=\"height:40px;width:100%;overflow:hidden\" class=\"searchresults\">\r\n\t\t\t\t<div style=\"height:100%;width:15%;float:left;\" class=\"prmaxrowdisplaylarge\">View Audit Trail</div>\r\n\t\t\t\t<div style=\"float:left\" >\r\n\t\t\t\t\t<form dojoAttachPoint=\"filterform\"  onsubmit=\"return false\" dojoType=\"dijit.form.Form\">\r\n\t\t\t\t\t\t<input class=\"prmaxbutton\" type=\"text\"  dojoAttachPoint=\"filterdate\" name = \"filterdate\" dojoType=\"dijit.form.DateTextBox\" >\r\n\t\t\t\t\t\t<button class=\"prmaxbutton\"  type=\"submit\" dojoType=\"dijit.form.Button\" label=\"Filter By\" ></button>\r\n\t\t\t\t\t</form>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div  dojoType=\"dijit.layout.ContentPane\" region=\"center\"  splitter=\"true\" >\r\n\t\t\t<div dojoAttachPoint=\"result_grid\" dojoType=\"dojox.grid.DataGrid\" rowsPerPage=\"50\"></div>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n",constructor:function(){this.results=new dojox.data.QueryReadStore({url:"/dataadmin/audit_delete_trail"});},postCreate:function(){this.result_grid.set("structure",this.view);this.result_grid._setStore(this.results);this.filterdate.set("value",new Date());dojo.connect(this.filterform,"onSubmit",dojo.hitch(this,this._Filter));this.inherited(arguments);},view:{cells:[[{name:"Date",width:"100px",field:"activitydate"},{name:"Outlet Name",width:"auto",field:"name"},{name:"Action",width:"60px",field:"actiontypedescription"},{name:"Reason",width:"auto",field:"reasoncodedescription"},{name:"User",width:"auto",field:"display_name"},{name:"Reason Details",width:"auto",field:"reason"}]]},resize:function(){this.borderControl.resize(arguments[0]);this.inherited(arguments);},Load:function(_1){this.Clear();this._objectid=_1;},_Filter:function(){var d=this.filterdate.get("value");this.result_grid.setQuery(ttl.utilities.getPreventCache({filterdate:d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate(),objecttypeid:this.objecttypeid}));},Clear:function(){this.result_grid.setQuery(ttl.utilities.getPreventCache({}));}});}