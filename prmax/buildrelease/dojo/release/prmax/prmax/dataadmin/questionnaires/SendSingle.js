/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prmax.dataadmin.questionnaires.SendSingle"]){dojo._hasResource["prmax.dataadmin.questionnaires.SendSingle"]=true;dojo.provide("prmax.dataadmin.questionnaires.SendSingle");dojo.declare("prmax.dataadmin.questionnaires.SendSingle",[ttl.BaseWidget],{widgetsInTemplate:true,templateString:"<div>\r\n\t<form  dojotype=\"dijit.form.Form\" dojoAttachPoint=\"form\" onsubmit=\"return false;\">\r\n\t<input dojoAttachPoint=\"objecttypeid\" name=\"objecttypeid\" type=\"hidden\" dojoType=\"dijit.form.TextBox\">\r\n\t<input dojoAttachPoint=\"objectid\" name=\"objectid\" type=\"hidden\" dojoType=\"dijit.form.TextBox\">\r\n\t\t<table width=\"700px\" cellpadding=\"0\" cellspacing=\"0\">\r\n\t\t\t<tr><td  align=\"center\" dojoAttachPoint=\"heading\" class=\"prmaxrowdisplaylarge\" colspan=\"2\" ></td></tr>\r\n\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">To Name</td><td><input dojoAttachPoint=\"toname\" class=\"prmaxinput\" name=\"toname\" type=\"text\" dojoType=\"dijit.form.ValidationTextBox\" style=\"width:15em\" required=\"true\"></td></tr>\r\n\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">To Email</td><td><input dojoAttachPoint=\"toemail\" class=\"prmaxinput\" name=\"toemail\" type=\"text\" dojoType=\"dijit.form.ValidationTextBox\" regExpGen=\"dojox.validate.regexp.emailAddress\" trim=\"true\" invalidMessage=\"invalid email address\" size=\"20\" style=\"width:90%\" required=\"true\"></td></tr>\r\n\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">Subject</td><td><input dojoAttachPoint=\"subject\" class=\"prmaxinput\" name=\"subject\" type=\"text\" dojoType=\"dijit.form.ValidationTextBox\" trim=\"true\" style=\"width:90%\" required=\"true\"></td></tr>\r\n\t\t\t<tr><td align=\"right\" valign=\"top\" class=\"prmaxrowtag\">Body</td><td><div class=\"stdframe\" style=\"height:200px;overflow:hidden\"><textarea dojoAttachPoint=\"body\"  name=\"body\" dojoType=\"dijit.form.Textarea\"  style=\"height:300px\"></textarea></div></td></tr>\r\n\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\" >Reason</td><td ><select dojoAttachPoint=\"reasoncodeid\" name=\"reasoncodeid\" dojotype =\"dijit.form.FilteringSelect\" searchAttr=\"name\" labelType=\"html\" style=\"width:15em\" class=\"prmaxrequired\" /></td></tr>\r\n\t\t\t<tr><td align=\"left\"><button type=\"button\" dojoAttachEvent=\"onClick:_Close\" dojoType=\"dijit.form.Button\" label=\"Close\"></button></td>\r\n\t\t\t\t<td align=\"right\"><button dojoAttachPoint=\"sendemail\" type=\"button\" dojoAttachEvent=\"onClick:_Send\" dojoType=\"dojox.form.BusyButton\" busyLabel=\"Please Wait Sending...\" label=\"Send Email\"></button></td></tr>\r\n\t\t</table>\r\n\t</form>\r\n</div>\r\n",constructor:function(){this._SendCallBack=dojo.hitch(this,this._SendCall);},postCreate:function(){this.reasoncodeid.store=PRCOMMON.utils.stores.Research_Reason_Add_Codes();this.reasoncodeid.set("value",PRCOMMON.utils.stores.Reason_Add_Default);this.inherited(arguments);},_Send:function(){if(ttl.utilities.formValidator(this.form)==false){alert("Not all required fields filled in");this.sendemail.cancel();return;}dojo.xhrPost(ttl.utilities.makeParams({load:this._SendCallBack,url:"/dataadmin/send_questionnaire",content:this.form.get("value")}));},_SendCall:function(_1){if(_1.success=="OK"){alert("Questionnaire Sent");this._dialog.hide();}else{alert("Problem Sending Questionnaire");this.sendemail.cancel();}},_Close:function(){this._dialog.hide();},Load:function(_2,_3,_4,_5,_6){this._Clear();this.objecttypeid.set("value",_3);this.objectid.set("value",_2);this.toemail.set("value",_4);this.toname.set("value",_5);this._dialog=_6;this._dialog.show();},_Clear:function(){this.sendemail.cancel();this.objecttypeid.set("value",-1);this.objectid.set("value",-1);this.toname.set("value","");this.toemail.set("value","");this.subject.set("value","");this.body.set("value","");}});}