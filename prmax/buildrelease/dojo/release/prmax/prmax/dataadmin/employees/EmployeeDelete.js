/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prmax.dataadmin.employees.EmployeeDelete"]){dojo._hasResource["prmax.dataadmin.employees.EmployeeDelete"]=true;dojo.provide("prmax.dataadmin.employees.EmployeeDelete");dojo.declare("prmax.dataadmin.employees.EmployeeDelete",[prcommon.search.std_search,dijit._Widget,dijit._Templated,dijit._Container],{widgetsInTemplate:true,templateString:"<div style=\"width:400px\" >\r\n\t<form  class=\"prmaxdefault\" dojoAttachPoint=\"form\" dojoType=\"dijit.form.Form\" onsubmit=\"return false;\">\r\n\t\t<input dojoAttachPoint=\"employeeid\" name=\"employeeid\" type=\"hidden\" dojoType=\"dijit.form.TextBox\" >\r\n\t\t<table width=\"100%\" class=\"prmaxtable\" cellpadding=\"0\" cellspacing=\"0\"  border =\"0\">\r\n\t\t\t<tr><td  align=\"center\" dojoAttachPoint=\"heading\" class=\"prmaxrowdisplaylarge\" colspan=\"2\" dojoAttachPoint=\"header\" ></td></tr>\r\n\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\" width=\"20%\">Reason</td><td >\r\n\t\t\t<select dojoAttachPoint=\"reasoncodes\" name=\"reasoncodeid\" dojotype =\"dijit.form.FilteringSelect\" searchAttr=\"name\" labelType=\"html\" style=\"width:98%\" class=\"prmaxrequired\"/>\r\n\t\t\t</td></tr>\r\n\t\t\t<tr><td  align=\"right\" class=\"prmaxrowtag\" valign=\"top\">Description</td><td  ><div class=\"reasonframe\" ><textarea dojoAttachPoint=\"reason\" name=\"reason\" class=\"prmaxrowtag\" required=\"true\" dojoType=\"dijit.form.Textarea\" style=\"width:99%;height:80%;\"></textarea></div></td></tr>\r\n\t\t\t<tr><td colspan=\"2\">&nbsp;</td></tr>\r\n\t\t\t<tr><td colspan=\"2\" align=\"right\"><button dojoType=\"dijit.form.Button\" type=\"submit\" name=\"submit\">Delete Contact</button></td></tr>\r\n\t\t</table>\r\n\t</form>\r\n</div>\r\n",constructor:function(){this._DeletedContactCallBack=dojo.hitch(this,this._DeletedContactCall);},postCreate:function(){this.reasoncodes.store=PRCOMMON.utils.stores.Research_Reason_Del_Codes();dojo.connect(this.form,"onSubmit",dojo.hitch(this,this._DeleteSubmit));this.inherited(arguments);},_DeleteSubmit:function(){if(ttl.utilities.formValidator(this.form)==false){alert("Not all required fields filled in");return;}if(this.reason.get("value").length==0){alert("No Description Given");this.reason.focus();return;}if(confirm("Delete "+dojo.attr(this.heading,"innerHTML")+" ?")){dojo.xhrPost(ttl.utilities.makeParams({load:this._DeletedContactCallBack,url:"/employees/research_employee_delete",content:this.form.get("value")}));}},_DeletedContactCall:function(_1){if(_1.success=="OK"){dojo.publish(PRCOMMON.Events.Employee_Deleted,[_1.data.employee]);alert("Contact Deleted");this.Clear();dojo.publish(PRCOMMON.Events.Dialog_Close,["emp_del"]);}else{alert("Problem Deleteing Contact");}},Clear:function(){this.employeeid.set("value",-1);this.reasoncodes.set("value",null);this.reason.set("value","");},Load:function(_2,_3,_4){this.employeeid.set("value",_2);dojo.attr(this.heading,"innerHTML",_3+"("+_4+")");this.reasoncodes.set("value",null);this.reason.focus();},focus:function(){this.reason.focus();}});}