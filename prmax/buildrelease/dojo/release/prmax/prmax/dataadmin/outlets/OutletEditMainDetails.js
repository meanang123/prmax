/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prmax.dataadmin.outlets.OutletEditMainDetails"]){dojo._hasResource["prmax.dataadmin.outlets.OutletEditMainDetails"]=true;dojo.provide("prmax.dataadmin.outlets.OutletEditMainDetails");dojo.declare("prmax.dataadmin.outlets.OutletEditMainDetails",[ttl.BaseWidget],{widgetsInTemplate:true,templateString:"<div dojoAttachPoint=\"container\" >\r\n\t<div dojoAttachPoint=\"borderControl\" dojotype=\"dijit.layout.BorderContainer\"  gutters=\"false\">\r\n\t\t<div dojotype=\"dijit.layout.ContentPane\" style=\"overflow:auto;overflow-x:hidden\" region=\"center\" >\r\n\t\t\t<form  dojotype=\"dijit.form.Form\" dojoAttachPoint=\"form\" onsubmit=\"return false;\">\r\n\t\t\t\t<input type=\"hidden\" name=\"outletid\" value=\"-1\" dojoType=\"dijit.form.TextBox\" dojoAttachPoint=\"outletid\">\r\n\t\t\t\t<input type=\"hidden\" name=\"searchtypeid\" value=\"3\" dojoType=\"dijit.form.TextBox\" >\r\n\t\t\t\t<table width=\"98%\" cellspacing=\"0\" cellpadding=\"0\">\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\" width=\"20%\">Outlets Name</td><td><input style=\"width:90%\"  dojoAttachPoint=\"outletname\" class=\"prmaxrequired\"  name=\"outletname\" type=\"text\" trim=\"true\" required=\"true\" invalidMessage=\"Please enter outletname\" dojoType=\"dijit.form.ValidationTextBox\" ></input></td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">Country</td><td><select style=\"width:90%\" class=\"prmaxrequired\" name=\"countryid\" autoComplete=\"true\" searchAttr=\"name\" dojoType=\"dijit.form.FilteringSelect\" required=\"true\" invalidMessage=\"Please select Country Name\" labelType=\"html\" dojoAttachPoint=\"countryid\"></select></td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">Media Channel</td><td class=\"prmaxrowdisplay\"><select style=\"width:90%\" class=\"prmaxrequired\" name=\"prmax_outlettypeid\" autoComplete=\"true\" searchAttr=\"name\" dojoType=\"dijit.form.FilteringSelect\" required=\"true\" invalidMessage=\"Please select outlet type\" labelType=\"html\"\tdojoAttachPoint=\"prmax_outlettypeid\"></select></td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">Address1</td><td><input dojoAttachPoint=\"address1\" class=\"prmaxrequired\"  name=\"address1\" type=\"text\" trim=\"true\" required=\"true\" invalidMessage=\"Please enter address\" dojoType=\"dijit.form.ValidationTextBox\" style=\"width:70%\"></input></td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">Address2</td><td><input dojoAttachPoint=\"address2\" class=\"prmaxinput\" name=\"address2\" type=\"text\" trim=\"true\" dojoType=\"dijit.form.ValidationTextBox\" style=\"width:70%\"></input></td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">Town</td><td><input dojoAttachPoint=\"townname\" class=\"prmaxinput\" name=\"townname\" type=\"text\" trim=\"true\" dojoType=\"dijit.form.ValidationTextBox\" style=\"width:70%\" ></input></td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">County</td><td><input dojoAttachPoint=\"county\" class=\"prmaxinput\" name=\"county\" type=\"text\" trim=\"true\" dojoType=\"dijit.form.ValidationTextBox\" style=\"width:70%\" ></input></td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">Post Code</td><td><input dojoAttachPoint=\"postcode\" class=\"prmaxinput\" name=\"postcode\" type=\"text\" trim=\"true\" dojoType=\"dijit.form.ValidationTextBox\" style=\"width:10em\" ></input></td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">Www</td><td><input dojoAttachPoint=\"www\" class=\"prmaxinput\" name=\"www\" type=\"text\" maxlength=\"120\" dojoType=\"dijit.form.ValidationTextBox\" regExpGen=\"dojox.validate.regexp.url\"  style=\"width:90%\" /></td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">Email</td><td><input dojoAttachPoint=\"email\" class=\"prmaxinput\" name=\"email\" dojoAttachPoint=\"Email\" type=\"text\" dojoType=\"dijit.form.ValidationTextBox\" regExpGen=\"dojox.validate.regexp.emailAddress\" trim=\"true\" invalidMessage=\"invalid email address\" size=\"20\" maxlength=\"70\" style=\"width:90%\"></td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">Tel</td><td><input dojoAttachPoint=\"tel\" class=\"prmaxinput\" name=\"tel\" type=\"text\" maxlength=\"40\" dojoType=\"dijit.form.ValidationTextBox\" trim=\"true\" style=\"width:60%\" /></td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">Fax</td><td><input dojoAttachPoint=\"fax\" class=\"prmaxinput\" name=\"fax\" type=\"text\" maxlength=\"40\" dojoType=\"dijit.form.ValidationTextBox\" trim=\"true\"  style=\"width:60%\"/></td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">Twitter</td><td><input dojoAttachPoint=\"twitter\" name=\"twitter\" dojoType=\"dijit.form.ValidationTextBox\" regExpGen=\"dojox.validate.regexp.url\" type=\"text\" maxlength=\"80\" trim=\"true\" style=\"width:70%\"/>\r\n\t\t\t\t\t<button data-dojo-type=\"dijit.form.Button\" data-dojo-props='type:\"button\",label:\"Update Media Only\",style:\"float:right\"' data-dojo-attach-event=\"onClick:_UpdateMediaOnly\" data-dojo-attach-point=\"socialmediabtn\"></button></td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">Facebook</td><td><input dojoAttachPoint=\"facebook\" class=\"prmaxinput\" name=\"facebook\" type=\"text\" maxlength=\"80\" dojoType=\"dijit.form.ValidationTextBox\" regExpGen=\"dojox.validate.regexp.url\"  trim=\"true\" style=\"width:90%\"/></td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">Linkedin</td><td><input dojoAttachPoint=\"linkedin\" class=\"prmaxinput\" name=\"linkedin\" type=\"text\" maxlength=\"80\" dojoType=\"dijit.form.ValidationTextBox\" regExpGen=\"dojox.validate.regexp.url\" regExpGen=\"dojox.validate.regexp.url\" trim=\"true\" style=\"width:90%\" /></td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">Instagram</td><td><input dojoAttachPoint=\"instagram\" class=\"prmaxinput\" name=\"instagram\" type=\"text\" maxlength=\"80\" dojoType=\"dijit.form.ValidationTextBox\" regExpGen=\"dojox.validate.regexp.url\" regExpGen=\"dojox.validate.regexp.url\" trim=\"true\" style=\"width:90%\" /></td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">Circulation</td><td><input dojoAttachPoint=\"circulation\" class=\"prmaxinput\" name=\"circulation\" type=\"text\" dojoType=\"dijit.form.NumberTextBox\" value=\"0\" constraints=\"{min:0,max:99999999}\" trim=\"true\"/></td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\">Frequency</td><td><select name=\"frequencyid\" class=\"prmaxrequired\" autoComplete=\"true\" searchAttr=\"name\" dojoType=\"dijit.form.FilteringSelect\" required=\"true\" invalidMessage=\"Please select frequency\" labelType=\"html\" dojoAttachPoint=\"frequency\"></select></td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\" valign=\"top\">Keywords</td><td ><div name=\"interests\" selectonly=\"true\" size=\"6\" displaytitle=\"\" startopen=\"\"  dojoAttachPoint=\"interests\" restrict=\"0\"  dojoType=\"prcommon.interests.Interests\" keytypeid=\"6\" title=\"Select\"></div></td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\" valign=\"top\">Geo. Coverage</td><td ><div name=\"coverage\" selectonly=\"true\" size=\"6\" displaytitle=\"\" startopen=\"\"  dojoAttachPoint=\"coverage\" dojoType=\"prmax.geographical.Geographical\"  title=\"Select\"></div></td></tr>\r\n\t\t\t\t\t<tr><td colspan=\"2\">&nbsp;</td></tr>\r\n\t\t\t\t\t<tr><td class=\"prmaxrowtag\" colspan=\"2\" >Reason </td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\" width=\"20%\">Code</td><td ><select dojoAttachPoint=\"reasoncodeid\" name=\"reasoncodeid\" dojotype =\"dijit.form.FilteringSelect\" searchAttr=\"name\" labelType=\"html\" style=\"width:98%\" class=\"prmaxrequired\"></select></td></tr>\r\n\t\t\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\" valign=\"top\">Description</td><td ><div class=\"reasonframe\" ><textarea dojoAttachPoint=\"reason\" name=\"reason\" required=\"true\" dojoType=\"dijit.form.Textarea\" style=\"width:99%;height:80%\"  ></textarea></div></td></tr>\r\n\t\t\t\t</table>\r\n\t\t\t</form>\r\n\t\t</div>\r\n\t\t<div dojotype=\"dijit.layout.ContentPane\"  region=\"bottom\"  style=\"width:100%;height:3em;padding-right:3px;\">\r\n\t\t\t<table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\r\n\t\t\t\t\t<tr><td align=\"left\"><button type=\"button\" dojoAttachEvent=\"onClick:_Delete\" dojoType=\"dijit.form.Button\" label=\"Delete Outlet\"></button></td>\r\n\t\t\t\t\t\t\t<td align=\"right\"><button dojoAttachPoint=\"updateBtn\" type=\"button\" dojoAttachEvent=\"onClick:_Update\" dojoType=\"dojox.form.BusyButton\" busyLabel=\"Please Wait Updating Outlet...\" label=\"Update Outlet\"></button></td></tr>\r\n\t\t\t</table>\r\n\t\t</div>\r\n\t</div>\r\n\t<div dojoAttachPoint=\"outlet_delete_dlg\" dojoType=\"dijit.Dialog\" title =\"Delete Outlet\">\r\n\t\t<div dojoAttachPoint=\"outlet_delete_ctrl\" dojoType=\"prmax.dataadmin.outlets.OutletDelete\"></div>\r\n\t</div>\r\n</div>\r\n",constructor:function(){this._UpdatedCallBack=dojo.hitch(this,this._UpdatedCall);this._MediaOnlyCallBack=dojo.hitch(this,this._MediaOnlyCall);dojo.subscribe(PRCOMMON.Events.Dialog_Close,dojo.hitch(this,this._DialogCloseEvent));},postCreate:function(){this.prmax_outlettypeid.store=PRCOMMON.utils.stores.OutletTypes();this.frequency.store=PRCOMMON.utils.stores.Frequency();this.reasoncodeid.store=PRCOMMON.utils.stores.Research_Reason_Update_Codes();this.reasoncodeid.set("value",PRCOMMON.utils.stores.Reason_Upd_Default);this.countryid.store=PRCOMMON.utils.stores.Countries();this.inherited(arguments);},_UpdatedCall:function(_1){if(_1.success=="OK"){alert("Updated");dojo.publish(PRCOMMON.Events.Outlet_Updated,[_1.data]);this._ClearReason();}else{alert("Failed to updated");}this.updateBtn.cancel();},Clear:function(){},_ClearReason:function(){this.reasoncodeid.set("value",PRCOMMON.utils.stores.Reason_Upd_Default);this.reason.set("value","");this.updateBtn.cancel();},Load:function(_2,_3){this._outletid=_2;this.outletname.set("value",_3.outlet.outletname);this.prmax_outlettypeid.set("value",_3.outlet.prmax_outlettypeid);this.countryid.set("value",_3.outlet.countryid);this.address1.set("value",_3.address.address1);this.address2.set("value",_3.address.address2);this.townname.set("value",_3.address.townname);this.county.set("value",_3.address.county);this.postcode.set("value",_3.address.postcode);this.circulation.set("value",_3.outlet.circulation);this.frequency.set("value",_3.outlet.frequencyid);this.www.set("value",_3.outlet.www);this.email.set("value",_3.communications.email);this.tel.set("value",_3.communications.tel);this.fax.set("value",_3.communications.fax);this.linkedin.set("value",_3.communications.linkedin);this.twitter.set("value",_3.communications.twitter);this.facebook.set("value",_3.communications.facebook);this.instagram.set("value",_3.communications.instagram);this.interests.set("value",_3.interests);this.coverage.set("value",_3.coverage);this.outletid.set("value",_3.outlet.outletid);this.reasoncodeid.set("value",PRCOMMON.utils.stores.Reason_Upd_Default);this.reason.set("value","");},_Update:function(){if(ttl.utilities.formValidator(this.form)==false){alert("Not all required field filled in");this.updateBtn.cancel();return;}dojo.xhrPost(ttl.utilities.makeParams({load:this._UpdatedCallBack,url:"/outlets/research_update_main",content:this.form.get("value")}));},_Delete:function(){this.outlet_delete_ctrl.Load(this._outletid,this.outletname.get("value"));this.outlet_delete_dlg.show();},resize:function(){this.borderControl.resize(arguments[0]);this.inherited(arguments);},_DialogCloseEvent:function(_4){if(_4=="out_del"){this.outlet_delete_dlg.hide();}},_MediaOnlyCall:function(_5){if(_5.success=="OK"){alert("Social Media Only Updated");}else{alert("Problem Updating Social Media Only");}},_UpdateMediaOnly:function(){if(this.twitter.isValid()==false||this.facebook.isValid()==false||this.instagram.isValid()==false||this.linkedin.isValid()==false){alert("Invalid Data");return false;}dojo.xhrPost(ttl.utilities.makeParams({load:this._MediaOnlyCallBack,url:"/outlets/research_update_media",content:this.form.get("value")}));}});}