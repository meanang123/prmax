/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prmax.dataadmin.feedback.Completed"]){dojo._hasResource["prmax.dataadmin.feedback.Completed"]=true;dojo.provide("prmax.dataadmin.feedback.Completed");dojo.declare("prmax.dataadmin.feedback.Completed",[ttl.BaseWidget],{templateString:"<div style=\"width:600px;height:200px;\" >\r\n\t<form  class=\"prmaxdefault\" data-dojo-attach-point=\"form\" data-dojo-type=\"dijit.form.Form\" onsubmit=\"return false;\">\r\n\t\t<input data-dojo-attach-point=\"bounceddistributionid\" data-dojo-props='type:\"hidden\",name:\"bounceddistributionid\"' data-dojo-type=\"dijit.form.TextBox\" >\r\n\t\t<table width=\"100%\" class=\"prmaxtable\" cellpadding=\"0\" cellspacing=\"0\"  border =\"0\">\r\n\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\" width=\"20%\">Has Been Researched?</td><td><input data-dojo-attach-point=\"has_been_research\" data-dojo-props='\"class\":\"prmaxbutton\", type:\"text\", name:\"has_been_research\"' data-dojo-type=\"dijit.form.CheckBox\" ></td><td>\r\n\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\" width=\"20%\">Reason</td><td >\r\n\t\t\t<select data-dojo-attach-point=\"reasoncodes\" data-dojo-type =\"dijit.form.FilteringSelect\" data-dojo-props='searchattr:\"name\",labeltype:\"html\",name:\"reasoncodeid\",style:\"width:98%\",\"class\":\"prmaxrequired\"'/>\r\n\t\t\t</td></tr>\r\n\t\t\t<tr><td align=\"right\" class=\"prmaxrowtag\" valign=\"top\">Description</td><td  ><div class=\"reasonframe\" ><textarea data-dojo-attach-point=\"reason\" data-dojo-props='name:\"reason\",\"class\":\"prmaxrowtag\",required:true,style:\"width:99%;height:80%;\"' data-dojo-type=\"dijit.form.Textarea\"></textarea></div></td></tr>\r\n\t\t\t<tr><td><br/><br/></td></tr>\r\n\t\t\t<tr><td align=\"right\" colspan=\"2\"><button data-dojo-type=\"dijit.form.Button\" type=\"button\" data-dojo-attach-event=\"onClick:_CompleteSubmit\" name=\"submit\">Bounce Email Completed</button></td></tr>\r\n\t\t</table>\r\n\t</form>\r\n</div>\r\n",constructor:function(){this._CompletedCallBack=dojo.hitch(this,this._CompletedCall);},postCreate:function(){this.reasoncodes.store=PRCOMMON.utils.stores.Research_Reason_Add_Email();this.inherited(arguments);},_CompleteSubmit:function(){if(ttl.utilities.formValidator(this.form)==false){alert("Not all required fields filled in");return;}if(confirm("Complete Email?")){dojo.xhrPost(ttl.utilities.makeParams({load:this._CompletedCallBack,url:"/dataadmin/bemails/completed",content:this.form.get("value")}));}},_CompletedCall:function(_1){if(_1.success=="OK"){alert("Completed");this.Clear();dojo.publish(PRCOMMON.Events.BouncedEmail_Completed,[this.bounceddistributionid.get("value")]);}else{alert("Problem Completing Bounnced Email");}},Clear:function(){this.bounceddistributionid.set("value",-1);this.reasoncodes.set("value",null);this.reason.set("value","");this.has_been_research.set("value",false);},Load:function(_2){this.bounceddistributionid.set("value",_2);this.reasoncodes.set("value",null);this.has_been_research.set("value",false);this.reason.focus();},focus:function(){this.reason.focus();}});}