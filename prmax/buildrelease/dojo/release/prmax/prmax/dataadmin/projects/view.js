/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prmax.dataadmin.projects.view"]){dojo._hasResource["prmax.dataadmin.projects.view"]=true;dojo.provide("prmax.dataadmin.projects.view");dojo.require("dojox.grid.DataGrid");dojo.require("prmax.dataadmin.projects.outletwizard");dojo.require("prmax.dataadmin.projects.edit");dojo.declare("prmax.dataadmin.projects.view",[ttl.BaseWidget],{widgetsInTemplate:true,templateString:"<div>\r\n\t<div data-dojo-attach-point=\"borderControl\" data-dojo-type=\"dijit.layout.BorderContainer\" data-dojo-props='style:\"width:100%;height:100%;overflow: hidden\",gutters:false'>\r\n\t\t<div data-dojo-type=\"dijit.layout.ContentPane\" data-dojo-attach-point=\"controls\" data-dojo-props='region:\"top\",style:\"height:42px;width:100%;overflow:hidden\"'>\r\n\t\t\t<div data-dojo-type=\"dijit.Toolbar\" data-dojo-props='style:\"float:left;height:99%;width:100%;padding:0px;margin:0px\"'>\r\n\t\t\t\t<div data-dojo-attach-event=\"onClick:_ShowProjects\" data-dojo-type=\"dijit.form.Button\" data-dojo-props='iconClass:\"PrmaxResultsIcon PrmaxResultsEmpty\"'><span>Show All Projects</span></div>\r\n\t\t\t\t<div data-dojo-attach-event=\"onClick:_Refresh\" data-dojo-type=\"dijit.form.Button\" data-dojo-props='iconClass:\"PrmaxResultsIcon PrmaxResultsEmpty\"'><span>Refresh</span></div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div data-dojo-attach-point=\"zone\" data-dojo-type=\"dijit.layout.StackContainer\" data-dojo-props='region:\"center\"'>\r\n\t\t\t<div data-dojo-attach-point=\"projects\" data-dojo-type=\"dijit.layout.ContentPane\" data-dojo-props='title:\"projects\",style:\"height:100%;width:100%\"'>\r\n\t\t\t\t<div data-dojo-attach-point=\"grid\" data-dojo-type=\"dojox.grid.DataGrid\" data-dojo-props='style:\"height:100%;width:100%\",rowsPerPage:50'></div>\r\n\t\t\t</div>\r\n\t\t\t<div data-dojo-attach-point=\"edit\" data-dojo-type=\"prmax.dataadmin.projects.edit\" data-dojo-props='title:\"edit\",style:\"height:100%;width:100%\"'></div>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n",constructor:function(){this.model=new prcommon.data.QueryWriteStore({url:"/dataadmin/projects_list",onError:ttl.utilities.globalerrorchecker,nocallback:true});},postCreate:function(){this.grid.set("structure",this.view);this.grid._setStore(this.model);this.grid.onRowClick=dojo.hitch(this,this._OnSelectRow);this.inherited(arguments);},_OnSelectRow:function(e){this._row=this.grid.getItem(e.rowIndex);if(e.cellIndex==6){this.edit.Load(this._row.i);this.zone.selectChild(this.edit);}this.grid.selection.clickSelectEvent(e);},resize:function(){this.inherited(arguments);this.borderControl.resize(arguments[0]);},view:{cells:[[{name:"Project",width:"300px",field:"researchprojectname"},{name:"Owner",width:"150px",field:"ownername"},{name:"Nbr",width:"50px",field:"count",styles:"text-align: right;padding-right:5px;"},{name:"Completed",width:"80px",field:"completed",styles:"text-align: right;padding-right:5px;"},{name:" ",width:"12px",formatter:ttl.utilities.deleteRowCtrl},{name:" ",width:"12px",formatter:ttl.utilities.editRowCtrl},{name:" ",width:"12px",formatter:ttl.utilities.formatRowCtrl}]]},_ShowProjects:function(){this.zone.selectChild(this.projects);},_Refresh:function(){this.grid.setQuery(ttl.utilities.getPreventCache({}));}});}