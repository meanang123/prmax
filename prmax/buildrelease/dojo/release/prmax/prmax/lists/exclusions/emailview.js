/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["prmax.lists.exclusions.emailview"]){dojo._hasResource["prmax.lists.exclusions.emailview"]=true;dojo.provide("prmax.lists.exclusions.emailview");dojo.declare("prmax.lists.exclusions.emailview",[ttl.BaseWidget],{widgetsInTemplate:true,templateString:"<div>\r\n\t<div data-dojo-attach-point=\"borderCtrl\" data-dojo-type=\"dijit.layout.BorderContainer\" data-dojo-props='style:\"width:100%;height:100%\",gutters:false'  >\r\n\t\t<div data-dojo-type=\"dijit.layout.ContentPane\" data-dojo-props='region:\"top\",style:\"height:42px;width:100%;overflow:hidden\",\"class\":\"searchresults\"'>\r\n\t\t\t<div style=\"height:40px;width:100%;overflow:hidden\" class=\"searchresults\">\r\n\t\t\t\t<div style=\"height:100%;width:200px;float:left;\" class=\"prmaxrowdisplaylarge\">Manage Unsubscribed email addresses</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div data-dojo-type=\"dijit.layout.ContentPane\" data-dojo-props='region:\"center\"' >\r\n\t\t\t<div data-dojo-attach-point=\"grid\" data-dojo-type=\"dojox.grid.DataGrid\" data-dojo-props='rowsPerPage:50'></div>\r\n\t\t</div>\r\n\t\t<div data-dojo-type=\"dijit.layout.ContentPane\" data-dojo-props='region:\"right\",style:\"width:50%;\"' >\r\n\t\t\t<div data-dojo-attach-point=\"grid_details\" data-dojo-type=\"dojox.grid.DataGrid\" data-dojo-props='rowsPerPage:50'></div>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n",constructor:function(){this.model=new prcommon.data.QueryWriteStore({url:"/search/exclude/email_list",oncallback:false,onError:ttl.utilities.globalerrorchecker});this._delete_call_back=dojo.hitch(this,this._delete_call);},postCreate:function(){this.grid.set("structure",this.view);this.grid._setStore(this.model);this.grid.onCellClick=dojo.hitch(this,this._on_cell_click);this.inherited(arguments);},view:{cells:[[{name:"Email",width:"200px",field:"email"},{name:" ",width:"15px",styles:"text-align: center;",width:"20px",formatter:ttl.utilities.deleteRowCtrl}]]},_delete_call:function(_1){if(_1.success=="OK"){this.model.deleteItem(this._row);}},_on_cell_click:function(e){this._row=this.grid.getItem(e.rowIndex);if(e.cellIndex==1){if(confirm("Remove Exclusion?")){dojo.xhrPost(ttl.utilities.makeParams({load:this._DeleteCallBack,url:"/search/exclude/email_exclusion_delete",content:{exclusionlistid:this._row.i.exclusionlistid}}));}}},resize:function(){this.inherited(arguments);},Clear:function(){this.grid.setQuery(ttl.utilities.getPreventCache());}});}