/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


define(["dojo/_base/xhr","dojo/json","dojo/_base/declare","dojo/store/util/QueryResults","dojo/request","ttl/store/TtlQueryResults"],function(_1,_2,_3,_4,_5,_6){return _3("ttl.store.JsonRest",null,{constructor:function(_7){_3.safeMixin(this,_7);},target:"",idProperty:"id",get:function(id,_8){},accepts:"application/javascript, application/json",getIdentity:function(_9){return _9[this.idProperty];},put:function(_a,_b){return _a;},add:function(_c,_d){_d=_d||{};_d.overwrite=false;return this.put(_c,_d);},remove:function(id){},query:function(_e,_f){if(_e["data_mode"]==="EMPTYGRID"){return _4("");}else{var _10={};_f=_f||{};if(_f.start>=0||_f.count>=0){_10.Range="items="+(_f.start||"0")+"-"+(("count" in _f&&_f.count!=Infinity)?(_f.count+(_f.start||0)-1):"");}if(_e&&typeof _e=="object"){_e=_1.objectToQuery(_e);if(this.target.indexOf("?")!=-1){_e="&"+_e;}else{_e=_e?"?"+_e:"";}}if(_f&&_f.sort){var _11=this.sortParam;_e+=(_e?"&":"?")+(_11?_11+"=":"sort=");for(var i=0;i<_f.sort.length;i++){var _12=_f.sort[i];_e+=(i>0?",":"")+(_12.descending?"-":"+")+encodeURIComponent(_12.attribute);}}var _13=_1("GET",{url:this.target+(_e||""),handleAs:"json",headers:_10,preventCache:true,timeout:100000});_13.total=_13.then(function(){var _14=_13.ioArgs.xhr.getResponseHeader("Content-Range");return _14&&(_14=_14.match(/\/(.*)/))&&+_14[1];});return _4(_13);}}});});